<?xml version="1.0" encoding="utf-8"?>
<CollabArchV5Model xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Name>NewCollabArchV5</Name>
  <Id>f26a0515-884a-47aa-a8df-4c49df31fbdd</Id>
  <Structure xsi:type="CollabArchV5Structure">
    <Id>a473f631-3b23-4e7f-8f99-17ccaf561f4e</Id>
    <Types>
      <anyType xsi:type="CollabPattern">
        <Name>MonSys</Name>
        <Id>e38e90df-aff2-486f-8d9a-4ef54eee19d4</Id>
        <Structure xsi:type="CollabPatternStructure">
          <Id>36947070-af02-4cdb-8f65-0c2d846381c7</Id>
          <Types>
            <anyType xsi:type="Collaborator">
              <Name>Agent</Name>
              <Id>1ce10eb9-e6d1-45b0-8d49-25a085d812e0</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>57f91788-8eda-4eb1-b6ea-0dfa9591c2a3</Id>
                <Types>
                  <anyType xsi:type="Metric">
                    <Name>LastEventAmount</Name>
                    <Id>753683cf-4977-4646-aaa9-1c4cdcf58099</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>6dcf29c6-3d00-41d6-b105-820c24136348</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7222f3ca-a7f9-4bad-9efa-d7cd3acf29b3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>6</X>
                      <Y>802</Y>
                    </Location>
                    <DisplayName>LastEventAmount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>NfyCount</Name>
                    <Id>e6011741-bfd9-48af-aff4-51ecc91926b8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>caedd1ba-cb24-409f-9c98-a53eb09f228a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>12f47f90-19b1-4a0c-931f-f93505e7278d</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>776</Y>
                    </Location>
                    <DisplayName>NfyCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>PubCount</Name>
                    <Id>fa548d10-f0ac-4109-ae08-92ccba7887f0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>a72ec206-7bb3-4a59-a201-db6630a0cfa8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3f344517-c4fe-48c2-bd86-9ce0759d6d40</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>138</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>ProcessingWork</Name>
                    <Id>b543d18c-736d-438f-b7b5-d2a6df22d4ce</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4c86bf70-a2cb-4f16-b9ed-b9bf0b39cc74</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ac2e9bb2-e3df-434d-8fbc-f95298c36346</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>6</X>
                      <Y>564</Y>
                    </Location>
                    <DisplayName>ProcessingWork</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>AgentType</Name>
                    <Id>5989f823-cbf8-482b-a8f3-d24971ce8ee5</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>547b035a-70c7-4931-8b85-c8cacb732598</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>38a10ec8-e7fc-4674-a3a2-5b5e1f7da6a5</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>69</X>
                      <Y>10</Y>
                    </Location>
                    <DisplayName>AgentType</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>-1</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>WorkOverLoad</Name>
                    <Id>6cbfaab7-d17c-4f9b-bf30-7164558de1e0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>0b3aeeea-2a86-44e0-9840-65c092141264</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ce3ed447-bd45-4e53-a626-01b8c9cd729b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>5</X>
                      <Y>542</Y>
                    </Location>
                    <DisplayName>WorkOverLoad</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMAvgWorkOverLoad</Name>
                    <Id>bb3aa70f-951d-4aca-baa7-1cdac625b2f7</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>38730af7-902e-4844-8bc9-064dc951ceb2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>8a88281d-dc5e-4ea0-a893-acaa99df45ec</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>591</Y>
                    </Location>
                    <DisplayName>EWMAvgWorkOverLoad</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>IdleCapacity</Name>
                    <Id>0548bf3e-b25b-44e4-b04d-517a3d47bd27</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>62a4991a-9a35-4dfc-8ff3-c5fdb72af949</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0f708639-23e8-411b-8a97-52351d6052c4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>516</Y>
                    </Location>
                    <DisplayName>IdleCapacity</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflictPerWrite</Name>
                    <Id>52e25b87-5752-4ff6-ac30-c85b405c9f88</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>2848285e-d78f-48d5-87ad-1eb6a765c300</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>87c62165-df44-44e6-8a5f-16a20982dca9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>142</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>324</Y>
                    </Location>
                    <DisplayName>UpdateConflictPerWrite</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="EventProcessor">
                    <Name>EventProcesser</Name>
                    <Id>18458eda-5164-44e2-ae5e-5523a59c3c36</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>093de041-e2ba-42a5-99b2-5524e6ad1456</Id>
                      <Types>
                        <anyType xsi:type="DataTransfer">
                          <Name>InEvents</Name>
                          <Id>92dde1e9-e8ba-42e2-b208-be461dc37d22</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f27c76a5-2d36-4d65-bcab-ba4dd698d366</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d1ecfa9d-b8e4-47ce-bf6c-f20651d57491</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>82</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>103</X>
                            <Y>241</Y>
                          </Location>
                          <DisplayName>InEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>FieldAgentWork</Name>
                          <Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7433ca20-edba-4fb6-b176-c745007441dd</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7c7ee748-f99d-4d04-966e-a5dd77c2155c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.eventCount;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;
Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Capacity*EventProcesser.ExeDuration;

if (eventCount &gt; throughput)
{
	agent.WorkOverLoad = (eventCount/throughput);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = ((throughput-eventCount)/throughput);
}
agent.EWMAvgWorkOverLoad = agent.EWMAalpha*agent.WorkOverLoad + (1-agent.EWMAalpha)*agent.EWMAvgWorkOverLoad;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	if (EventProcesser.Agent.DoDropOverload &amp;&amp; i &gt; throughput)
	{;
	}
	else	
	{	
		int counter = 0;		
		if (dict.TryGetValue(msg.SituationId, out counter))
		{
			dict[msg.SituationId] = counter+1;
		}	
		else
		{
			dict.Add(msg.SituationId, 1);
		}
	}
}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 10)
	{
		//DomainProAnalyst.Instance.Report("Field Agent Detects Situation: "+id);	
		agent.PublisherCompList[0].ProcEvents.Enqueue(id);
	}		    
}
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>int eventCount = EventProcesser.eventCount;
if (EventProcesser.Agent.DoDropOverload)
	return EventProcesser.ExeDuration;
else
	return Math.Max(EventProcesser.ExeDuration, eventCount/EventProcesser.Capacity);

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>11</X>
                            <Y>101</Y>
                          </Location>
                          <DisplayName>FieldAgentWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>BackofficeWork</Name>
                          <Id>5921eaa1-9838-40b8-b7d6-4db294573649</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>676fa05e-6087-48ad-875c-7d8680f39567</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5338dea0-c971-462e-80ce-9dd4f50d28bd</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.eventCount;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Capacity*EventProcesser.ExeDuration*EventProcesser.UpdateP;

if (eventCount &gt; throughput)
{
	agent.WorkOverLoad = (eventCount/throughput);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = ((throughput-eventCount)/throughput);
}
agent.EWMAvgWorkOverLoad = agent.EWMAalpha*agent.WorkOverLoad + (1-agent.EWMAalpha)*agent.EWMAvgWorkOverLoad;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	if (EventProcesser.Agent.DoDropOverload &amp;&amp; i &gt; throughput)
	{;
	}
	else	
	{	
		int counter = 0;		
		if (dict.TryGetValue(msg.SituationId, out counter))
		{
			dict[msg.SituationId] = counter+1;
		}	
		else
		{
			dict.Add(msg.SituationId, 1);
		}
	}

}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 5)
	{
		DomainProAnalyst.Instance.Report("Backoffice Worker Detects Situation: "+id);	
		agent.PublisherCompList[0].ProcEvents.Enqueue(id);
	}		    
}
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>// Backoffice worker use only half the time for analysis due to crowd sourcing
//double dur = EventProcesser.ExeDuration/2;

int eventCount = EventProcesser.eventCount;
if (EventProcesser.Agent.DoDropOverload)
	return EventProcesser.ExeDuration;
else
	return Math.Max(EventProcesser.ExeDuration, eventCount/(EventProcesser.Capacity*EventProcesser.UpdateP));


</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>54</X>
                            <Y>148</Y>
                          </Location>
                          <DisplayName>BackofficeWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Situations</Name>
                          <Id>3c1b43f0-5378-4817-b622-0b58f4ecde11</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>f1184758-4b2e-4db5-931c-a1e4ccf40cc9</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ba865fa1-b010-418f-9e58-1b2232cb1eed</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>67</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>12</X>
                            <Y>80</Y>
                          </Location>
                          <DisplayName>Situations</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;int,int&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;int,int&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>ef8d7d8d-b700-4728-8f97-8be0d49c7ff9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>09d5ec57-57b8-43dd-8029-08a9a6135f57</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>11540a98-31d9-4cc5-b0c2-01b11857f128</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>38</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>242</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>TeamLeaderWork</Name>
                          <Id>5b741197-7f01-4675-98ea-dfbceef28478</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7a1817d4-0fab-48e7-9ff1-a4f77a4203b4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6e4219f5-76b8-43d5-9f31-d4c2dfd28611</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.eventCount;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Capacity*EventProcesser.ExeDuration*EventProcesser.UpdateP;

if (eventCount &gt; throughput)
{
	agent.WorkOverLoad = (eventCount/throughput);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = ((throughput-eventCount)/throughput);
}
agent.EWMAvgWorkOverLoad = agent.EWMAalpha*agent.WorkOverLoad + (1-agent.EWMAalpha)*agent.EWMAvgWorkOverLoad;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	if (EventProcesser.Agent.DoDropOverload &amp;&amp; i &gt; throughput)
	{;
	}
	else	
	{	
		int counter = 0;		
		if (dict.TryGetValue(msg.SituationId, out counter))
		{
			dict[msg.SituationId] = counter+1;
		}	
		else
		{
			dict.Add(msg.SituationId, 1);
		}
	}

}

double timeNow = Model.Simulation.Simulator.Scheduler.Time;
foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt;= 3)
	{			
		if (id &gt; 0 &amp;&amp; agent.MonSys.HotSpotList[0].UndetectedDict.ContainsKey(id))
		{
DomainProAnalyst.Instance.Report("Team Leader Detects Situation: "+id +" @:"+timeNow );				
			double start = agent.MonSys.HotSpotList[0].UndetectedDict[id];
			agent.MonSys.HotSpotList[0].UndetectedDict.Remove(id);
			double duration = timeNow - start;
			agent.MonSys.HotSpotList[0].DurDict.Add(id, duration);
			agent.MonSys.HotSpotList[0].DetectionDuration = duration;
		}
	}		    
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>int eventCount = EventProcesser.eventCount;
if (EventProcesser.Agent.DoDropOverload)
	return EventProcesser.ExeDuration;
else
	return Math.Max(EventProcesser.ExeDuration, eventCount/(EventProcesser.Capacity*EventProcesser.UpdateP));


</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>86</X>
                            <Y>199</Y>
                          </Location>
                          <DisplayName>TeamLeaderWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>c019880a-8cff-4717-8664-854b0eabe1a2</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>6e0bbc43-7139-48e1-957f-5333aeab9212</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f8587197-19a8-41b1-a3aa-f8e1e41ba03d</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>EventProcesser.Situations.Clear();
EventProcesser.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return Random.Uniform();
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>59</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>36</X>
                            <Y>22</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>d0d60fd4-de02-485c-b5a5-23aa3a229578</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>2e3b2f03-60e7-4675-9e51-841912b6db30</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>76f1aa1b-37de-42fc-9c71-dcf549cb59e1</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>44</Width>
                            <Height>42</Height>
                          </Size>
                          <Location>
                            <X>111</X>
                            <Y>59</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>100</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>18</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>55bbf93f-9f59-473a-bc8b-d299d9fddab9</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>6e688c79-8593-4936-bf91-9fbd07a97a6f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>41907beb-8afc-426c-8158-3f75d1499834</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>24</Width>
                            <Height>89</Height>
                          </Size>
                          <Location>
                            <X>154</X>
                            <Y>59</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>100</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>41</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>c2914016-0eb7-4017-b1bf-3b25ee68e1dc</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>095e7986-30f6-4633-b92b-f2122cc1469b</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>221e00eb-23c1-4ba9-8cb6-2e5b903552d5</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>26</Width>
                            <Height>140</Height>
                          </Size>
                          <Location>
                            <X>169</X>
                            <Y>59</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>83</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>58</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>5b741197-7f01-4675-98ea-dfbceef28478</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>565d52f5-20ab-4225-80bd-41dba8237d06</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>26de32c3-64f9-44b4-9f20-703da44dd692</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>51d7adc9-4dbd-40c1-9a20-b732a93a0dd8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==3 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;
Idle.EventProcesser.eventCount = Idle.EventProcesser.InEvents.Count;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>48</Width>
                            <Height>137</Height>
                          </Size>
                          <Location>
                            <X>95</X>
                            <Y>62</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>59</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>57</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>5b741197-7f01-4675-98ea-dfbceef28478</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence4</Name>
                          <Id>912fbd82-1ee5-4a10-be94-6af061d3aa31</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>2deccfd4-5ef5-4b6f-bba8-2f9ca876c926</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d5279c35-d949-4769-b2df-271947ef32c7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==2 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;
Idle.EventProcesser.eventCount = Idle.EventProcesser.InEvents.Count;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>44</Width>
                            <Height>86</Height>
                          </Size>
                          <Location>
                            <X>73</X>
                            <Y>62</Y>
                          </Location>
                          <DisplayName>NewCollabSequence4</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>37</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>63</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence5</Name>
                          <Id>7b73355c-9109-4c87-914f-f887dfba8648</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>dca20881-d0ae-48ef-b9c3-edebd5557ae3</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f0f0ee5a-7e50-4859-a725-4426fbf09cf9</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==1 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;
Idle.EventProcesser.eventCount = Idle.EventProcesser.InEvents.Count;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>25</Width>
                            <Height>39</Height>
                          </Size>
                          <Location>
                            <X>56</X>
                            <Y>62</Y>
                          </Location>
                          <DisplayName>NewCollabSequence5</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>20</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role2Id>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Fwd</Name>
                          <Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>34cf1e69-c407-4f99-b4c7-a03f25e7ac7e</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>914339d2-0db5-43b3-92d1-d901200c2bbd</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>137</X>
                            <Y>19</Y>
                          </Location>
                          <DisplayName>Fwd</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence6</Name>
                          <Id>a93c723f-4631-4f80-87b6-f27f0b65a301</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>5d7a2a49-c426-488a-a8c0-7b4bcfad317d</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bc8be72f-b72a-4de6-9081-7569654250a4</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return !Fwd.EventProcesser.Agent.DoUpdateArtifact;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>42</Width>
                            <Height>6</Height>
                          </Size>
                          <Location>
                            <X>95</X>
                            <Y>35</Y>
                          </Location>
                          <DisplayName>NewCollabSequence6</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>0</X>
                                <Y>16</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>59</X>
                                <Y>19</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role1Id>
                          <Role2Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>eventCount</Name>
                          <Id>e5a6e51e-b803-42e4-bff4-6862ff41619e</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>d6536e58-9238-49fa-bd50-ccafc3980db3</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2c4a76ea-e702-44d1-a594-53576008c4d7</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>73</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>6</X>
                            <Y>218</Y>
                          </Location>
                          <DisplayName>eventCount</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7d4ae50c-7048-485b-b6a4-cf6c1d57796e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>if (IdleP &gt; 0)
	Agent.DoDropOverload = false;
else if (IdleP &lt; 0)
	Agent.DoDropOverload = true;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>282</Height>
                    </Size>
                    <Location>
                      <X>91</X>
                      <Y>448</Y>
                    </Location>
                    <DisplayName>EventProcesser</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <UpdateP>1</UpdateP>
                    <IdleP>1</IdleP>
                    <Capacity>5</Capacity>
                    <ExeDuration>5</ExeDuration>
                  </anyType>
                  <anyType xsi:type="Subscriber">
                    <Name>SubscriberComp</Name>
                    <Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>40e80ce2-df0e-4e82-b7a0-821f8b9a5c00</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>e0a77546-4723-4189-b3aa-76ca12d6ee44</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>notification</Name>
                                <Id>0602084a-a49f-40f3-a307-9555cc747bb2</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>653fd20c-e312-496c-adb1-d06ca6004b4a</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>129e736d-c400-4ba7-8670-7ce782dbb4a0</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>75</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>43</X>
                                  <Y>3</Y>
                                </Location>
                                <DisplayName>notification</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>NfyMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2c6a8abc-50bc-43c4-b0e7-118a99c15fd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>SubscriberComp.Agent.NfyCount++;
SubscriberComp.Agent.LastEventAmount = notification.MsgList.Count;

switch(SubscriberComp.SubType)
{
	case 0: //sensor, don't do anything
	break;
	case 1: // onsite staff	
		foreach (PubMsg msg in notification.MsgList)
		{	
			SubscriberComp.Agent.EventProcesserList[0].InEvents.Enqueue(msg);	
		}
		break;
 	case 2: // backoffice staff
		foreach (PubMsg msg in notification.MsgList)
		{
			SubscriberComp.Agent.EventProcesserList[0].InEvents.Enqueue(msg);
		}
		break;
	case 3: // backoffice team leader
		foreach (PubMsg msg in notification.MsgList)
		{
			SubscriberComp.Agent.EventProcesserList[0].InEvents.Enqueue(msg);	
		}
		break;
	default: 	
	break;
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>48</Height>
                          </Size>
                          <Location>
                            <X>21</X>
                            <Y>20</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>SubType</Name>
                          <Id>3daae4f8-3552-44d5-bab9-004df92ae9ee</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>51e366c9-019f-4134-a3e8-5a9ab161d4ab</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1ecd3e60-e110-4616-b549-8918eb8c1ca9</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>60</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>80</Y>
                          </Location>
                          <DisplayName>SubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>-1</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Subscriptions</Name>
                          <Id>b66d23c5-9b6b-4b06-93bb-0693591280b6</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>d921a7a8-36d3-49df-a08c-38c1d9eb83d4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>0d8cdcf0-1770-4a3e-a26f-73d6755dfdf3</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>92</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>89</X>
                            <Y>80</Y>
                          </Location>
                          <DisplayName>Subscriptions</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                          <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>07b006db-bc02-4ac8-906d-d60914b1cb54</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>Topic topic = null;
SubType = Agent.AgentType;
TopicGroup tg = null;
switch(SubType)
{
	case 0: //sensor, don't sub to anything
	break;
	case 1: // onsite staff	
		tg = Agent.MonSys.TopicGroupList[0];
// 		topic = Agent.MonSys.TopicList[0]; //from sensors
//		topic.Subscribers.Add(this);		
		break;
	case 2: // backoffice staff
		tg = Agent.MonSys.TopicGroupList[1];
		break;
	case 3: // backoffice team leader
		tg = Agent.MonSys.TopicGroupList[2];
		break;
	default: 	
		tg = Agent.MonSys.TopicGroupList[0];	
	break;
}
if (tg != null)
{	
	//int pos = (int)Random.Uint((uint)0,(uint)tg.Topics.Count);
	int pos = Agent.MonSys.AgentList.IndexOf(Agent);
	topic = tg.Topics[pos%tg.Topics.Count];
	topic.Subscribers.Add(this);
	topic.SubCount++;
	Subscriptions.Add(topic);
	int moreSubs = Math.Min(NrEventSources -1, tg.Topics.Count-1);	
	for (int i = 1; i &lt;= moreSubs; i++)
	{
		topic = tg.Topics[(pos+i)%tg.Topics.Count];
		topic.Subscribers.Add(this);
		topic.SubCount++;
		Subscriptions.Add(topic);
	}
}
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>115</Height>
                    </Size>
                    <Location>
                      <X>89</X>
                      <Y>740</Y>
                    </Location>
                    <DisplayName>SubscriberComp</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateCount</Name>
                    <Id>a152e546-ae07-4597-ad34-8446dcd8ffc2</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>af347c8c-158b-4ac0-9dcb-e4ad0345438c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>c6ef0a87-d5ad-4cfa-bcf3-6f1fc2ba582e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>351</Y>
                    </Location>
                    <DisplayName>UpdateCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence4</Name>
                    <Id>d54dee05-fd39-4113-8a48-3c73d86221b2</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>c86a1b26-1320-46c8-9be9-55cb6609e978</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0acb7431-7344-4f0f-99b7-298ba99aed28</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return UpdateStatus.isError;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>UpdateStatus.isError = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return UpdateStatus.Contributor.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>42</Width>
                      <Height>78</Height>
                    </Size>
                    <Location>
                      <X>166</X>
                      <Y>392</Y>
                    </Location>
                    <DisplayName>NewCollabSequence4</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>25</X>
                          <Y>34</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>39</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role1Id>
                    <Role2Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence6</Name>
                    <Id>3056cfbd-b63e-4dfc-83cb-91232048d4cc</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>86a31dfd-9bcc-4fe4-8ed2-2c94157197b5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>068db7a3-f494-4e13-adce-6a123f8e0da1</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return Fwd.EventProcesser.Agent.DoUpdateArtifact;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Fwd.EventProcesser.Agent.ContributorList[0].ArtifactVersion = Fwd.EventProcesser.Agent.ContributorList[0].SharedStatusArtifact.Version;
	</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Fwd.EventProcesser.Agent.ContributorList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>17</Width>
                      <Height>75</Height>
                    </Size>
                    <Location>
                      <X>237</X>
                      <Y>392</Y>
                    </Location>
                    <DisplayName>NewCollabSequence6</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>26</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>54</X>
                          <Y>34</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role1Id>
                    <Role2Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role2Id>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Contributor</Name>
                    <Id>74330db1-511a-4338-a51b-1bf36e53635c</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>5a6fcabd-cbbb-49d4-84ea-cef5731281a8</Id>
                      <Types>
                        <anyType xsi:type="Update">
                          <Name>UpdateStatus</Name>
                          <Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Id>
                          <Structure xsi:type="UpdateStructure">
                            <Id>9c44e8b0-77c2-4c76-ae4a-a6e95004ce1e</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>isError</Name>
                                <Id>9e6d5538-4f3f-46fd-b8f2-f32a59df254a</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>2c662b71-f791-4fb0-859c-60ce95c29bfa</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>a6fe44dc-8610-40e7-9e65-8147363c5c8e</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>54</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>226</X>
                                  <Y>55</Y>
                                </Location>
                                <DisplayName>isError</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>bool</ImplementationType>
                                <InitialValue>false</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>03f8b223-b810-4238-b780-2119227c0b4c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>// determine where to get version Nr from
// determine update extend/scope
// determine update duration

if (Contributor.SharedStatusArtifact == null)
{
	isError = true;
	return;
}
StatusArtifact sa = Contributor.SharedStatusArtifact;

Simulation.MonSysContext.StatusArtifactContext.Update up = Contributor.WorkingOnUpdate;
if (up == null)
{
	// working on new update
	Contributor.WriteTries = 1;
	Contributor.Agent.UpdateCount++;
}
else
{
	Contributor.WriteTries++;
	// working on conflicting update
	Contributor.Agent.UpdateConflictSum++;
	Contributor.ArtifactVersion = up.StatusArtifact.Version;	
}
up = sa.Create("Update") as Simulation.MonSysContext.StatusArtifactContext.Update;
Contributor.WorkingOnUpdate = up;
up.WorkingOnUpdate = Contributor;
up.Responsible = Contributor;
up.Scope = 1.0;
up.UpdateOnVersion = Contributor.ArtifactVersion;

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = Contributor.Agent.WorkExeDuration*Contributor.UpdateP;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>91</Width>
                            <Height>34</Height>
                          </Size>
                          <Location>
                            <X>98</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>UpdateStatus</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Read">
                          <Name>ReadFeedback</Name>
                          <Id>286ebe30-07b8-49d8-a221-29f6a6245668</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>7c55f92e-f8cb-45b4-b416-d6e7a9473bea</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>9f270e13-5598-408c-a91a-55475bff918d</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Contributor.WorkingOnUpdate != null &amp;&amp; Contributor.WorkingOnUpdate.isUpdateSuccess)
{
	Contributor.ArtifactVersion = Contributor.WorkingOnUpdate.StatusArtifact.Version;
	Contributor.Agent.UpdateConflictPerWrite = (Contributor.WriteTries-1);
	
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>93</Width>
                            <Height>35</Height>
                          </Size>
                          <Location>
                            <X>63</X>
                            <Y>19</Y>
                          </Location>
                          <DisplayName>ReadFeedback</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>ArtifactVersion</Name>
                          <Id>607ef3a0-e812-4bc9-b9c4-073453cfc362</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>fb1f8811-0acb-465a-9bd0-119c4f8d7a11</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>9510283f-7186-45c0-8f32-586c5accd70f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>86</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>115</Y>
                          </Location>
                          <DisplayName>ArtifactVersion</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>b0e52cdd-566e-4a43-bdc8-a941408d705b</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>4d122153-e9f8-4409-aa83-c2c1d0124d2b</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6060c0c2-169c-4208-8e7e-57c01a515b76</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (ReadFeedback.Contributor.WorkingOnUpdate != null &amp;&amp; !ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>33</Width>
                            <Height>21</Height>
                          </Size>
                          <Location>
                            <X>109</X>
                            <Y>54</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>46</X>
                                <Y>35</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>44</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                          <Role2Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>WriteTries</Name>
                          <Id>99380253-529f-4520-ab66-ee651f5edb08</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c04ecf1d-efc2-4f27-9cbb-36829d5b96de</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2e5416ee-1ed3-48aa-820e-1a39f2c2d56f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>89</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>7</X>
                            <Y>92</Y>
                          </Location>
                          <DisplayName>WriteTries</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e4f0e624-5842-4a22-89d1-d5efd3a76234</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>SharedStatusArtifactLink = Agent.MonSys.Create("SharedStatusArtifact") as SharedStatusArtifact;
WorkingOnUpdateLink = Agent.MonSys.Create("WorkingOnUpdate") as WorkingOnUpdate;

// more init code to set the link to an actual shared artifact
int pos = Agent.MonSys.AgentList.IndexOf(Agent);
if (pos != -1 &amp;&amp; pos &lt; Agent.MonSys.AgentPubTopic.Count)
{
	Topic topic = Agent.MonSys.AgentPubTopic[pos];	
	int posSA = Agent.MonSys.TopicList.IndexOf(topic);
	SharedStatusArtifact = Agent.MonSys.StatusArtifactList[posSA];
}
else
{
	SharedStatusArtifact = Agent.MonSys.StatusArtifactList[0];
}
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>142</Height>
                    </Size>
                    <Location>
                      <X>85</X>
                      <Y>283</Y>
                    </Location>
                    <DisplayName>Contributor</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <UpdateP>0.05</UpdateP>
                  </anyType>
                  <anyType xsi:type="Publisher">
                    <Name>PublisherComp</Name>
                    <Id>54e1807c-75dd-4c97-b6cf-26c2a97ab65a</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>ec4f2fee-bdda-416a-9e50-fc8f61150b3d</Id>
                      <Types>
                        <anyType xsi:type="Create">
                          <Name>Publish</Name>
                          <Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>f9bc7607-7e12-4c6a-883b-7ea627158a43</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>newEvent</Name>
                                <Id>60e0c1d3-72a4-4a5b-b05e-c710a74cac2d</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>3dcd6f7c-aa7d-4749-899e-ede6b0b9cab6</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>9e19e3ab-ee0a-43cd-a840-42764206f8fc</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>65</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>newEvent</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>PubMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>4d2c8b1d-5c1f-4471-9f67-3e0470ffec63</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>// create PubSubMsg
newEvent = PublisherComp.Agent.MonSys.Create("PubMsg") as PubMsg;

// set situation id
if (PublisherComp.ProcEvents.Count &gt; 0)
{
	newEvent.SituationId = PublisherComp.ProcEvents.Dequeue();
}
else
{	// set random situation id
	if (PublisherComp.PubType == 0 &amp;&amp; PublisherComp.regTopic.IsPartOfHotspot)	{
		newEvent.SituationId =  PublisherComp.Agent.MonSys.HotSpotList[0].CurrHotSpotId;
	}
	else {
		newEvent.SituationId = 200+(int)Math.Floor(Random.Uniform()*10);
	}
}

// set topic
TopicRef tRef = PublisherComp.Agent.MonSys.Create("TopicRef") as TopicRef;
tRef.Topic = PublisherComp.regTopic;	
newEvent.TopicRefLink = tRef;
newEvent.Sender = PublisherComp;

PublisherComp.Agent.PubCount++;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.05;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>52</Height>
                          </Size>
                          <Location>
                            <X>70</X>
                            <Y>29</Y>
                          </Location>
                          <DisplayName>Publish</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>regTopic</Name>
                          <Id>f6032ea6-bfa0-4946-afe7-e348fec3b328</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c3275e61-9cfa-4038-9c8b-e623517e6e9a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b9f9bb1c-20e8-4ea3-89ac-4cdb8d43bb0c</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>61</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>9</X>
                            <Y>6</Y>
                          </Location>
                          <DisplayName>regTopic</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Topic</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>NextStep</Name>
                          <Id>624879d5-401b-43d9-8896-0c24d8417718</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>2b2f6b18-1c41-443f-8430-c878333147a2</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>Choice</Name>
                                <Id>f2da475a-373d-4dca-8050-03a701f09646</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>00ef6660-dc26-4283-b0da-88491f077557</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>7020cd27-86eb-47c6-801a-447ab702f3ba</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>51</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>-1</Y>
                                </Location>
                                <DisplayName>Choice</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>int</ImplementationType>
                                <InitialValue>0</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>37b18d3c-4da5-4134-b72a-7a95118bcded</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>double rand = Random.Uniform();
double createProb = PublisherComp.CreateP;
if (PublisherComp.regTopic.IsPartOfHotspot)
	createProb = createProb*2;

switch(PublisherComp.PubType)
{
	case 0: //sensor
	if (rand &lt;= createProb)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 1: // onsite staff
 	case 2: // backoffice staff
	if (PublisherComp.ProcEvents.Count &gt; 0)
		Choice = 1;
	else if (rand &lt;= createProb/2)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 3: // backoffice team leader
		// don't publish, just deal with a found situation but not here.
	default: 	
	break;
}

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>51</Height>
                          </Size>
                          <Location>
                            <X>10</X>
                            <Y>124</Y>
                          </Location>
                          <DisplayName>NextStep</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>5cad996b-c1a0-40f6-adb8-062dfdcf634a</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>8db90ec0-a343-4be9-ac80-09e94b683d7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bedb1aa2-4254-4fae-99f3-0d6909908303</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>26</Width>
                            <Height>5</Height>
                          </Size>
                          <Location>
                            <X>110</X>
                            <Y>124</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>100</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>ac18d355-2463-4077-ab8a-0ede5bb06229</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>7b5c37cf-7beb-4ea5-ae75-18d6a38e687f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>e5ab3d77-c87d-4d9e-8db8-676b31716ef8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 1);

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>8</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>80</X>
                            <Y>81</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>18</X>
                                <Y>52</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>95965c14-ef63-47b4-a224-5f54c910d237</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>1345f704-c6c3-49a1-ac11-8401ae7978eb</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>06c987ae-f13e-43de-bc7c-00fd0b172e10</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>15</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>94</X>
                            <Y>81</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>39</X>
                                <Y>52</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>84</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>d95d7934-4690-450b-9692-6974e3f07257</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>65d931ba-a826-43d4-b771-82b14df30320</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>3d22a826-e372-49c4-b2ae-19b8b650ebd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>26</Width>
                            <Height>6</Height>
                          </Size>
                          <Location>
                            <X>110</X>
                            <Y>169</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>0</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>100</X>
                                <Y>51</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>PubType</Name>
                          <Id>98f17b4a-5df4-4ec9-bd3c-0ccbe83ed4e3</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7e630362-65ab-4072-b801-209d65e7cf85</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1f5a0efc-ca55-4b93-a6c7-d77378601301</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>62</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>29</Y>
                          </Location>
                          <DisplayName>PubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>-1</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>85fd41dc-a638-4450-94c8-32de58db5c79</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>4026f6f4-28d8-4138-bfd9-ba66f83637ce</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5c72a968-3c91-4be4-9379-24750a8a9257</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>//double dur = Random.Uniform()+0.5;
//if (PublisherComp.regTopic.IsPartOfHotspot)
//	return dur;
//else
//	return dur+0.5;

return Random.Uniform()+0.7;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>136</X>
                            <Y>129</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>ProcEvents</Name>
                          <Id>c88f2551-1e52-4ccc-a584-3fa045668084</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>7b8ce72d-38e6-46d9-a835-27101063de43</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ddbcda34-0e63-4ae0-9972-f6c1684e0206</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>78</Width>
                            <Height>23</Height>
                          </Size>
                          <Location>
                            <X>12</X>
                            <Y>182</Y>
                          </Location>
                          <DisplayName>ProcEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;int&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;int&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0d2ee00b-758c-4f9d-9651-abd117c018fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>PubType = Agent.AgentType;

int pos = Agent.MonSys.AgentList.IndexOf(Agent);
if (pos != -1 &amp;&amp; pos &lt; Agent.MonSys.AgentPubTopic.Count)
{
	regTopic = Agent.MonSys.AgentPubTopic[pos];	
}
else
{
	regTopic = Agent.MonSys.TopicList[0];
}
regTopic.Publishers.Add(this);
regTopic.PubCount++;

//switch(PubType)
//{
//	case 0: //sensor
//		regTopic = Agent.MonSys.TopicList[0];
//		regTopic.Publishers.Add(this);
//	break;
//	case 1: // onsite staff	
// 		regTopic = Agent.MonSys.TopicList[1];
//		regTopic.Publishers.Add(this);
//		break;
//	case 2: // backoffice staff
//		regTopic = Agent.MonSys.TopicList[2];
//		regTopic.Publishers.Add(this);
//		break;
//	case 3: // backoffice team leader
//		regTopic = Agent.MonSys.TopicList[3];
//		regTopic.Publishers.Add(this);
//		break;
//	default: 
//		
//	break;
//}
;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>213</Height>
                    </Size>
                    <Location>
                      <X>86</X>
                      <Y>46</Y>
                    </Location>
                    <DisplayName>PublisherComp</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>0.2</CreateP>
                    <InverseTopicRatio>50</InverseTopicRatio>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence5</Name>
                    <Id>4c771afb-d3d0-4a13-8617-0a045e0e3df5</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>15b6ef8e-7f5b-414d-9430-11e82302251b</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1f3eb6bf-68b8-4846-8237-9f2612b6e66b</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>// we need to capture error cases (when update == null)  and then return anyway
return (ReadFeedback.Contributor.WorkingOnUpdate == null || ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>ReadFeedback.Contributor.WorkingOnUpdate = null;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return ReadFeedback.Contributor.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>36</Width>
                      <Height>133</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>337</Y>
                    </Location>
                    <DisplayName>NewCollabSequence5</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>15</X>
                          <Y>35</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                    <Role2Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence</Name>
                    <Id>d30f365a-94d6-490e-a983-f624eb00f904</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>8a01a9e6-6e3a-418b-bfd5-f98f5a53d63a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>782de7b2-39c8-4c2b-bcae-a27d894a719a</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.SubscriberComp.SubType==1 &amp;&amp; Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle = false;
Receive.SubscriberComp.Agent.EventProcesserList[0].eventCount = Receive.SubscriberComp.Agent.EventProcesserList[0].InEvents.Count;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.SubscriberComp.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>9</Width>
                      <Height>171</Height>
                    </Size>
                    <Location>
                      <X>126</X>
                      <Y>589</Y>
                    </Location>
                    <DisplayName>NewCollabSequence</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>16</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>33</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence1</Name>
                    <Id>4e2f9c26-1531-448f-b5e3-38214f3fd97a</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>63f2eb33-ec9d-43bd-b7c1-13effbb2aef2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e33f926b-fd31-4475-bc08-5d8a9a940ab6</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.SubscriberComp.SubType==2 &amp;&amp; Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle = false;
Receive.SubscriberComp.Agent.EventProcesserList[0].eventCount = Receive.SubscriberComp.Agent.EventProcesserList[0].InEvents.Count;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.SubscriberComp.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>1</Width>
                      <Height>124</Height>
                    </Size>
                    <Location>
                      <X>145</X>
                      <Y>636</Y>
                    </Location>
                    <DisplayName>NewCollabSequence1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>36</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence2</Name>
                    <Id>afcca767-b6bc-4d6a-be35-521206ed040f</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>7b746db2-1c22-4317-b5db-5998c56d2cae</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>83be36d9-a51a-46a3-baab-30cc03e3a8b9</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.SubscriberComp.SubType==3 &amp;&amp; Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.SubscriberComp.Agent.EventProcesserList[0].isIdle = false;
Receive.SubscriberComp.Agent.EventProcesserList[0].eventCount = Receive.SubscriberComp.Agent.EventProcesserList[0].InEvents.Count;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.SubscriberComp.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>15</Width>
                      <Height>73</Height>
                    </Size>
                    <Location>
                      <X>162</X>
                      <Y>687</Y>
                    </Location>
                    <DisplayName>NewCollabSequence2</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>52</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5b741197-7f01-4675-98ea-dfbceef28478</Role2Id>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflictSum</Name>
                    <Id>3a13fbe2-80b8-4529-ab6b-1854f9ff191a</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>abc56d5d-f5ae-4b6a-b579-2757a7bc3280</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a60f1e7f-780c-4ba1-b329-7168f9ce2a57</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>296</Y>
                    </Location>
                    <DisplayName>UpdateConflictSum</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>DoUpdateArtifact</Name>
                    <Id>a925ffce-d6e4-437a-8da6-6ce79e015e0b</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>46199061-d758-43d6-a7e0-076149f4a3e5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>50e17a81-c8b3-497e-a0b0-f99bf09fa0d6</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>175</X>
                      <Y>416</Y>
                    </Location>
                    <DisplayName>DoUpdateArtifact</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>DoDropOverload</Name>
                    <Id>8927fdd3-5d96-41f5-9c95-d77cd3caf10b</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>878953bb-e668-41a4-a423-d49e19c319ff</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d36cb054-229c-40a1-b0d8-36347f6e3278</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>183</X>
                      <Y>717</Y>
                    </Location>
                    <DisplayName>DoDropOverload</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>9a126559-425c-4175-820f-3aa112a5fbc1</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>int pos = MonSys.AgentList.IndexOf(this);
if (pos != -1 &amp;&amp; pos &lt; MonSys.AgentTypeConfig.Count)
{
	AgentType = MonSys.AgentTypeConfig[pos];
}
else
{
	AgentType = 0;
}

</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>308</Width>
                <Height>876</Height>
              </Size>
              <Location>
                <X>6</X>
                <Y>1</Y>
              </Location>
              <DisplayName>Agent</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>PubSubMW</Name>
              <Id>1a2db479-64c7-468b-83ab-2600ab15a6c5</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>ce033941-a04c-45e5-b4db-be0d8fa3bd1a</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>EventCoord</Name>
                    <Id>f9b2f383-d76c-44a5-bc40-e192ec129c09</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>933d7c9c-3659-4b9f-9ebc-bbe9b9763c0c</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>38db7cfb-2d8a-47e8-a2cb-a080340a9ee6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>40eb3b63-640d-4c01-8ec5-b3d8143fce83</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>EventCoord.isIdle = false;
if (!EventCoord.isIdleInternal)
	return;
EventCoord.isIdleInternal = false;
int eventCounter = 0;
while (EventCoord.InQueue.Count &gt; 0)
{
	eventCounter++;
	PubMsg msg = EventCoord.InQueue.Dequeue();
	Topic topic = msg.TopicRef;
	foreach (MonSysContext.AgentContext.SubscriberComp sub in topic.Subscribers)
	{
		NfyMsg exMsg;		
		if (EventCoord.EventDict.TryGetValue(sub, out exMsg))
		{
			exMsg.MsgList.Add(msg);
			//EventCoord.EventDict[sub] = exMsg;
		}
		else
		{
			exMsg = EventCoord.PubSubMW.MonSys.Create("NfyMsg") as NfyMsg;
			exMsg.MsgList.Add(msg);
			exMsg.Receiver = sub;
			EventCoord.EventDict.Add(sub,exMsg);
		}				
	}
}
EventCoord.PubSubMW.EventProcessed = eventCounter;
EventCoord.isIdleInternal = true;	
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.ReadP;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>34</X>
                            <Y>68</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Create">
                          <Name>Forward</Name>
                          <Id>0b6cae23-f311-41f2-92b0-972249972a03</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>110b852e-9c3a-420f-9e40-d129a95a1d1d</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>52936466-348d-47a5-9658-e2910a22d17e</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>//DomainProAnalyst.Instance.Report("Delivering to # subscribers: "+EventCoord.EventDict.Count);

int msgCount = 0;

foreach (KeyValuePair&lt;MonSysContext.AgentContext.SubscriberComp,NfyMsg&gt; pair in EventCoord.EventDict)
{
	NfyMsg msg = pair.Value;
	//DomainProAnalyst.Instance.Report("Triggering Delivery");
	msgCount +=	msg.MsgList.Count;
	msg.Created(false);	    
}
EventCoord.EventDict.Clear();
EventCoord.PubSubMW.TotalMsgDelivered += msgCount;
EventCoord.PubSubMW.MsgLastDelivered = msgCount;
EventCoord.PubSubMW.EWMAvgMsgDelivered = EventCoord.PubSubMW.EWMAalpha * (double)msgCount + (1-EventCoord.PubSubMW.EWMAalpha)*EventCoord.PubSubMW.EWMAvgMsgDelivered ;

EventCoord.PubSubMW.EWMAvgEventsProcessed = EventCoord.PubSubMW.EWMAalpha * (double)EventCoord.PubSubMW.EventProcessed + (1-EventCoord.PubSubMW.EWMAalpha)*EventCoord.PubSubMW.EWMAvgEventsProcessed  ;


// calculate overall Agent Load here as this is one of the most regularly executed methods:
double fieldLoadSum = 0;
double fieldIdleSum = 0;
int fieldCount = 0;
double officeLoadSum = 0;
double officeIdleSum = 0;
int officeCount = 0;
double leaderLoadSum = 0;
double leaderIdleSum = 0;
int leaderCount = 0;
double fieldAlpha = 1;
double officeAlpha = 1;
double leaderAlpha = 1;
foreach (Agent agent in EventCoord.PubSubMW.MonSys.AgentList)
{
	switch (agent.AgentType)
	{
		case 0: break;
		case 1: 
			fieldLoadSum += agent.WorkOverLoad;
			fieldIdleSum += agent.IdleCapacity;
			fieldAlpha = agent.EWMAalpha;
			fieldCount++;
			break;
		case 2: 
			officeLoadSum += agent.WorkOverLoad;
			officeIdleSum += agent.IdleCapacity;
			officeAlpha = agent.EWMAalpha;
			officeCount++;
			break;
		case 3:
			leaderLoadSum += agent.WorkOverLoad;
			leaderIdleSum += agent.IdleCapacity;
			leaderAlpha = agent.EWMAalpha;
			leaderCount++;
			break;
		default : break;	
	}	
}
MonSys ms = EventCoord.PubSubMW.MonSys;
ms.EWMAFieldAgentIdle = (fieldAlpha*fieldIdleSum/fieldCount) + (1-fieldAlpha)*ms.EWMAFieldAgentIdle;
ms.EWMAOfficeAgentIdle = (officeAlpha*officeIdleSum/officeCount) + (1-officeAlpha)*ms.EWMAOfficeAgentIdle;
ms.EWMALeaderAgentIdle = (leaderAlpha*leaderIdleSum/leaderCount) + (1-leaderAlpha)*ms.EWMALeaderAgentIdle;

ms.EWMAFieldAgentLoad = (fieldAlpha*fieldLoadSum/fieldCount) + (1-fieldAlpha)*ms.EWMAFieldAgentLoad;
ms.EWMAOfficeAgentLoad = (officeAlpha*officeLoadSum/officeCount) + (1-officeAlpha)*ms.EWMAOfficeAgentLoad;
ms.EWMALeaderAgentLoad = (leaderAlpha*leaderLoadSum/leaderCount) + (1-leaderAlpha)*ms.EWMALeaderAgentLoad;


EventCoord.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.CreateP;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>28</X>
                            <Y>201</Y>
                          </Location>
                          <DisplayName>Forward</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InQueue</Name>
                          <Id>2efdf883-4f24-4c2c-98c8-dca2a5042ebc</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>2074aadf-65f5-4961-8260-a6f31e527608</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>08c812ef-34df-4239-b466-b5c0da23e2d0</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>6</X>
                            <Y>14</Y>
                          </Location>
                          <DisplayName>InQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>1ba10a0c-c75d-4885-96af-5cd15618a424</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>231b7009-b5e9-4468-9ead-2f228cd29ecf</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>68e74441-0a5f-4f2d-b5bc-d600a6461a2f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>7</X>
                            <Y>43</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>EventDict</Name>
                          <Id>dfa49fa3-ad95-4424-adec-8a4eae63a4f9</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f0e05682-58d6-4d03-895d-379ac89f955a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f5aaf590-1ff6-4a4c-9f78-39577829a4b5</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>65</Width>
                            <Height>24</Height>
                          </Size>
                          <Location>
                            <X>15</X>
                            <Y>140</Y>
                          </Location>
                          <DisplayName>EventDict</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;Simulation.MonSysContext.AgentContext.SubscriberComp,NfyMsg&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;Simulation.MonSysContext.AgentContext.SubscriberComp,NfyMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>cf0cf262-99c2-4c63-a13f-5138c0a4c406</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>9848c33c-6f6b-473c-9dc9-593f37458bc5</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>a1693d5b-04e6-4330-af1e-793819620896</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (EventCoord.EventDict.Count &gt; 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>10</Width>
                            <Height>90</Height>
                          </Size>
                          <Location>
                            <X>75</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>51</X>
                                <Y>43</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>47</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role1Id>
                          <Role2Id>0b6cae23-f311-41f2-92b0-972249972a03</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>d637fb9c-20b4-4b5e-9c70-b2c375070b39</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>d1b935f4-6170-419b-8843-727c7bfc78d2</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>869d5813-7135-43c8-b2fa-798b11834fb4</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (EventCoord.InQueue.Count &gt; 0 &amp;&amp; EventCoord.isIdle == true);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Forward.EventCoord.isIdle = false;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>4</Width>
                            <Height>90</Height>
                          </Size>
                          <Location>
                            <X>125</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>97</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>95</X>
                                <Y>43</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0b6cae23-f311-41f2-92b0-972249972a03</Role1Id>
                          <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdleInternal</Name>
                          <Id>0764f164-1033-45bf-aed3-74d0d3aee379</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>b07ed44c-a83c-45a7-861f-9b4c0288fc4f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>afb159ae-66b7-4d34-b05f-a48ed0567183</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>162</X>
                            <Y>19</Y>
                          </Location>
                          <DisplayName>isIdleInternal</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9234e8d0-0e5b-4ca2-b7f5-dbe0eb9862fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>172</Width>
                      <Height>262</Height>
                    </Size>
                    <Location>
                      <X>15</X>
                      <Y>24</Y>
                    </Location>
                    <DisplayName>EventCoord</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>1</CreateP>
                    <ReadP>1</ReadP>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMAvgMsgDelivered</Name>
                    <Id>9461c7d5-2e76-4d46-927e-593fdda95daf</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>471b08ce-6c88-4075-a413-5f045c707d20</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f572d32e-05b4-4a31-9636-0e8e456df9f8</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>156</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>204</X>
                      <Y>39</Y>
                    </Location>
                    <DisplayName>EWMAvgMsgDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>MsgLastDelivered</Name>
                    <Id>ff63e7c8-845a-4c48-9d5d-f94ffbc5caa8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>419263cd-097f-4739-9b32-de992fb29a7f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>75684520-b092-4df7-8bfc-33b2e38d13c7</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>107</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>210</X>
                      <Y>112</Y>
                    </Location>
                    <DisplayName>MsgLastDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EventProcessed</Name>
                    <Id>4647351e-4eec-414f-9436-99f57cbd55dc</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>6c621d54-7d5f-404c-8ea4-424440628f74</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>538a93d0-d487-4d6e-9168-abec2169b8da</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>206</X>
                      <Y>89</Y>
                    </Location>
                    <DisplayName>EventProcessed</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalMsgDelivered</Name>
                    <Id>e56a8fbb-c3d7-45a3-b4a6-54a7127955b6</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>e8caccd0-b088-4c47-96fd-b731cfb0e089</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7edd79f3-9dc0-47d0-a25a-944aebbf0edb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>113</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>203</X>
                      <Y>65</Y>
                    </Location>
                    <DisplayName>TotalMsgDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMAvgEventsProcessed</Name>
                    <Id>f941417c-2e2f-49eb-8cb0-2bcc3bfa07cd</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>227b6b72-071f-4c1e-b210-2a566c39bfe9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ad7ca947-5bb2-40c3-a32a-aa22a76c8602</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>158</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>203</X>
                      <Y>15</Y>
                    </Location>
                    <DisplayName>EWMAvgEventsProcessed</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>bc116251-7a0b-4260-b56e-3e621f2e8b21</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>327</Width>
                <Height>300</Height>
              </Size>
              <Location>
                <X>593</X>
                <Y>35</Y>
              </Location>
              <DisplayName>PubSubMW</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>PubMsg</Name>
              <Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>69c51788-1b1b-49a6-aa69-e46867a1a310</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>64342a55-5b69-4c47-b450-6b14e75f3e5f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1f366bd0-c1ac-4a02-acd9-80eb1b3527d5</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].InQueue.Enqueue(PubMsg);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>SituationId</Name>
                    <Id>ca5b6bea-ac44-4232-b3db-9ff5a2b5f37d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>ea7c2d76-3476-429d-843b-bc272dcf6ce9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3a550d22-c53a-4f12-9984-6b92650447c4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>83</Y>
                    </Location>
                    <DisplayName>SituationId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Sender</Name>
                    <Id>bf0a98d3-b0a7-4aec-83d2-c1d9eb6489a5</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>aaea9500-caad-46ba-ac72-9ce3ecedfba1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e0af8130-ace4-41b8-b8a6-d12c26a6fe52</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>55</Y>
                    </Location>
                    <DisplayName>Sender</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>MonSysContext.AgentContext.PublisherComp</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>dd991929-3d0e-41ee-88a4-b29df54d9102</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>120</Height>
              </Size>
              <Location>
                <X>347</X>
                <Y>37</Y>
              </Location>
              <DisplayName>PubMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>TopicRef</Name>
              <Id>70e29034-4f33-4125-ac51-d0a3389f8d0f</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>58001520-2970-4b06-af41-b7b8c1585b56</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8d2946b9-595e-4250-9b7a-ac5961dd9794</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>14</Width>
                <Height>18</Height>
              </Size>
              <Location>
                <X>384</X>
                <Y>157</Y>
              </Location>
              <DisplayName>TopicRef</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>51</X>
                    <Y>120</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>35</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow1</Name>
              <Id>46aa1f74-6947-4c95-b79c-405f302a290d</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>a5306596-497c-43fa-9af4-27533732e9ff</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>6d2dcf71-2e6e-4b63-9ab9-f5a3c62bf9d4</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Publish.newEvent;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>73</Width>
                <Height>10</Height>
              </Size>
              <Location>
                <X>282</X>
                <Y>83</Y>
              </Location>
              <DisplayName>NewTriggerFlow1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>120</X>
                    <Y>17</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
              <Role2Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow</Name>
              <Id>43c38c9a-0da0-4e67-8c9e-a4fd7f8afd4c</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>d6d84785-b77b-4fb9-a347-ce095c181387</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>590306b3-1fb3-4766-9ee9-848d4f773aca</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return (Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle);
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>//Receive.EventCoord.isIdle = false;
Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle = false;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>177</Width>
                <Height>65</Height>
              </Size>
              <Location>
                <X>465</X>
                <Y>83</Y>
              </Location>
              <DisplayName>NewTriggerFlow</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>110</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>21</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role1Id>
              <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentTypeConfig</Name>
              <Id>ad689e1f-803b-4364-bf15-236c407d5527</Id>
              <Structure xsi:type="VariableStructure">
                <Id>2e22ff0b-d6a6-451c-a723-257bb44f78f2</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>a314fb25-b914-4bc8-a9eb-234ac6302378</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>100</Width>
                <Height>24</Height>
              </Size>
              <Location>
                <X>338</X>
                <Y>1</Y>
              </Location>
              <DisplayName>AgentTypeConfig</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;int&gt;</ImplementationType>
              <InitialValue>new List&lt;int&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>HotSpot</Name>
              <Id>40ee8080-94e9-41ab-b53c-9a3d8f1f6643</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>b74ea3ac-aeff-47d6-a1d4-23bc786b5050</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DurDict</Name>
                    <Id>7ce70a00-7b68-4d3f-96e9-da8ebf182dbd</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>e73f3339-8e4b-47d0-ba98-cd2bbfbff559</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d133a200-9f4f-46fb-a32b-6a4456c7d5e9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>22</X>
                      <Y>138</Y>
                    </Location>
                    <DisplayName>DurDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>CurrHotSpotId</Name>
                    <Id>c4f8b7f4-daef-43c0-848a-9ab714ab3b6d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>5febc841-f95c-4ccd-a0a4-73142229564c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>883372b6-38e5-4412-8cb7-05fcc08cc836</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>24</X>
                      <Y>54</Y>
                    </Location>
                    <DisplayName>CurrHotSpotId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>UndetectedDict</Name>
                    <Id>7c6533b5-23c4-4b34-b47f-cfd800300180</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1ff9198a-2dd7-45c5-ae20-d51d608ac7b1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b1a9b9a0-05bb-4a17-8085-b04b74a1f19f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>22</X>
                      <Y>76</Y>
                    </Location>
                    <DisplayName>UndetectedDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>SwitchHotSpot</Name>
                    <Id>ddf21a32-ba3e-476b-ae92-542866135ded</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>ec60ce19-1814-41b3-8f29-6f5b814485de</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>92027f12-aa94-4d02-b2de-99da8e662760</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>HotSpot.CurrHotSpotId++;
HotSpot.Undetected = HotSpot.UndetectedDict.Count;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;
String hsUn = "";
foreach (int hsid in HotSpot.UndetectedDict.Keys)
{
	hsUn = hsUn+", "+hsid;
}
DomainProAnalyst.Instance.Report("Undetected Situations: "+hsUn+" @:"+timeNow);
HotSpot.UndetectedDict.Add(HotSpot.CurrHotSpotId,timeNow);
HotSpot.LastDuration = timeNow - HotSpot.SwitchMoment;
HotSpot.SwitchMoment = timeNow;

// reset all sensors
foreach(Topic topic in HotSpot.MonSys.TopicGroupList[0].Topics)
{
	topic.IsPartOfHotspot = false;
}
// set new hotspot sensor set
// select nr of groups
int topicCount = HotSpot.MonSys.TopicGroupList[0].Topics.Count-15;
if (topicCount == 0)
	return;
double alpha = 1;
double beta = 3;
int sel = (int)Math.Floor(Math.Max(1, Random.Beta(alpha, beta)*topicCount)+8);
DomainProAnalyst.Instance.Report("Hotspot Switching Situation "+HotSpot.CurrHotSpotId+" with burst sensor topics: "+sel);
// select groups
HotSpot.EventBurstSourceCount = sel;
while (sel &gt; 0 &amp;&amp; topicCount &gt; 0) {
   if( Random.Uniform() &lt; sel / topicCount ) {
	// set to burst mode
	HotSpot.MonSys.TopicGroupList[0].Topics[topicCount-1].IsPartOfHotspot = true;
      sel--;
   }
   topicCount--;
}
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>33</Height>
                    </Size>
                    <Location>
                      <X>17</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>SwitchHotSpot</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>Timer</Name>
                    <Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>eca9ea11-5c79-4de0-81ab-7eda4f770a98</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a3c07e89-cd14-4409-b874-ba28b0c3e430</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>//return Random.LogNormal(0, 0.5)*10+10;
return MonSys.AgentList[0].WorkExeDuration*6+10;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>66</Width>
                      <Height>40</Height>
                    </Size>
                    <Location>
                      <X>165</X>
                      <Y>19</Y>
                    </Location>
                    <DisplayName>Timer</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow</Name>
                    <Id>0a3f2a5e-a769-4c20-83de-2af4ff196df2</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>98d856b3-a191-42ab-8118-02f0ead60394</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>618be2fc-0421-4fc1-99d3-3714d439f576</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>38</Width>
                      <Height>19</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>110</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>17</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role1Id>
                    <Role2Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role2Id>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow1</Name>
                    <Id>91a8d82f-16da-4091-af58-afb58f932962</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>00bbb6d6-34a7-4672-b150-424bc8f67ea0</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f249c463-2b3f-4864-bc65-4d61e825165d</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>38</Width>
                      <Height>9</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>50</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>110</X>
                          <Y>33</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role1Id>
                    <Role2Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role2Id>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>SwitchMoment</Name>
                    <Id>02851ecf-edd4-42d1-ab91-0cdd7b0d6937</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>2aa3f51f-d967-4308-a6a9-85cf443898ec</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>46eb56c0-8b22-4a6e-b5ce-da91e89aa708</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>22</X>
                      <Y>164</Y>
                    </Location>
                    <DisplayName>SwitchMoment</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DetectionDuration</Name>
                    <Id>3bd32e2e-aa96-4e13-a9b9-8d62b6736d88</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>46298267-e155-4336-a3c7-ed3975acf93a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4c372b2e-f727-4231-b391-dc731617d92f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>19</X>
                      <Y>217</Y>
                    </Location>
                    <DisplayName>DetectionDuration</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>LastDuration</Name>
                    <Id>b7d5adfc-d4ea-4dd8-8837-d9af8d517a61</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>02b69dfd-306f-48e4-8135-e979c10a5647</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1f5830f5-2c81-44c4-8599-63d4d99c63cd</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>20</X>
                      <Y>189</Y>
                    </Location>
                    <DisplayName>LastDuration</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Undetected</Name>
                    <Id>d9927d80-a3f7-4dfb-99b9-6f7b699b9665</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>9bcd9f0f-163b-4da9-b157-1515da1f185b</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a96e3b35-b665-4742-8f12-75f29b67a7a4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>26</X>
                      <Y>107</Y>
                    </Location>
                    <DisplayName>Undetected</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>EventBurstSourceCount</Name>
                    <Id>7ac8e681-f162-4842-bd1d-53f6b86d8a71</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>c20a9a7a-7458-4514-921b-da436ad777db</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>14577ebb-d91a-4210-b35c-4cf5b32bdb6e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>116</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>17</X>
                      <Y>247</Y>
                    </Location>
                    <DisplayName>EventBurstSourceCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad64fc9c-c998-4c93-9133-4408511431a6</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>CurrHotSpotId = 0;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;
UndetectedDict.Add(CurrHotSpotId,timeNow);
SwitchMoment = timeNow;

</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>207</Width>
                <Height>290</Height>
              </Size>
              <Location>
                <X>1006</X>
                <Y>30</Y>
              </Location>
              <DisplayName>HotSpot</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentPubTopic</Name>
              <Id>3381378b-dffd-4636-b856-52ccb3faad9f</Id>
              <Structure xsi:type="VariableStructure">
                <Id>ef0262da-0166-410e-8d47-84399ec88169</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>97b541c8-84aa-46e3-94d1-3e3e228eebc9</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>100</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>451</X>
                <Y>5</Y>
              </Location>
              <DisplayName>AgentPubTopic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;Topic&gt;</ImplementationType>
              <InitialValue>new List&lt;Topic&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>NewFocusOnObjConn</Name>
              <Id>7a9d3bb6-83ce-4b3d-a130-82958df911b3</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>57b22209-157c-40c5-ab66-f5b7cf6020ac</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>47f41abd-5d11-47bc-9217-4fab7a31940a</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>203</Width>
                <Height>336</Height>
              </Size>
              <Location>
                <X>295</X>
                <Y>423</Y>
              </Location>
              <DisplayName>NewFocusOnObjConn</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>200</X>
                    <Y>18</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>55</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Role1Id>
              <Role2Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role2Id>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>NewObjectRefConnection</Name>
              <Id>bf2eadb7-aadb-41bc-9230-5e6def8bfede</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>bc789f44-e799-4d73-b9a2-75ce0532f170</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d1520922-aebb-4cc5-8a70-448ff4e986be</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>20</Width>
                <Height>12</Height>
              </Size>
              <Location>
                <X>478</X>
                <Y>356</Y>
              </Location>
              <DisplayName>NewObjectRefConnection</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>129</X>
                    <Y>181</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>NewFocusOnObjConn1</Name>
              <Id>7e1adbfd-90dc-4775-950b-0226613ba5cd</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>4e9e6e99-a196-46fe-a248-3671642b4c63</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>f85041d4-5d95-41cc-8354-c2dd8d7efbd6</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>118</Width>
                <Height>330</Height>
              </Size>
              <Location>
                <X>490</X>
                <Y>321</Y>
              </Location>
              <DisplayName>NewFocusOnObjConn1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>262</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>125</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>f9b2f383-d76c-44a5-bc40-e192ec129c09</Role1Id>
              <Role2Id>c6932e1e-1af9-489a-9383-c76e6cc11472</Role2Id>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>TopicGroup</Name>
              <Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>9d7a4070-61d6-4738-bb9d-e29d83cc54df</Id>
                <Types>
                  <anyType xsi:type="ObjectData">
                    <Name>Topics</Name>
                    <Id>7b126fb8-d010-4a41-be94-7e5ed9c0eb77</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>0ccfad9e-389f-44ba-8c5d-8e90a161c4a1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>78b6921f-e76b-4d06-b619-c6ef9553f52b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>20</Y>
                    </Location>
                    <DisplayName>Topics</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                    <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>GroupNameId</Name>
                    <Id>ba91aed0-8bb6-435f-8806-2315fe458faa</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>8f72bc0a-1689-4c77-86f9-317e91f69a2c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>cff4f7dc-e5e4-4a2b-83f3-401b735e8d17</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>44</Y>
                    </Location>
                    <DisplayName>GroupNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>2560cecb-ef1b-43bf-86db-2aa0ac452134</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>74</Height>
              </Size>
              <Location>
                <X>498</X>
                <Y>368</Y>
              </Location>
              <DisplayName>TopicGroup</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>NfyMsg</Name>
              <Id>c6932e1e-1af9-489a-9383-c76e6cc11472</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>290176d1-8419-49c7-9d0c-e50919956f26</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>993e21c6-045b-413f-a783-257c6246a3c4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7186bc46-bd5a-4db6-b3b1-a75845776e4e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0.001;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>22</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>MsgList</Name>
                    <Id>4bd42898-0ce0-4add-9cde-02f80ee5014f</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>b1933403-c1ba-4c12-b36d-a057bfb0816d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>701e2872-74ab-49b3-9f2e-76314b4a7d49</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>102</Width>
                      <Height>26</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>56</Y>
                    </Location>
                    <DisplayName>MsgList</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;PubMsg&gt;</ImplementationType>
                    <InitialValue>new List&lt;PubMsg&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Receiver</Name>
                    <Id>ad14f68f-026a-4703-92f1-c440800fca1f</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>882bd524-3551-4021-8d12-c8b245dd6d15</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4d157456-f6d2-4b96-8b4c-7bcad8c9a1bc</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>11</X>
                      <Y>85</Y>
                    </Location>
                    <DisplayName>Receiver</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Simulation.MonSysContext.AgentContext.SubscriberComp</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>63ce7384-9edb-4770-ba46-7287593be66d</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>115</Height>
              </Size>
              <Location>
                <X>365</X>
                <Y>651</Y>
              </Location>
              <DisplayName>NfyMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>Topic</Name>
              <Id>06842019-c2e7-4252-8b63-71dbef10c28f</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>02feb813-8af3-4f46-8bbf-bd29fdbd85ea</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Subscribers</Name>
                    <Id>ab4b60b6-7c76-4e9e-9991-f31c4b8d16df</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>f310a45d-c9cc-49b6-8690-70f5f4d137e4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>bde409ae-8a5a-412d-a162-db8040092220</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>125</Y>
                    </Location>
                    <DisplayName>Subscribers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.SubscriberComp&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.SubscriberComp&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Publishers</Name>
                    <Id>3e50ad75-d368-455d-a45f-bff71a8f38a1</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>a15436d8-2aa4-4b65-a440-27e195bd5439</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>beb42bce-fc1a-420e-9b11-e72943285848</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>72</Y>
                    </Location>
                    <DisplayName>Publishers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.PublisherComp&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.PublisherComp&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>TopicNameId</Name>
                    <Id>f91cd1d8-e217-46a2-81a1-5599f0e8ef60</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>def7b254-277a-418d-a6d0-9762e6b5a0f5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4405e15b-4978-4b8a-b12f-a8cc189209a3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>41</Y>
                    </Location>
                    <DisplayName>TopicNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>PubCount</Name>
                    <Id>7e2fe468-4a9a-4070-919c-60f473e3028e</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>36576409-c7ad-438f-aa6b-f4b045723abd</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a58ba50c-3ca5-4595-bf85-8fc63eba3a5e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>93</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>SubCount</Name>
                    <Id>c8a2274c-439c-4e37-8e95-3918a365aec5</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1133498e-ff29-4a21-a274-e526f5513e8d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>79bb39c9-babd-4b0e-aec1-294436e3c224</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>149</Y>
                    </Location>
                    <DisplayName>SubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>IsPartOfHotspot</Name>
                    <Id>1e3895cb-15ad-4c8a-b009-1e8297e1bfba</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>7ca67f97-643a-41da-bae7-162686c90e59</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7554866c-ccfb-44dd-b72c-b284431396d3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>IsPartOfHotspot</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d4572af9-69c5-4fc5-9398-9a5c868dea71</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>129</Width>
                <Height>181</Height>
              </Size>
              <Location>
                <X>349</X>
                <Y>175</Y>
              </Location>
              <DisplayName>Topic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAFieldAgentLoad</Name>
              <Id>20259082-57cb-428a-bd5d-7985da6a5dd4</Id>
              <Structure xsi:type="VariableStructure">
                <Id>959b7ae2-1faf-40a5-92d7-fbe8edee59b8</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>e3b15e6c-822f-4834-a4f5-1b2f95960846</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>133</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>930</X>
                <Y>379</Y>
              </Location>
              <DisplayName>EWMAFieldAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAOfficeAgentIdle</Name>
              <Id>25ace47c-2626-46e5-b502-a426145bd2d6</Id>
              <Structure xsi:type="VariableStructure">
                <Id>2f226a4f-c2ac-4c5e-b365-e3f884f85255</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c22af195-dc10-4e1b-bddd-b25ebf58ac2b</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>133</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>929</X>
                <Y>402</Y>
              </Location>
              <DisplayName>EWMAOfficeAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAOfficeAgentLoad</Name>
              <Id>29d6b1e1-532f-420c-a09d-d85078ff059a</Id>
              <Structure xsi:type="VariableStructure">
                <Id>16a406a0-d9db-4f1a-89b3-5e967e5df8a1</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>4c85074e-b5fd-4fea-89bf-27e81120a9c4</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>144</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1068</X>
                <Y>356</Y>
              </Location>
              <DisplayName>EWMAOfficeAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAFieldAgentIdle</Name>
              <Id>309516c2-b524-4adc-8c3c-cbeb34da845b</Id>
              <Structure xsi:type="VariableStructure">
                <Id>a2f01d75-9c0d-4314-83fd-7d3901fe79e0</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8a946b39-c855-426e-8f51-fab8141ebb3a</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>133</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>928</X>
                <Y>351</Y>
              </Location>
              <DisplayName>EWMAFieldAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMALeaderAgentIdle</Name>
              <Id>ee2e6720-4738-4622-a1f1-0158e7f8a6ba</Id>
              <Structure xsi:type="VariableStructure">
                <Id>df35a5f0-5e40-4aba-b281-89f50a8d8a5e</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>1bc318cb-aac4-4dd8-ad92-10438ce14483</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>149</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1068</X>
                <Y>377</Y>
              </Location>
              <DisplayName>EWMALeaderAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMALeaderAgentLoad</Name>
              <Id>78ce5f90-3d6a-4747-bf1c-23dda0dcb6b6</Id>
              <Structure xsi:type="VariableStructure">
                <Id>c8864bf7-4a3b-4f81-a3e7-e6800cfabcb2</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>492e6ac6-db01-46f0-b73f-8d20185eb802</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>148</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1069</X>
                <Y>402</Y>
              </Location>
              <DisplayName>EWMALeaderAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>AccessCoordinator</Name>
              <Id>aee52842-b2b0-4595-9b3c-2641f757ebae</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>724401eb-853a-44ad-8737-a5c9ed0c317b</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>ConflictDetection</Name>
                    <Id>3ca8ab80-d0ef-44be-b9fa-be86a61eba55</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>adc67ee8-4c41-4511-87a0-0d1e1a8dfef0</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>CheckUpdate</Name>
                          <Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>bc09bde5-cacd-4803-ab12-8e004c85be07</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b9c5bb54-a551-4532-a162-9c851a07d6ac</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>ConflictDetection.isIdle = false;
if (!ConflictDetection.isIdleInternal)
	return;
ConflictDetection.isIdleInternal = false;

while (ConflictDetection.InQueue.Count &gt; 0)
{	
	StatusArtifact sa = ConflictDetection.InQueue.Dequeue();	
			
	while ((sa.UpdateList == null || sa.UpdateList.Count == 0)&amp;&amp; ConflictDetection.InQueue.Count &gt; 0)
	{
		sa = ConflictDetection.InQueue.Dequeue();
	}
	Simulation.MonSysContext.StatusArtifactContext.Update up = sa.UpdateList[0];	
	// each change results in the SA to be placed in the ChangedCode queue, 
	// so we only observe the first UPDATE list item, and remove it after processing.
	if (up.UpdateOnVersion == sa.Version &amp;&amp; sa.Version == 0) 
	{			
		// new Code
		sa.Version++;
		up.isUpdateSuccess = true;
	}	
	else
	{	
		if (up.UpdateOnVersion != sa.Version) 
		{			
			sa.NrConflicts++;
			up.isUpdateSuccess = false;
			ConflictDetection.AccessCoordinator.UpdateConflict++;
		}
		else
		{
			up.isUpdateSuccess = true;
			sa.Version++;
			ConflictDetection.AccessCoordinator.UpdateSuccess++;
			// set the Link to the Update object that contains the right update, 
			// other updates afterwards are bound to fail
			// set the link in any case, as both success and failure cases need it
		}					
	}
	sa.UpdateList.RemoveAt(0);
	ConflictDetection.OutQueue.Enqueue(up);
}
ConflictDetection.isIdleInternal = true;	
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return ConflictDetection.AccessCoordinator.WorkExeDuration;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>34</X>
                            <Y>68</Y>
                          </Location>
                          <DisplayName>CheckUpdate</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Create">
                          <Name>UpdateFeedback</Name>
                          <Id>31041579-84e3-469c-8ff8-91072f48222f</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>c165e49c-7d20-40d6-8b5c-020f9596183c</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>92546a68-d892-4419-bc9d-04f0c7286c45</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>while (ConflictDetection.OutQueue.Count &gt; 0)
{
	Simulation.MonSysContext.StatusArtifactContext.Update up = ConflictDetection.OutQueue.Dequeue();
	//up.WorkingOnUpdate.ReadFeedback(false); not working because LINK is null, not sure why, should not be.
	up.Responsible.ReadFeedback(false);
}
ConflictDetection.isIdle = true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>35</X>
                            <Y>153</Y>
                          </Location>
                          <DisplayName>UpdateFeedback</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InQueue</Name>
                          <Id>ab993a31-949d-4750-96d3-3aef1759d5a9</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>47995839-8fd7-45ae-a433-477b4c25d2bd</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d6ccda67-ff54-4d64-a0f1-fa99341c324f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>6</X>
                            <Y>14</Y>
                          </Location>
                          <DisplayName>InQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;StatusArtifact&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;StatusArtifact&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>519e3bb5-4b45-40b5-94d5-d99e6a8389e7</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>2fffadd0-faef-4bc7-b6b4-bab529e84b48</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>a98481f3-69bb-460d-b82d-607da703b8dd</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>86</X>
                            <Y>21</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>83be21fb-811c-4cc5-ab00-a0f74d9789c8</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>d766f7ce-5e5d-42f3-8b1a-7cddc81d733e</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d5fc1675-1bcf-4f50-b18e-6547535096d5</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (CheckUpdate.ConflictDetection.OutQueue.Count &gt; 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>3</Width>
                            <Height>42</Height>
                          </Size>
                          <Location>
                            <X>82</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>51</X>
                                <Y>43</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>47</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role1Id>
                          <Role2Id>31041579-84e3-469c-8ff8-91072f48222f</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>6b53134e-2bb0-4694-9de0-c771acf63724</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>25d07f4b-8122-4e1c-aa36-a0b777d782b7</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>48868bf0-43ba-4794-8c33-2f09b4e6442e</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (ConflictDetection.InQueue.Count &gt; 0 &amp;&amp; ConflictDetection.isIdle == true);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>UpdateFeedback.ConflictDetection.isIdle = false;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>3</Width>
                            <Height>42</Height>
                          </Size>
                          <Location>
                            <X>129</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>97</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>95</X>
                                <Y>43</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>31041579-84e3-469c-8ff8-91072f48222f</Role1Id>
                          <Role2Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdleInternal</Name>
                          <Id>d0e808bd-9d59-44ba-a77b-5bc46c12848f</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>35fb7aa4-2508-4df7-a955-c61853a6da7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7b8cec9b-cf9d-45f6-90a9-132b39a90ae4</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>162</X>
                            <Y>19</Y>
                          </Location>
                          <DisplayName>isIdleInternal</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>OutQueue</Name>
                          <Id>53d2ea5d-1e77-47d8-8bc1-ee926b25db1b</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>19732496-7140-40e4-b7d9-da62d04069c4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>17f64bce-e2c5-4a45-a918-970867782e78</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>73</Width>
                            <Height>21</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>115</Y>
                          </Location>
                          <DisplayName>OutQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;Simulation.MonSysContext.StatusArtifactContext.Update&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;Simulation.MonSysContext.StatusArtifactContext.Update&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b5d1e8fd-9cb7-402d-806e-4ade08cb6dee</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>174</Width>
                      <Height>244</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>21</Y>
                    </Location>
                    <DisplayName>ConflictDetection</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateSuccess</Name>
                    <Id>112d5e5a-8270-433b-821c-14ee0d0837ae</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4f379cdd-268e-43ba-a30f-b60d1f24dd44</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>500d5191-0bb0-4693-95fa-605ce4ae76fb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>226</X>
                      <Y>24</Y>
                    </Location>
                    <DisplayName>UpdateSuccess</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflict</Name>
                    <Id>b329dfcb-d372-4c29-a9b6-e74140ed6de4</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>d4fcf0fc-812e-47c0-bb18-ce7a01dee140</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>debf1083-8c4f-4fd6-875e-9950c316dfb9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>229</X>
                      <Y>49</Y>
                    </Location>
                    <DisplayName>UpdateConflict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>52294e0c-2303-4e50-8367-ff3bb4d60312</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>339</Width>
                <Height>281</Height>
              </Size>
              <Location>
                <X>573</X>
                <Y>456</Y>
              </Location>
              <DisplayName>AccessCoordinator</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <WorkExeDuration>0.1</WorkExeDuration>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="CollabSequence">
              <Name>NewCollabSequence</Name>
              <Id>4711f74e-51b3-4fac-b813-55d7179d177b</Id>
              <Structure xsi:type="CollabSequenceStructure">
                <Id>58e3875f-d471-4a17-9859-7d002bc029d7</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ff833c8d-37a1-4080-ae68-169b0cfd370a</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Context;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>375</Width>
                <Height>347</Height>
              </Size>
              <Location>
                <X>247</X>
                <Y>303</Y>
              </Location>
              <DisplayName>NewCollabSequence</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillColor>
                  <Argb>-16777216</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>20</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>93</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>31041579-84e3-469c-8ff8-91072f48222f</Role1Id>
              <Role2Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role2Id>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>StatusArtifact</Name>
              <Id>efe13d03-d29f-4bc0-bac9-e5162a14d3f1</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>7d4e064d-dffc-4da5-9bab-a56918074710</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Version</Name>
                    <Id>b1b2e753-34d9-4a42-ab22-2f507032aa6d</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>c40e2eb4-ed29-434a-bd69-a65abfebca0b</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9dd7c1f5-be35-4398-919d-207e0f7568db</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>57</Y>
                    </Location>
                    <DisplayName>Version</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>NrConflicts</Name>
                    <Id>3f9898bd-ec8c-4556-802e-a15257c5f7f8</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>28f58a4a-cd78-4e53-8fe3-fa11ba649800</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b7ffc832-d6e0-432c-a00c-02fb1b0c28e0</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>84</Y>
                    </Location>
                    <DisplayName>NrConflicts</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>Updated</Name>
                    <Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>6860e4b7-b04e-4cd9-a8f2-94f1976d0547</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>86d7e906-ee46-4b6e-a12c-d8200519bd5f</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].InQueue.Enqueue(StatusArtifact);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>21</Y>
                    </Location>
                    <DisplayName>Updated</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="TriggerDataSet">
                    <Name>Update</Name>
                    <Id>d0cb41ac-51a0-4fe3-b392-34b564bcabf7</Id>
                    <Structure xsi:type="TriggerDataSetStructure">
                      <Id>44638692-761c-4b0f-9517-ebf94e619b87</Id>
                      <Types>
                        <anyType xsi:type="Variable">
                          <Name>UpdateOnVersion</Name>
                          <Id>e44ab984-5ca9-4a77-95a8-cfdc2b54812a</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>84c713cd-d414-4c01-aa1a-97f1e92edaa9</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ddfb514f-b041-42df-a8b2-e7ee128908f1</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>4</X>
                            <Y>17</Y>
                          </Location>
                          <DisplayName>UpdateOnVersion</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Scope</Name>
                          <Id>64b1376e-9d9b-4236-bd8e-4292a739fc02</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>bf8cc459-69d2-446d-9074-ac9fda193fae</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>c5b85c3f-e96f-475b-a555-32d5eaff9932</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>98</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>40</Y>
                          </Location>
                          <DisplayName>Scope</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>1.0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isUpdateSuccess</Name>
                          <Id>a61bced6-f737-4c5f-9943-165cef35ee53</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7eb1fe86-cd48-4b0b-8945-9480288d4e0f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>561028e1-0460-4f2d-95bd-d4baddc6e726</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>65</Y>
                          </Location>
                          <DisplayName>isUpdateSuccess</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>false</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Responsible</Name>
                          <Id>b7c73d55-34ec-492e-854b-5db0a7a2cbb4</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>50491327-104a-4542-a3ce-6108aed8b22c</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>27abf8a1-ba25-46b2-8e23-8051c3ac482f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>90</Y>
                          </Location>
                          <DisplayName>Responsible</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Simulation.MonSysContext.AgentContext.Contributor</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>852a2613-accc-41ab-9bb2-573ab2cf3d95</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>107</Width>
                      <Height>116</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>108</Y>
                    </Location>
                    <DisplayName>Update</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>9b6b0556-0579-4404-85ef-72646925635d</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>228</Height>
              </Size>
              <Location>
                <X>346</X>
                <Y>370</Y>
              </Location>
              <DisplayName>StatusArtifact</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow7</Name>
              <Id>495afea2-dc63-4d64-b08e-b94785f30ad5</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>fee9505b-0d5b-4dc4-8817-603151551558</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>23d13771-ca16-4e48-ac22-fe203c640e66</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return !UpdateStatus.isError;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return UpdateStatus.Contributor.SharedStatusArtifact;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>73</Width>
                <Height>27</Height>
              </Size>
              <Location>
                <X>280</X>
                <Y>393</Y>
              </Location>
              <DisplayName>NewTriggerFlow7</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>91</X>
                    <Y>34</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role1Id>
              <Role2Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerRefConn">
              <Name>WorkingOnUpdate</Name>
              <Id>93cf6486-efbf-4508-b459-e0f1e3fd1eee</Id>
              <Structure xsi:type="TriggerRefConnStructure">
                <Id>beb9bba6-2e8d-4011-88e3-63b245385a9e</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>68c5167a-bf2c-43da-b79b-bff7fbc2affe</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>64</Width>
                <Height>52</Height>
              </Size>
              <Location>
                <X>291</X>
                <Y>426</Y>
              </Location>
              <DisplayName>WorkingOnUpdate</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-16776961</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>200</X>
                    <Y>142</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>74330db1-511a-4338-a51b-1bf36e53635c</Role1Id>
              <Role2Id>d0cb41ac-51a0-4fe3-b392-34b564bcabf7</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow8</Name>
              <Id>645b7985-e22b-4f22-8ca0-d4410b610804</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>e7ae3c6a-e5c8-46b0-94f7-d18057b2da71</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c51d22a4-02b2-40ce-83c8-aef045258b65</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return (Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].isIdle);
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].isIdle = false;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>158</Width>
                <Height>154</Height>
              </Size>
              <Location>
                <X>463</X>
                <Y>391</Y>
              </Location>
              <DisplayName>NewTriggerFlow8</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>110</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Role1Id>
              <Role2Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role2Id>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>SharedStatusArtifact</Name>
              <Id>33dbcfff-f138-4a96-9a23-7cbc4ee75911</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>b3cb99d5-b5b0-4b16-ae3b-9feae8c97959</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>43ecb26c-99d5-4bac-a94a-d70d4442d059</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>55</Width>
                <Height>24</Height>
              </Size>
              <Location>
                <X>291</X>
                <Y>346</Y>
              </Location>
              <DisplayName>SharedStatusArtifact</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>200</X>
                    <Y>62</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>74330db1-511a-4338-a51b-1bf36e53635c</Role1Id>
              <Role2Id>efe13d03-d29f-4bc0-bac9-e5162a14d3f1</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow2</Name>
              <Id>3a06e665-b71e-48ba-984f-e21d5af916e9</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>8a7c9849-fd49-4ebd-acc5-ce3d674a81c7</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad746893-5a1e-4a5d-a66d-b49c3aae875e</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Receive.notification = Created.NfyMsg;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.NfyMsg.Receiver;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>136</Width>
                <Height>90</Height>
              </Size>
              <Location>
                <X>236</X>
                <Y>702</Y>
              </Location>
              <DisplayName>NewTriggerFlow2</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>120</X>
                    <Y>31</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Role1Id>
              <Role2Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role2Id>
            </anyType>
          </Types>
        </Structure>
        <Text xsi:type="DP_Text">
          <Id>282ce0c6-bf04-477f-92c7-7dd8aaf16917</Id>
          <Instructions>
            <Instruction>
              <Name>Startup</Name>
              <String>if (SeedU &gt; 0 &amp;&amp; SeedV &gt; 0)
{
	Random.Seed(SeedU, SeedV);
}

TopicGroup topicG0 = Create("TopicGroup") as TopicGroup;
topicG0.GroupNameId = "Sensor";
TopicGroup topicG1 = Create("TopicGroup") as TopicGroup;
topicG1.GroupNameId = "FieldAgent";
TopicGroup topicG2 = Create("TopicGroup") as TopicGroup;
topicG2.GroupNameId = "BackOfficeAgent";
TopicGroup topicG3 = Create("TopicGroup") as TopicGroup;
topicG3.GroupNameId = "BackOfficeLeader";


Topic topic = null; //Create("Topic") as Topic;
//topic.TopicNameId = "Sensor";
//topic = Create("Topic") as Topic;
//topic.TopicNameId = "FieldAgent";

// List of Object DPStartInstance : Model.Simulation.StartInstances
// public List&lt;DP_StartInstance&gt; StartInstances
// Type == Agent, read count value
int total = 0;
foreach (DP_StartInstance si in Model.Simulation.StartInstances)
{
	if (si.Type == "MonSys")
	{
		foreach (DP_StartInstance i in si.Instances) {	
		if (i.Type == "Agent")
		{
			total = i.Count;
			break;
		}}
	}
}
// for now, generate only sensors, field agents, and backoffice agents
//int total = AgentList.Count;
if (total &lt;= 0)
	total = 1111;
//DomainProAnalyst.Instance.Report("Nr of Agents:"+total);
int sensorC = Math.Min((int)Math.Floor(total*SensorRatio),(int)Math.Floor(total-3d));
DomainProAnalyst.Instance.Report("Nr of Sensors: "+ sensorC);

int fieldC = Math.Max(1,Math.Min((int)Math.Floor(total*FieldAgentRatio),(int)Math.Floor(total-2d)));
DomainProAnalyst.Instance.Report("Nr of FieldAgents: "+ fieldC);

int officeC = Math.Max(1,Math.Min((int)Math.Floor(total*BackOfficeRatio),(int)Math.Floor(total-1d)));
DomainProAnalyst.Instance.Report("Nr of OfficeAgents: "+ officeC);

int leaderC = Math.Max(1,(int)Math.Floor(total*TeamLeaderRatio));
DomainProAnalyst.Instance.Report("Nr of LeaderAgents: "+ leaderC);

List&lt;StatusArtifact&gt; artifacts = new List&lt;StatusArtifact&gt;();
StatusArtifact sa = null; 

Queue&lt;int&gt; groupSizes = new Queue&lt;int&gt;();
groupSizes.Enqueue(sensorC); 
groupSizes.Enqueue(fieldC); 
groupSizes.Enqueue(officeC); 
groupSizes.Enqueue(leaderC); 

Queue&lt;List&lt;Topic&gt;&gt; topics = new Queue&lt;List&lt;Topic&gt;&gt;();
List&lt;Topic&gt; sensorTopics = new List&lt;Topic&gt;();
int tc = Math.Max(1,(int)(total*SensorRatio/20));
DomainProAnalyst.Instance.Report("Nr of SensorTopics: "+ tc);
for (int j=0; j&lt;tc; j++)
{
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "SensorGroup"+j;
	sensorTopics.Add(topic);
	topicG0.Topics.Add(topic);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
}
	topics.Enqueue(sensorTopics);
List&lt;Topic&gt; fieldTopics = new List&lt;Topic&gt;();
tc = Math.Max(1,(int)(total*FieldAgentRatio/10));
DomainProAnalyst.Instance.Report("Nr of FieldTopics: "+ tc);
for (int j=0; j&lt;tc; j++)
{
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "FieldAgentGroup"+j;
	fieldTopics.Add(topic);
	topicG1.Topics.Add(topic);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
}
	topics.Enqueue(fieldTopics);
List&lt;Topic&gt; officeTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "BackOfficeAgent";
	officeTopics.Add(topic);
	topicG2.Topics.Add(topic);
	topics.Enqueue(officeTopics);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
DomainProAnalyst.Instance.Report("Nr of OfficeTopics: "+ officeTopics.Count);

List&lt;Topic&gt; leaderTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "BackOfficeLeader";
	leaderTopics.Add(topic);
	topicG3.Topics.Add(topic);
	topics.Enqueue(leaderTopics);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
DomainProAnalyst.Instance.Report("Nr of LeaderTopics: "+ leaderTopics.Count);


DomainProAnalyst.Instance.Report("Nr of Topics: "+ TopicList.Count);
DomainProAnalyst.Instance.Report("Nr of Artifacts: "+ StatusArtifactList.Count);


List&lt;Topic&gt; group = topics.Dequeue();
int type = 0;
int count = 0;
int limit = groupSizes.Dequeue();
int rotate = 0;
for (int i=0; i&lt;total; i++)
{
	while (count &gt;= limit &amp;&amp; groupSizes.Count &gt; 0 &amp;&amp; topics.Count &gt; 0)
	{
		rotate = 0;
		type++;
		group = topics.Dequeue();
		limit += groupSizes.Dequeue();
	}		
	AgentTypeConfig.Add(type);
	AgentPubTopic.Add(group[rotate%group.Count]);
	rotate++;
	count++;		
}



</String>
            </Instruction>
          </Instructions>
        </Text>
        <Size>
          <Width>1227</Width>
          <Height>883</Height>
        </Size>
        <Location>
          <X>5</X>
          <Y>9</Y>
        </Location>
        <DisplayName>MonSys</DisplayName>
        <NameFont>
          <FontFamily>Segoe UI</FontFamily>
          <Size>9</Size>
          <Style>Regular</Style>
        </NameFont>
        <ShapeProperties>
          <DefaultSize>
            <Width>100</Width>
            <Height>60</Height>
          </DefaultSize>
          <BorderColor>
            <Argb>-16777216</Argb>
          </BorderColor>
          <FillColor>
            <Argb>-327681</Argb>
          </FillColor>
          <GradientFill>true</GradientFill>
          <GradientFillColor>
            <Argb>0</Argb>
          </GradientFillColor>
        </ShapeProperties>
        <SensorRatio>0.9001</SensorRatio>
        <SeedU>4689966</SeedU>
        <SeedV>9731157</SeedV>
      </anyType>
    </Types>
  </Structure>
  <Text xsi:type="DP_Text">
    <Id>6028306c-e7a5-4f1a-ae88-e0b5ed36cf54</Id>
    <Instructions>
      <Instruction>
        <Name>Initialize</Name>
        <String />
      </Instruction>
    </Instructions>
  </Text>
</CollabArchV5Model>