<?xml version="1.0" encoding="utf-8"?>
<CollabArchV5Model xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Name>NewCollabArchV5</Name>
  <Id>f26a0515-884a-47aa-a8df-4c49df31fbdd</Id>
  <Structure xsi:type="CollabArchV5Structure">
    <Id>a473f631-3b23-4e7f-8f99-17ccaf561f4e</Id>
    <Types>
      <anyType xsi:type="CollabPattern">
        <Name>MonSys</Name>
        <Id>e38e90df-aff2-486f-8d9a-4ef54eee19d4</Id>
        <Structure xsi:type="CollabPatternStructure">
          <Id>36947070-af02-4cdb-8f65-0c2d846381c7</Id>
          <Types>
            <anyType xsi:type="Collaborator">
              <Name>Agent</Name>
              <Id>1ce10eb9-e6d1-45b0-8d49-25a085d812e0</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>57f91788-8eda-4eb1-b6ea-0dfa9591c2a3</Id>
                <Types>
                  <anyType xsi:type="Metric">
                    <Name>LastEventAmount</Name>
                    <Id>753683cf-4977-4646-aaa9-1c4cdcf58099</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>6dcf29c6-3d00-41d6-b105-820c24136348</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7222f3ca-a7f9-4bad-9efa-d7cd3acf29b3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>136</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>1032</Y>
                    </Location>
                    <DisplayName>LastEventAmount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>NfyCount</Name>
                    <Id>e6011741-bfd9-48af-aff4-51ecc91926b8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>caedd1ba-cb24-409f-9c98-a53eb09f228a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>12f47f90-19b1-4a0c-931f-f93505e7278d</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>139</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>1002</Y>
                    </Location>
                    <DisplayName>NfyCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>PubCount</Name>
                    <Id>fa548d10-f0ac-4109-ae08-92ccba7887f0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>a72ec206-7bb3-4a59-a201-db6630a0cfa8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3f344517-c4fe-48c2-bd86-9ce0759d6d40</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>17</X>
                      <Y>49</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>ProcessingWork</Name>
                    <Id>b543d18c-736d-438f-b7b5-d2a6df22d4ce</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4c86bf70-a2cb-4f16-b9ed-b9bf0b39cc74</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ac2e9bb2-e3df-434d-8fbc-f95298c36346</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>10</X>
                      <Y>742</Y>
                    </Location>
                    <DisplayName>ProcessingWork</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>AgentType</Name>
                    <Id>5989f823-cbf8-482b-a8f3-d24971ce8ee5</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>547b035a-70c7-4931-8b85-c8cacb732598</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>38a10ec8-e7fc-4674-a3a2-5b5e1f7da6a5</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>69</X>
                      <Y>8</Y>
                    </Location>
                    <DisplayName>AgentType</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>WorkOverLoad</Name>
                    <Id>6cbfaab7-d17c-4f9b-bf30-7164558de1e0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>0b3aeeea-2a86-44e0-9840-65c092141264</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ce3ed447-bd45-4e53-a626-01b8c9cd729b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>720</Y>
                    </Location>
                    <DisplayName>WorkOverLoad</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>LastTaskDur</Name>
                    <Id>e75d2a3c-928d-454a-bf97-df042393b95c</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>c0fa43f2-2063-45f3-8d90-2a62875d3a0a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>71001939-df66-4c73-b2c4-9e4d19145082</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>129</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>1142</Y>
                    </Location>
                    <DisplayName>LastTaskDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMAvgWorkOverLoad</Name>
                    <Id>bb3aa70f-951d-4aca-baa7-1cdac625b2f7</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>38730af7-902e-4844-8bc9-064dc951ceb2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>8a88281d-dc5e-4ea0-a893-acaa99df45ec</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>531</X>
                      <Y>884</Y>
                    </Location>
                    <DisplayName>EWMAvgWorkOverLoad</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>IdleCapacity</Name>
                    <Id>0548bf3e-b25b-44e4-b04d-517a3d47bd27</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>62a4991a-9a35-4dfc-8ff3-c5fdb72af949</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0f708639-23e8-411b-8a97-52351d6052c4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>11</X>
                      <Y>694</Y>
                    </Location>
                    <DisplayName>IdleCapacity</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflictPerWrite</Name>
                    <Id>52e25b87-5752-4ff6-ac30-c85b405c9f88</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>2848285e-d78f-48d5-87ad-1eb6a765c300</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>87c62165-df44-44e6-8a5f-16a20982dca9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>130</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>324</Y>
                    </Location>
                    <DisplayName>UpdateConflictPerWrite</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Contributor</Name>
                    <Id>74330db1-511a-4338-a51b-1bf36e53635c</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>5a6fcabd-cbbb-49d4-84ea-cef5731281a8</Id>
                      <Types>
                        <anyType xsi:type="Update">
                          <Name>UpdateStatus</Name>
                          <Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Id>
                          <Structure xsi:type="UpdateStructure">
                            <Id>9c44e8b0-77c2-4c76-ae4a-a6e95004ce1e</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>03f8b223-b810-4238-b780-2119227c0b4c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>// determine where to get version Nr from
// determine update extend/scope
// determine update duration
StatusArtifact sa = Contributor.SharedStatusArtifact;

Simulation.MonSysContext.StatusArtifactContext.Update up = Contributor.WorkingOnUpdate;
if (up == null)
{
	// working on new update
	Contributor.WriteTries = 1;
	Contributor.Agent.UpdateCount++;
}
else
{
	Contributor.WriteTries++;
	// working on conflicting update
	Contributor.Agent.UpdateConflictSum++;		
}
up = sa.Create("Update") as Simulation.MonSysContext.StatusArtifactContext.Update;
Contributor.WorkingOnUpdate = up;
up.WorkingOnUpdate = Contributor;
up.Responsible = Contributor;
up.Scope = Contributor.Extend;
up.UpdateOnVersion = Contributor.ArtifactVersion;
Contributor.Dur = Model.Simulation.Simulator.Scheduler.Time-Contributor.StartTime;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>//double dur = 1+Contributor.Extend;
double dur =1;
Contributor.Effort += dur;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>97</Width>
                            <Height>48</Height>
                          </Size>
                          <Location>
                            <X>215</X>
                            <Y>105</Y>
                          </Location>
                          <DisplayName>UpdateStatus</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Read">
                          <Name>ReadFeedback</Name>
                          <Id>286ebe30-07b8-49d8-a221-29f6a6245668</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>7c55f92e-f8cb-45b4-b416-d6e7a9473bea</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>9f270e13-5598-408c-a91a-55475bff918d</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Contributor.WorkingOnUpdate != null &amp;&amp; Contributor.WorkingOnUpdate.isUpdateSuccess)
{
	Contributor.ArtifactVersion = Contributor.WorkingOnUpdate.StatusArtifact.Version;
	Contributor.Agent.UpdateConflictPerWrite = (Contributor.WriteTries-1);
	Contributor.Dur = Model.Simulation.Simulator.Scheduler.Time -Contributor.StartTime;

	Contributor.Agent.LastUpdateDur = Contributor.Dur;
	Contributor.Agent.TotalUpdateDur += Contributor.Dur;
	Contributor.Agent.LastUpdateEff = Contributor.Effort;
	Contributor.Agent.TotalUpdateEff += Contributor.Effort;


	if (Contributor.DoArtifactLocking)
	{
		Contributor.Agent.UpdateConflictPerWrite = (Contributor.LockTries-1);
	}
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>116</Width>
                            <Height>35</Height>
                          </Size>
                          <Location>
                            <X>143</X>
                            <Y>42</Y>
                          </Location>
                          <DisplayName>ReadFeedback</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>ArtifactVersion</Name>
                          <Id>607ef3a0-e812-4bc9-b9c4-073453cfc362</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>fb1f8811-0acb-465a-9bd0-119c4f8d7a11</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>9510283f-7186-45c0-8f32-586c5accd70f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>114</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>406</X>
                            <Y>96</Y>
                          </Location>
                          <DisplayName>ArtifactVersion</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>b0e52cdd-566e-4a43-bdc8-a941408d705b</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>4d122153-e9f8-4409-aa83-c2c1d0124d2b</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6060c0c2-169c-4208-8e7e-57c01a515b76</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (ReadFeedback.Contributor.WorkingOnUpdate != null &amp;&amp; !ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>ReadFeedback.Contributor.ArtifactVersion = ReadFeedback.Contributor.SharedStatusArtifact.Version;

if (ReadFeedback.Contributor.DoArtifactLocking)
{
	DomainProAnalyst.Instance.Report("Conflict even though artifact locking applied!");
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>70</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>189</X>
                            <Y>77</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>46</X>
                                <Y>35</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>44</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                          <Role2Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>WriteTries</Name>
                          <Id>99380253-529f-4520-ab66-ee651f5edb08</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c04ecf1d-efc2-4f27-9cbb-36829d5b96de</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2e5416ee-1ed3-48aa-820e-1a39f2c2d56f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>89</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>402</X>
                            <Y>74</Y>
                          </Location>
                          <DisplayName>WriteTries</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Read">
                          <Name>GetLock</Name>
                          <Id>3c01158a-f3b3-4bd3-82a8-f859957e4fad</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>d51b2524-b8af-4880-986f-4f9abfc897b2</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>32b7d7c0-5dd0-42cf-8eb2-f70f7790d635</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Contributor.SharedStatusArtifact.LockedBy == null)
{
	Contributor.SharedStatusArtifact.LockedBy = Contributor;
	Contributor.hasLock = true;
}
else
{
	Contributor.WriteTries++;
}
Contributor.Dur = Model.Simulation.Simulator.Scheduler.Time-Contributor.StartTime;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.0001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>97</Width>
                            <Height>38</Height>
                          </Size>
                          <Location>
                            <X>224</X>
                            <Y>182</Y>
                          </Location>
                          <DisplayName>GetLock</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-16711681</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>WaitLock</Name>
                          <Id>bfa2390c-59da-4f17-b6fb-5f6cf4ee65cf</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>e520c341-1bdb-4cf9-b74f-81e181520bf6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6a5a0778-5267-4bf9-8e2a-c055797c3350</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = Random.Uniform()*0.5;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>233</X>
                            <Y>270</Y>
                          </Location>
                          <DisplayName>WaitLock</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-16711681</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>01f42a88-729b-43ae-a255-86211597fe48</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>ef29bdae-d118-4450-a683-0eaa454d8a5d</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>40701b0b-340b-4ff3-9bd0-691b8d9a9bd9</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>16</Width>
                            <Height>50</Height>
                          </Size>
                          <Location>
                            <X>286</X>
                            <Y>220</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>69</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>62</X>
                                <Y>38</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>bfa2390c-59da-4f17-b6fb-5f6cf4ee65cf</Role1Id>
                          <Role2Id>3c01158a-f3b3-4bd3-82a8-f859957e4fad</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isError</Name>
                          <Id>16d97755-57f9-4b15-9ee0-660b999f9aa9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>f305e5e8-d16c-4615-accb-e92913597447</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>8fb299c1-457c-43cf-94c1-2baa231a3da6</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>411</X>
                            <Y>195</Y>
                          </Location>
                          <DisplayName>isError</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>false</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>8573cec4-6776-4dbf-8a40-07a13030b658</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>4616dc64-5d5a-40dd-8d23-f67b866636b6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ad3f1f34-31fc-4d87-b42c-152e1215e872</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return !GetLock.Contributor.hasLock ;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>8</Width>
                            <Height>50</Height>
                          </Size>
                          <Location>
                            <X>233</X>
                            <Y>220</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>17</X>
                                <Y>38</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>3c01158a-f3b3-4bd3-82a8-f859957e4fad</Role1Id>
                          <Role2Id>bfa2390c-59da-4f17-b6fb-5f6cf4ee65cf</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>80ab1905-3e85-4ec8-accf-3a574204694e</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>b67ad515-14c6-4edb-8d4b-5fcf12137fd8</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>8bfcb593-17a2-4dd7-9a1f-fb83153461fa</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return GetLock.Contributor.hasLock;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>GetLock.Contributor.ArtifactVersion = GetLock.Contributor.SharedStatusArtifact.Version;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>10</Width>
                            <Height>29</Height>
                          </Size>
                          <Location>
                            <X>284</X>
                            <Y>153</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>69</X>
                                <Y>48</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>3c01158a-f3b3-4bd3-82a8-f859957e4fad</Role1Id>
                          <Role2Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Update">
                          <Name>ReleaseLock</Name>
                          <Id>60da2afa-b295-442b-9b34-548ed9868076</Id>
                          <Structure xsi:type="UpdateStructure">
                            <Id>c7e7b367-1277-4087-a9a5-96b64a863cc3</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d5524f7d-0331-4d40-a1cc-488502f38079</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Contributor.SharedStatusArtifact != null &amp;&amp; 
	Contributor.SharedStatusArtifact.LockedBy == Contributor)
{
	Contributor.SharedStatusArtifact.LockedBy = null;
}
Contributor.hasLock = false;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.0001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>109</Y>
                          </Location>
                          <DisplayName>ReleaseLock</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-16711681</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence4</Name>
                          <Id>152a1a31-37d6-4388-9c8a-f7f6a0d29966</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>634fb607-c912-4b12-aba5-37dee24d4a57</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>85814138-1059-4a53-82a3-e33f42a2cb86</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>// we need to capture error cases (when update == null)  and then return anyway
return (ReadFeedback.Contributor.DoArtifactLocking &amp;&amp;(ReadFeedback.Contributor.WorkingOnUpdate == null || ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess));
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>ReadFeedback.Contributor.WorkingOnUpdate = null;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>105</Width>
                            <Height>32</Height>
                          </Size>
                          <Location>
                            <X>57</X>
                            <Y>77</Y>
                          </Location>
                          <DisplayName>NewCollabSequence4</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>19</X>
                                <Y>35</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>41</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                          <Role2Id>60da2afa-b295-442b-9b34-548ed9868076</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Extend</Name>
                          <Id>0bf3cebd-f58a-4d78-9d6d-beef7ec4e6cc</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7000304c-986f-4cf9-bad8-fc82f2523127</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b6958253-b92c-447c-ab9e-89fd535cfb63</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>56</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>409</X>
                            <Y>171</Y>
                          </Location>
                          <DisplayName>Extend</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>1</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>StartTime</Name>
                          <Id>88f2db28-959a-41f7-ba1f-0be67424f86f</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>a0852323-fbec-457d-8352-bd2b4677c65a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bd024fc8-06e9-4c6a-81e0-16a7e53e807e</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>23</Height>
                          </Size>
                          <Location>
                            <X>410</X>
                            <Y>309</Y>
                          </Location>
                          <DisplayName>StartTime</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Effort</Name>
                          <Id>81e5d8b1-78bb-4a6d-ba19-1e0d3b912eb5</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>fce7f9b5-2660-4b30-92a2-b42b66281674</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>c8ad42e0-b450-4d6b-b1c8-2df97b57db40</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>45</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>448</X>
                            <Y>121</Y>
                          </Location>
                          <DisplayName>Effort</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>hasLock</Name>
                          <Id>77f84470-871a-4637-8340-5b197234e77b</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c44e75f8-92a2-41e0-a8d3-11602855c723</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>60c9501e-4759-4d8e-9dfb-e85ae7163426</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>410</X>
                            <Y>221</Y>
                          </Location>
                          <DisplayName>hasLock</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>false</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Dur</Name>
                          <Id>6acc569f-1c43-4348-b6fd-f93965ba4647</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>18282b53-bfbd-480c-875f-731a27ef20b5</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>72cead52-2af0-42b1-93e4-4cb453d3367f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>35</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>408</X>
                            <Y>120</Y>
                          </Location>
                          <DisplayName>Dur</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>LockTries</Name>
                          <Id>ad602a83-1169-47f8-b361-b64f376df3d9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>1da809b9-aff3-487d-9349-52cf185f9be6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>e15f20f7-ec44-4c57-a067-bcd146307dfd</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>89</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>410</X>
                            <Y>147</Y>
                          </Location>
                          <DisplayName>LockTries</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>NextStep</Name>
                          <Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>2cfead0d-3056-4dda-8174-09eb6d24c05a</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>Choice</Name>
                                <Id>3a011ba9-c624-4255-8e17-83cb7ad0b001</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>36316adb-6502-486a-af01-59e699381949</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>1a3d6cee-5d32-492a-8fe7-046f0c08367b</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>100</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>168</X>
                                  <Y>12</Y>
                                </Location>
                                <DisplayName>Choice</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>int</ImplementationType>
                                <InitialValue>0</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>c7b5fd3c-f367-430e-9151-3f979903e055</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Contributor.SharedStatusArtifact == null)
{
	Choice= -1;
	if (Contributor.Agent.AgentType != 0)
		DomainProAnalyst.Instance.Report("Agent &lt;Contributor&gt; has no Artifact to work on");
	return;
}
else if (Contributor.Agent.AgentType == 0)
{
	Choice= -1;
	return;
}

Contributor.Dur = 0;
Contributor.Effort = 0;
Contributor.LockTries = 0;




if (Contributor.ExtentQueue.Count &gt; 0)  
{
	Choice = 2;
	Contributor.Extend = Contributor.ExtentQueue.Dequeue();
}
else
{
	Choice = 0;
}
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>if (Contributor.DoArtifactLocking)
{
	return 1; // but we return then to event proc anyway
}
else
	return 0.0001; // because we wait until write has finished before we return
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>162</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>19</X>
                            <Y>245</Y>
                          </Location>
                          <DisplayName>NextStep</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence7</Name>
                          <Id>1082964a-7358-4454-8300-3b2df482d419</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>e23ebc0b-c3ae-446c-a458-bfdf121e65ae</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>493e4475-8be8-49cc-b35b-98e082d71280</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 2 &amp;&amp; NextStep.Contributor.DoArtifactLocking);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>NextStep.Contributor.StartTime = Model.Simulation.Simulator.Scheduler.Time;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>43</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>181</X>
                            <Y>220</Y>
                          </Location>
                          <DisplayName>NewCollabSequence7</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>162</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>38</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role1Id>
                          <Role2Id>3c01158a-f3b3-4bd3-82a8-f859957e4fad</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence8</Name>
                          <Id>aaea1fa8-0544-477d-8fdc-23a22dc2da79</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>329462c3-8c72-4b80-b7c2-ce48914d8bfc</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>28b0aaae-0dc0-473f-b4f4-9401ba4e3775</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 2 &amp;&amp; !NextStep.Contributor.DoArtifactLocking);</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>NextStep.Contributor.ArtifactVersion = NextStep.Contributor.SharedStatusArtifact.Version;
NextStep.Contributor.StartTime = Model.Simulation.Simulator.Scheduler.Time;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>92</Width>
                            <Height>92</Height>
                          </Size>
                          <Location>
                            <X>123</X>
                            <Y>153</Y>
                          </Location>
                          <DisplayName>NewCollabSequence8</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>104</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>48</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role1Id>
                          <Role2Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>DoArtifactLocking</Name>
                          <Id>886cfb08-6c02-4b3a-9d9a-85dd7401458b</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>d66ba98b-771f-4add-8c1b-07b7f5b01266</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>32bc4a51-e2cf-4589-b74b-bb87a3f2a1f3</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>130</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>9</X>
                            <Y>22</Y>
                          </Location>
                          <DisplayName>DoArtifactLocking</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>false</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence9</Name>
                          <Id>8b058c52-6b39-46a0-b1f6-3c1cb1505d07</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>da40aa2e-f823-4948-bb63-0bf8e132d1fa</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>69e41b5a-3523-47ae-999a-d299a64318e4</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>10</Width>
                            <Height>96</Height>
                          </Size>
                          <Location>
                            <X>40</X>
                            <Y>149</Y>
                          </Location>
                          <DisplayName>NewCollabSequence9</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>34</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>21</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>60da2afa-b295-442b-9b34-548ed9868076</Role1Id>
                          <Role2Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role2Id>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>ExtentQueue</Name>
                          <Id>65c0ade7-f2d3-436b-992b-df08a5050669</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>c7ca73f0-6a5a-4ade-bd8e-c71c6fb7e914</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>894443cc-acda-4058-866a-b1e216832257</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>226</X>
                            <Y>353</Y>
                          </Location>
                          <DisplayName>ExtentQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;double&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;double&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>9f887baf-fa13-4e89-9edb-55b05e0e7035</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>42b47914-2017-4425-9122-dac1c39cb1b1</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>9f0ccfb5-9f95-448d-9416-4dcc69d6025d</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return Random.Uniform()*0.5;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>68</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>20</X>
                            <Y>343</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence5</Name>
                          <Id>3b58e021-0e2b-48be-a0e5-13f89749289f</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>32516002-ce7a-483e-926e-ae6bd8a47b62</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b2205d88-a57c-4d66-8d75-f3461e86dd0f</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>1</Width>
                            <Height>58</Height>
                          </Size>
                          <Location>
                            <X>39</X>
                            <Y>285</Y>
                          </Location>
                          <DisplayName>NewCollabSequence5</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>20</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>20</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role1Id>
                          <Role2Id>9f887baf-fa13-4e89-9edb-55b05e0e7035</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence6</Name>
                          <Id>f9e1532d-3baa-4422-b701-7447d2f7e10a</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>f8360e3e-47d8-4038-b2ab-4ee232775fa0</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d8011172-a80f-4ebe-bda9-d43e0e8f9b71</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>0</Width>
                            <Height>58</Height>
                          </Size>
                          <Location>
                            <X>88</X>
                            <Y>285</Y>
                          </Location>
                          <DisplayName>NewCollabSequence6</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>68</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>69</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>9f887baf-fa13-4e89-9edb-55b05e0e7035</Role1Id>
                          <Role2Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence10</Name>
                          <Id>8158b53d-abf0-4953-a000-b98de4728ebf</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>663d808e-0a40-41a3-ba64-6c88fdca28ba</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>01747137-df1a-4f54-8392-a8bb019db54f</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (!ReadFeedback.Contributor.DoArtifactLocking &amp;&amp;(ReadFeedback.Contributor.WorkingOnUpdate == null || ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess));
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>77</Width>
                            <Height>168</Height>
                          </Size>
                          <Location>
                            <X>102</X>
                            <Y>77</Y>
                          </Location>
                          <DisplayName>NewCollabSequence10</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>36</X>
                                <Y>35</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>83</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                          <Role2Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role2Id>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e4f0e624-5842-4a22-89d1-d5efd3a76234</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>SharedStatusArtifactLink = Agent.MonSys.Create("SharedStatusArtifact") as SharedStatusArtifact;
WorkingOnUpdateLink = Agent.MonSys.Create("WorkingOnUpdate") as WorkingOnUpdate;

if (IdleP &lt;= 0)
	DoArtifactLocking = true;
else
	DoArtifactLocking = false;

// more init code to set the link to an actual shared artifact
int pos = Agent.MonSys.AgentList.IndexOf(Agent);
if (pos != -1 &amp;&amp; pos &lt; Agent.MonSys.AgentPubTopic.Count)
{
	Topic topic = Agent.MonSys.AgentPubTopic[pos];	
	int posSA = Agent.MonSys.TopicList.IndexOf(topic);
	SharedStatusArtifact = Agent.MonSys.StatusArtifactList[posSA];
}
else
{
	SharedStatusArtifact = Agent.MonSys.StatusArtifactList[0];
}</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>351</Width>
                      <Height>401</Height>
                    </Size>
                    <Location>
                      <X>145</X>
                      <Y>259</Y>
                    </Location>
                    <DisplayName>Contributor</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <UpdateP>0.2</UpdateP>
                    <IdleP>1</IdleP>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>EventProcesser</Name>
                    <Id>18458eda-5164-44e2-ae5e-5523a59c3c36</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>093de041-e2ba-42a5-99b2-5524e6ad1456</Id>
                      <Types>
                        <anyType xsi:type="DataTransfer">
                          <Name>InEvents</Name>
                          <Id>92dde1e9-e8ba-42e2-b208-be461dc37d22</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f27c76a5-2d36-4d65-bcab-ba4dd698d366</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d1ecfa9d-b8e4-47ce-bf6c-f20651d57491</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>82</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>258</X>
                            <Y>244</Y>
                          </Location>
                          <DisplayName>InEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>FieldAgentWork</Name>
                          <Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7433ca20-edba-4fb6-b176-c745007441dd</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7c7ee748-f99d-4d04-966e-a5dd77c2155c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;
Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = agent.WorkExeDuration;
double load = eventCount/throughput;
double time = agent.WorkExeDuration;

if (load &gt; time)
{
	agent.WorkOverLoad = (load - time);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = (time-load);
}
agent.EWMAvgWorkOverLoad = agent.EWMAalpha*agent.WorkOverLoad + (1-agent.EWMAalpha)*agent.EWMAvgWorkOverLoad;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 10)
	{
		//DomainProAnalyst.Instance.Report("Field Agent Detects Situation: "+id);
		agent.PublisherList[0].ProcEvents.Enqueue(id);
		for (int i = 1; i &lt;= (agent.WorkOverLoad/2); i++)
		{
			agent.PublisherList[0].ProcEvents.Enqueue(id);
		}			
	}		    
}
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>//double dur = Math.Max(Math.Min(EventProcesser.InEvents.Count/EventProcesser.Agent.WorkExeDuration, EventProcesser.Agent.WorkExeDuration), 5);
//EventProcesser.Agent.ProcessingWork = dur;

double dur = EventProcesser.Agent.WorkExeDuration;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>125</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>22</X>
                            <Y>100</Y>
                          </Location>
                          <DisplayName>FieldAgentWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>BackofficeWork</Name>
                          <Id>5921eaa1-9838-40b8-b7d6-4db294573649</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>676fa05e-6087-48ad-875c-7d8680f39567</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5338dea0-c971-462e-80ce-9dd4f50d28bd</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = agent.WorkExeDuration*EventProcesser.IdleP;
double load = eventCount/throughput;
double time = agent.WorkExeDuration;

if (load &gt; time)
{
	agent.WorkOverLoad = (load - time);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = (time-load);
}

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 5)
	{
		DomainProAnalyst.Instance.Report("Backoffice Worker Detects Situation: "+id);	
		agent.PublisherList[0].ProcEvents.Enqueue(id);
	}		    
}
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>// Backoffice worker use only half the time for analysis due to crowd sourcing
double dur = EventProcesser.Agent.WorkExeDuration*EventProcesser.IdleP;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>121</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>97</X>
                            <Y>144</Y>
                          </Location>
                          <DisplayName>BackofficeWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Situations</Name>
                          <Id>3c1b43f0-5378-4817-b622-0b58f4ecde11</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>f1184758-4b2e-4db5-931c-a1e4ccf40cc9</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ba865fa1-b010-418f-9e58-1b2232cb1eed</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>67</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>14</X>
                            <Y>248</Y>
                          </Location>
                          <DisplayName>Situations</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;int,int&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;int,int&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>ef8d7d8d-b700-4728-8f97-8be0d49c7ff9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>09d5ec57-57b8-43dd-8029-08a9a6135f57</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>11540a98-31d9-4cc5-b0c2-01b11857f128</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>50</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>152</X>
                            <Y>22</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>TeamLeaderWork</Name>
                          <Id>5b741197-7f01-4675-98ea-dfbceef28478</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7a1817d4-0fab-48e7-9ff1-a4f77a4203b4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6e4219f5-76b8-43d5-9f31-d4c2dfd28611</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
Agent agent = EventProcesser.Agent;
agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = agent.WorkExeDuration;
double load = eventCount/throughput;
double time = agent.WorkExeDuration;

if (load &gt; time)
{
	agent.WorkOverLoad = (load - time);
	agent.IdleCapacity = 0;
}
else
{
	agent.WorkOverLoad = 0;
	agent.IdleCapacity = (time-load);
}
agent.EWMAvgWorkOverLoad = agent.EWMAalpha*agent.WorkOverLoad + (1-agent.EWMAalpha)*agent.EWMAvgWorkOverLoad;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

double timeNow = Model.Simulation.Simulator.Scheduler.Time;
foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 3)
	{
		DomainProAnalyst.Instance.Report("Team Leader Detects Situation: "+id);		
		if (id &lt; 100 &amp;&amp; agent.MonSys.HotSpotList[0].UndetectedDict.ContainsKey(id))
		{
			double start = agent.MonSys.HotSpotList[0].UndetectedDict[id];
			agent.MonSys.HotSpotList[0].UndetectedDict.Remove(id);
			double duration = timeNow - start;
			agent.MonSys.HotSpotList[0].DurDict.Add(id, duration);
			agent.MonSys.HotSpotList[0].DetectionDuration = duration;
		}
	}		    
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = EventProcesser.Agent.WorkExeDuration;

return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>140</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>180</X>
                            <Y>190</Y>
                          </Location>
                          <DisplayName>TeamLeaderWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>c019880a-8cff-4717-8664-854b0eabe1a2</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>6e0bbc43-7139-48e1-957f-5333aeab9212</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f8587197-19a8-41b1-a3aa-f8e1e41ba03d</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>EventProcesser.Situations.Clear();
EventProcesser.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return Random.Uniform();
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>59</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>88</X>
                            <Y>35</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>d0d60fd4-de02-485c-b5a5-23aa3a229578</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>2e3b2f03-60e7-4675-9e51-841912b6db30</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>76f1aa1b-37de-42fc-9c71-dcf549cb59e1</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>126</Width>
                            <Height>37</Height>
                          </Size>
                          <Location>
                            <X>147</X>
                            <Y>63</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>125</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>18</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>55bbf93f-9f59-473a-bc8b-d299d9fddab9</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>6e688c79-8593-4936-bf91-9fbd07a97a6f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>41907beb-8afc-426c-8158-3f75d1499834</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>78</Width>
                            <Height>81</Height>
                          </Size>
                          <Location>
                            <X>218</X>
                            <Y>63</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>121</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>41</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>c2914016-0eb7-4017-b1bf-3b25ee68e1dc</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>095e7986-30f6-4633-b92b-f2122cc1469b</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>221e00eb-23c1-4ba9-8cb6-2e5b903552d5</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>50</Width>
                            <Height>127</Height>
                          </Size>
                          <Location>
                            <X>263</X>
                            <Y>63</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>83</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>58</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>5b741197-7f01-4675-98ea-dfbceef28478</Role1Id>
                          <Role2Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>565d52f5-20ab-4225-80bd-41dba8237d06</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>26de32c3-64f9-44b4-9f20-703da44dd692</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>51d7adc9-4dbd-40c1-9a20-b732a93a0dd8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==3 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>90</Width>
                            <Height>115</Height>
                          </Size>
                          <Location>
                            <X>147</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>59</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>57</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>5b741197-7f01-4675-98ea-dfbceef28478</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence4</Name>
                          <Id>912fbd82-1ee5-4a10-be94-6af061d3aa31</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>2deccfd4-5ef5-4b6f-bba8-2f9ca876c926</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d5279c35-d949-4769-b2df-271947ef32c7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==2 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>35</Width>
                            <Height>69</Height>
                          </Size>
                          <Location>
                            <X>125</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>NewCollabSequence4</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>37</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>63</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence5</Name>
                          <Id>7b73355c-9109-4c87-914f-f887dfba8648</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>dca20881-d0ae-48ef-b9c3-edebd5557ae3</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f0f0ee5a-7e50-4859-a725-4426fbf09cf9</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.EventProcesser.Agent.AgentType==1 &amp;&amp; Idle.EventProcesser.isIdle);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Idle.EventProcesser.isIdle = false;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>16</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>92</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>NewCollabSequence5</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>20</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role1Id>
                          <Role2Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role2Id>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Fwd</Name>
                          <Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>34cf1e69-c407-4f99-b4c7-a03f25e7ac7e</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>914339d2-0db5-43b3-92d1-d901200c2bbd</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>EventProcesser.Agent.ContributorList[0].ExtentQueue.Enqueue(EventProcesser.Agent.WorkOverLoad/5);</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>255</X>
                            <Y>23</Y>
                          </Location>
                          <DisplayName>Fwd</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7d4ae50c-7048-485b-b6a4-cf6c1d57796e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>356</Width>
                      <Height>282</Height>
                    </Size>
                    <Location>
                      <X>142</X>
                      <Y>692</Y>
                    </Location>
                    <DisplayName>EventProcesser</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <IdleP>0.4</IdleP>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Subscriber</Name>
                    <Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>40e80ce2-df0e-4e82-b7a0-821f8b9a5c00</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>e0a77546-4723-4189-b3aa-76ca12d6ee44</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>notification</Name>
                                <Id>0602084a-a49f-40f3-a307-9555cc747bb2</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>653fd20c-e312-496c-adb1-d06ca6004b4a</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>129e736d-c400-4ba7-8670-7ce782dbb4a0</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>75</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>43</X>
                                  <Y>3</Y>
                                </Location>
                                <DisplayName>notification</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>NfyMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2c6a8abc-50bc-43c4-b0e7-118a99c15fd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>Subscriber.Agent.NfyCount++;
Subscriber.Agent.LastEventAmount = notification.MsgList.Count;

switch(Subscriber.SubType)
{
	case 0: //sensor, don't do anything
	break;
	case 1: // onsite staff	
		foreach (PubMsg msg in notification.MsgList)
		{
			Subscriber.Agent.EventProcesserList[0].InEvents.Enqueue(msg);	
		}
		break;
 	case 2: // backoffice staff
			foreach (PubMsg msg in notification.MsgList)
		{
			Subscriber.Agent.MasterList[0].InEvents.Enqueue(msg);	
		}
		break;
	case 3: // backoffice team leader
		foreach (PubMsg msg in notification.MsgList)
		{
			Subscriber.Agent.EventProcesserList[0].InEvents.Enqueue(msg);	
		}
		break;
	default: 	
	break;
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>48</Height>
                          </Size>
                          <Location>
                            <X>21</X>
                            <Y>20</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>SubType</Name>
                          <Id>3daae4f8-3552-44d5-bab9-004df92ae9ee</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>51e366c9-019f-4134-a3e8-5a9ab161d4ab</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1ecd3e60-e110-4616-b549-8918eb8c1ca9</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>60</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>80</Y>
                          </Location>
                          <DisplayName>SubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Subscriptions</Name>
                          <Id>b66d23c5-9b6b-4b06-93bb-0693591280b6</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>d921a7a8-36d3-49df-a08c-38c1d9eb83d4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>0d8cdcf0-1770-4a3e-a26f-73d6755dfdf3</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>92</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>89</X>
                            <Y>80</Y>
                          </Location>
                          <DisplayName>Subscriptions</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                          <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>07b006db-bc02-4ac8-906d-d60914b1cb54</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>Topic topic = null;
SubType = Agent.AgentType;
TopicGroup tg = null;
switch(SubType)
{
	case 0: //sensor, don't sub to anything
	break;
	case 1: // onsite staff	
		tg = Agent.MonSys.TopicGroupList[0];
// 		topic = Agent.MonSys.TopicList[0]; //from sensors
//		topic.Subscribers.Add(this);		
		break;
	case 2: // backoffice staff
		tg = Agent.MonSys.TopicGroupList[1];
//		topic = Agent.MonSys.TopicList[1]; //from field agents
//		topic.Subscribers.Add(this);
		break;
	case 3: // backoffice team leader
		tg = Agent.MonSys.TopicGroupList[2];
//		topic = Agent.MonSys.TopicList[2]; //from backoffice agents
//		topic.Subscribers.Add(this);
		break;
	default: 
		tg = Agent.MonSys.TopicGroupList[0];	
	break;
}
if (tg != null)
{
	topic = tg.Topics[(int)Random.Uint((uint)0,(uint)tg.Topics.Count)];
	topic.Subscribers.Add(this);
	topic.SubCount++;
}
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>238</Width>
                      <Height>115</Height>
                    </Size>
                    <Location>
                      <X>260</X>
                      <Y>1004</Y>
                    </Location>
                    <DisplayName>Subscriber</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Master</Name>
                    <Id>42b8e750-6192-4ca2-8d26-9fe3cc232c21</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>3f804300-694f-42d8-858f-b8ff64ad88e5</Id>
                      <Types>
                        <anyType xsi:type="Create">
                          <Name>CreateTask</Name>
                          <Id>543a7ee5-f966-4ba7-b9ed-4326f8f536ec</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>ef571297-5f4d-4b72-acd8-087579fd1222</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>newT</Name>
                                <Id>4e018695-4c31-45d7-b615-df6ab0657878</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>99cb6772-e483-4771-a209-644c74530bb2</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>abd7930d-1be7-48a4-acb3-d2c4ff006704</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>49</Width>
                                  <Height>24</Height>
                                </Size>
                                <Location>
                                  <X>6</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>newT</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>AnalysisTask</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d2878731-042e-4b03-985c-49f6152ac4a2</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>while(Master.InEvents.Count &gt; 0)
{	
newT = Master.Agent.MonSys.Create("AnalysisTask") as AnalysisTask;
newT.owner = Master;
newT.EventMsg = Master.InEvents.Dequeue();
newT.createdOn = Model.Simulation.Simulator.Scheduler.Time;
newT.reqSkills.Add("ImageJob");
newT.Created(false);
Master.TaskCount++;
}


Master.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>60</Height>
                          </Size>
                          <Location>
                            <X>53</X>
                            <Y>59</Y>
                          </Location>
                          <DisplayName>CreateTask</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Read">
                          <Name>ReadResult</Name>
                          <Id>438c608f-a77a-4fa2-b5f5-47cbd9998e55</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>173784f3-ac05-4d9b-bc4e-c965eeac7036</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>TaskResult</Name>
                                <Id>5136d1a3-ff2a-4404-8a39-6a36d9c6b539</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>6bac58bd-f03b-4e43-8b6d-90fc81541de5</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>76d2f842-d05a-494e-8609-f1e29a26b541</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>100</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>TaskResult</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>AnalysisResult</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bbb9a4be-a17e-43e1-b361-929c298a69f8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>Master.ResultCount++;
Master.Agent.LastTaskDur = TaskResult.createdOn - TaskResult.TaskRefConn.createdOn;

Master.Agent.EventProcesserList[0].InEvents.Enqueue(TaskResult.TaskRefConn.EventMsg);</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>60</Height>
                          </Size>
                          <Location>
                            <X>54</X>
                            <Y>124</Y>
                          </Location>
                          <DisplayName>ReadResult</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>TaskCount</Name>
                          <Id>060ec360-360a-48ea-ab6b-fa94c5b28477</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>cb00626a-6daa-4409-b774-32062d032a7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7919d56a-d10f-4d22-8c7c-7c4a22159474</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>82</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>9</X>
                            <Y>13</Y>
                          </Location>
                          <DisplayName>TaskCount</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>ResultCount</Name>
                          <Id>b25714a2-48eb-4277-9075-74697950d076</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>12520a3f-f928-4eb3-ad92-3c7e73a7f54a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5b732307-592a-4ca6-83f4-60005b2f5b5a</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>190</Y>
                          </Location>
                          <DisplayName>ResultCount</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InEvents</Name>
                          <Id>4ccfd99e-9a3a-4293-bbc2-8e42aedb01a7</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>92dd4b75-2f43-44f0-8a02-1f6e13e88d42</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>566a574e-1e91-42b7-9a54-08da0e9f379e</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>23</Height>
                          </Size>
                          <Location>
                            <X>100</X>
                            <Y>14</Y>
                          </Location>
                          <DisplayName>InEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>142ee16d-c644-4790-993d-af792ff1bff9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>a4c280e7-4966-46a0-92f3-a25ad6d05501</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>465f74c7-38de-4fe3-99ad-2b2fe4251822</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>38</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>243</X>
                            <Y>36</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>2bc7c7f3-3b78-4827-be41-41736bd470a8</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>237</Width>
                      <Height>222</Height>
                    </Size>
                    <Location>
                      <X>260</X>
                      <Y>1137</Y>
                    </Location>
                    <DisplayName>Master</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>0.2</CreateP>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateCount</Name>
                    <Id>a152e546-ae07-4597-ad34-8446dcd8ffc2</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>af347c8c-158b-4ac0-9dcb-e4ad0345438c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>c6ef0a87-d5ad-4cfa-bcf3-6f1fc2ba582e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>131</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>351</Y>
                    </Location>
                    <DisplayName>UpdateCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence6</Name>
                    <Id>3056cfbd-b63e-4dfc-83cb-91232048d4cc</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>86a31dfd-9bcc-4fe4-8ed2-2c94157197b5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>068db7a3-f494-4e13-adce-6a123f8e0da1</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return false;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Fwd.EventProcesser.Agent.ContributorList[0].ArtifactVersion = Fwd.EventProcesser.Agent.ContributorList[0].SharedStatusArtifact.Version;
	</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Fwd.EventProcesser.Agent.ContributorList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>97</Width>
                      <Height>189</Height>
                    </Size>
                    <Location>
                      <X>326</X>
                      <Y>526</Y>
                    </Location>
                    <DisplayName>NewCollabSequence6</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>26</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>162</X>
                          <Y>22</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>81b1fb70-07a5-4943-95c5-0dd97ae2f37e</Role1Id>
                    <Role2Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role2Id>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Publisher</Name>
                    <Id>54e1807c-75dd-4c97-b6cf-26c2a97ab65a</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>ec4f2fee-bdda-416a-9e50-fc8f61150b3d</Id>
                      <Types>
                        <anyType xsi:type="Create">
                          <Name>Publish</Name>
                          <Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>f9bc7607-7e12-4c6a-883b-7ea627158a43</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>newEvent</Name>
                                <Id>60e0c1d3-72a4-4a5b-b05e-c710a74cac2d</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>3dcd6f7c-aa7d-4749-899e-ede6b0b9cab6</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>9e19e3ab-ee0a-43cd-a840-42764206f8fc</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>82</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>newEvent</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>PubMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>4d2c8b1d-5c1f-4471-9f67-3e0470ffec63</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>// create PubSubMsg
newEvent = Publisher.Agent.MonSys.Create("PubMsg") as PubMsg;

// set situation id
if (Publisher.ProcEvents.Count &gt; 0)
{
	newEvent.SituationId = Publisher.ProcEvents.Dequeue();
}
else
{	// set random situation id
	if (Publisher.PubType == 0)	{
		newEvent.SituationId =  Publisher.Agent.MonSys.HotSpotList[0].CurrHotSpotId;
	}
	else {
		newEvent.SituationId = 100+(int)Math.Floor(Random.Uniform()*5);
	}
}
// set isAlert

// set topic
TopicRef tRef = Publisher.Agent.MonSys.Create("TopicRef") as TopicRef;
tRef.Topic = Publisher.regTopic;	
newEvent.TopicRefLink = tRef;

Publisher.Agent.PubCount++;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = 1;
if (Publisher.regTopic.IsPartOfHotspot)
	return dur/2;
else
	return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>52</Height>
                          </Size>
                          <Location>
                            <X>107</X>
                            <Y>23</Y>
                          </Location>
                          <DisplayName>Publish</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>regTopic</Name>
                          <Id>f6032ea6-bfa0-4946-afe7-e348fec3b328</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c3275e61-9cfa-4038-9c8b-e623517e6e9a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b9f9bb1c-20e8-4ea3-89ac-4cdb8d43bb0c</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>73</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>23</Y>
                          </Location>
                          <DisplayName>regTopic</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Topic</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>NextStep</Name>
                          <Id>624879d5-401b-43d9-8896-0c24d8417718</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>2b2f6b18-1c41-443f-8430-c878333147a2</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>Choice</Name>
                                <Id>f2da475a-373d-4dca-8050-03a701f09646</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>00ef6660-dc26-4283-b0da-88491f077557</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>7020cd27-86eb-47c6-801a-447ab702f3ba</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>64</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>-1</Y>
                                </Location>
                                <DisplayName>Choice</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>int</ImplementationType>
                                <InitialValue>0</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>37b18d3c-4da5-4134-b72a-7a95118bcded</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>double rand = Random.Uniform();
double createProb = Publisher.CreateP;
if (Publisher.regTopic.IsPartOfHotspot)
	createProb = createProb*2;

switch(Publisher.PubType)
{
	case 0: //sensor
	if (rand &lt;= createProb)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 1: // onsite staff
 	case 2: // backoffice staff
	if (Publisher.ProcEvents.Count &gt; 0)
		Choice = 1;
	else if (rand &lt;= createProb/2)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 3: // backoffice team leader
		// don't publish, just deal with a found situation but not here.
	default: 	
	break;
}

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>51</Height>
                          </Size>
                          <Location>
                            <X>30</X>
                            <Y>120</Y>
                          </Location>
                          <DisplayName>NextStep</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>5cad996b-c1a0-40f6-adb8-062dfdcf634a</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>8db90ec0-a343-4be9-ac80-09e94b683d7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bedb1aa2-4254-4fae-99f3-0d6909908303</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>57</Width>
                            <Height>5</Height>
                          </Size>
                          <Location>
                            <X>130</X>
                            <Y>120</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>100</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>ac18d355-2463-4077-ab8a-0ede5bb06229</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>7b5c37cf-7beb-4ea5-ae75-18d6a38e687f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>e5ab3d77-c87d-4d9e-8db8-676b31716ef8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 1);

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>25</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>100</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>18</X>
                                <Y>52</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>95965c14-ef63-47b4-a224-5f54c910d237</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>1345f704-c6c3-49a1-ac11-8401ae7978eb</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>06c987ae-f13e-43de-bc7c-00fd0b172e10</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>32</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>114</X>
                            <Y>75</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>39</X>
                                <Y>52</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>84</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>d95d7934-4690-450b-9692-6974e3f07257</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>65d931ba-a826-43d4-b771-82b14df30320</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>3d22a826-e372-49c4-b2ae-19b8b650ebd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>57</Width>
                            <Height>6</Height>
                          </Size>
                          <Location>
                            <X>130</X>
                            <Y>165</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>0</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>100</X>
                                <Y>51</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>PubType</Name>
                          <Id>98f17b4a-5df4-4ec9-bd3c-0ccbe83ed4e3</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7e630362-65ab-4072-b801-209d65e7cf85</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1f5a0efc-ca55-4b93-a6c7-d77378601301</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>62</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>14</X>
                            <Y>47</Y>
                          </Location>
                          <DisplayName>PubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>85fd41dc-a638-4450-94c8-32de58db5c79</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>4026f6f4-28d8-4138-bfd9-ba66f83637ce</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5c72a968-3c91-4be4-9379-24750a8a9257</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = 1;
if (Publisher.regTopic.IsPartOfHotspot)
	return dur/2;
else
	return dur;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>187</X>
                            <Y>125</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>ProcEvents</Name>
                          <Id>c88f2551-1e52-4ccc-a584-3fa045668084</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>7b8ce72d-38e6-46d9-a835-27101063de43</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ddbcda34-0e63-4ae0-9972-f6c1684e0206</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>78</Width>
                            <Height>23</Height>
                          </Size>
                          <Location>
                            <X>42</X>
                            <Y>175</Y>
                          </Location>
                          <DisplayName>ProcEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;int&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;int&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0d2ee00b-758c-4f9d-9651-abd117c018fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>PubType = Agent.AgentType;

int pos = Agent.MonSys.AgentList.IndexOf(Agent);
if (pos != -1 &amp;&amp; pos &lt; Agent.MonSys.AgentPubTopic.Count)
{
	regTopic = Agent.MonSys.AgentPubTopic[pos];	
}
else
{
	regTopic = Agent.MonSys.TopicList[0];
}
regTopic.Publishers.Add(this);
regTopic.PubCount++;

//switch(PubType)
//{
//	case 0: //sensor
//		regTopic = Agent.MonSys.TopicList[0];
//		regTopic.Publishers.Add(this);
//	break;
//	case 1: // onsite staff	
// 		regTopic = Agent.MonSys.TopicList[1];
//		regTopic.Publishers.Add(this);
//		break;
//	case 2: // backoffice staff
//		regTopic = Agent.MonSys.TopicList[2];
//		regTopic.Publishers.Add(this);
//		break;
//	case 3: // backoffice team leader
//		regTopic = Agent.MonSys.TopicList[3];
//		regTopic.Publishers.Add(this);
//		break;
//	default: 
//		
//	break;
//}
;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>254</Width>
                      <Height>213</Height>
                    </Size>
                    <Location>
                      <X>238</X>
                      <Y>38</Y>
                    </Location>
                    <DisplayName>Publisher</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>0.1</CreateP>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence</Name>
                    <Id>d30f365a-94d6-490e-a983-f624eb00f904</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>8a01a9e6-6e3a-418b-bfd5-f98f5a53d63a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>782de7b2-39c8-4c2b-bcae-a27d894a719a</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==1 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>192</Height>
                    </Size>
                    <Location>
                      <X>197</X>
                      <Y>832</Y>
                    </Location>
                    <DisplayName>NewCollabSequence</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>16</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>33</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence1</Name>
                    <Id>4e2f9c26-1531-448f-b5e3-38214f3fd97a</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>63f2eb33-ec9d-43bd-b7c1-13effbb2aef2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e33f926b-fd31-4475-bc08-5d8a9a940ab6</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==2 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>78</Width>
                      <Height>148</Height>
                    </Size>
                    <Location>
                      <X>239</X>
                      <Y>876</Y>
                    </Location>
                    <DisplayName>NewCollabSequence1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>36</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence2</Name>
                    <Id>afcca767-b6bc-4d6a-be35-521206ed040f</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>7b746db2-1c22-4317-b5db-5998c56d2cae</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>83be36d9-a51a-46a3-baab-30cc03e3a8b9</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==3 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>11</Width>
                      <Height>102</Height>
                    </Size>
                    <Location>
                      <X>322</X>
                      <Y>922</Y>
                    </Location>
                    <DisplayName>NewCollabSequence2</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>52</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5b741197-7f01-4675-98ea-dfbceef28478</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence3</Name>
                    <Id>10ef60f6-c55e-4e42-a2d1-96e33cf1c481</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>6d5e2b07-bac0-4378-9e1a-4e42008e7675</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>c89e400a-185f-46f4-a7fa-eae8053ff2bf</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==2 &amp;&amp; Receive.Subscriber.Agent.MasterList[0].isIdle);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.MasterList[0].isIdle = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.MasterList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>39</Width>
                      <Height>124</Height>
                    </Size>
                    <Location>
                      <X>339</X>
                      <Y>1072</Y>
                    </Location>
                    <DisplayName>NewCollabSequence3</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>58</X>
                          <Y>48</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>65</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>543a7ee5-f966-4ba7-b9ed-4326f8f536ec</Role2Id>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflictSum</Name>
                    <Id>3a13fbe2-80b8-4529-ab6b-1854f9ff191a</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>abc56d5d-f5ae-4b6a-b579-2757a7bc3280</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a60f1e7f-780c-4ba1-b329-7168f9ce2a57</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>131</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>296</Y>
                    </Location>
                    <DisplayName>UpdateConflictSum</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence4</Name>
                    <Id>c05d4fc3-8658-48ba-a476-fe872cefac36</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>c99cfe86-6312-4dfa-8fae-9915eef72610</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1831e026-d9fd-48c4-91f6-32abaa03e3f7</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (NextStep.Contributor.DoArtifactLocking &amp;&amp; NextStep.Contributor.ExtentQueue.Count &lt;= 0 &amp;&amp; NextStep.Choice == 2);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return NextStep.Contributor.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>40</Width>
                      <Height>183</Height>
                    </Size>
                    <Location>
                      <X>230</X>
                      <Y>544</Y>
                    </Location>
                    <DisplayName>NewCollabSequence4</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>106</X>
                          <Y>40</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>078f379a-0453-4ecd-ae65-d0a071fc6109</Role1Id>
                    <Role2Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role2Id>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence5</Name>
                    <Id>dc0bcd00-331f-4857-a776-024aadc05c75</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>ea45c280-584b-4d6c-b0f0-917ede69de36</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>6434b6df-34d8-479d-99d9-24e8d9d4f984</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (!ReadFeedback.Contributor.DoArtifactLocking &amp;&amp;(ReadFeedback.Contributor.WorkingOnUpdate == null || ReadFeedback.Contributor.WorkingOnUpdate.isUpdateSuccess));
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>ReadFeedback.Contributor.WorkingOnUpdate = null;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return ReadFeedback.Contributor.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>86</Width>
                      <Height>391</Height>
                    </Size>
                    <Location>
                      <X>249</X>
                      <Y>336</Y>
                    </Location>
                    <DisplayName>NewCollabSequence5</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>47</X>
                          <Y>35</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>19</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role1Id>
                    <Role2Id>c019880a-8cff-4717-8664-854b0eabe1a2</Role2Id>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>LastUpdateEff</Name>
                    <Id>abca661b-0046-4879-a54f-4bf68fefb49e</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>f264f53f-1bfc-42cf-99ac-7201dd5234c8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d5ebda33-6524-4864-9f87-7075207a6deb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>120</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>427</Y>
                    </Location>
                    <DisplayName>LastUpdateEff</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>1</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>LastUpdateDur</Name>
                    <Id>f251e10a-16bd-44da-a3c0-f5c48c6c02b7</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>159b0af2-698b-48ce-ad1e-9d8427495a6d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>5b24b503-59f9-4c6d-b83b-442c0d53759d</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>120</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>457</Y>
                    </Location>
                    <DisplayName>LastUpdateDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>1</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalUpdateEff</Name>
                    <Id>94fbd45d-5a81-4523-85ac-2058a1c2508f</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>a4323a5e-2b16-4b16-91b0-f7a751889347</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>8f0283ae-402a-4f27-95c2-117f37803f50</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>120</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>488</Y>
                    </Location>
                    <DisplayName>TotalUpdateEff</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalUpdateDur</Name>
                    <Id>b8436e54-78e6-4021-96c1-3d98d500c06d</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4e164f5a-b0be-4b7f-bb48-e0dac1380232</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>37d54387-5a7c-4f93-bafd-28979e2910f1</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>120</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>15</X>
                      <Y>516</Y>
                    </Location>
                    <DisplayName>TotalUpdateDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>9a126559-425c-4175-820f-3aa112a5fbc1</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>int pos = MonSys.AgentList.IndexOf(this);
if (pos != -1 &amp;&amp; pos &lt; MonSys.AgentTypeConfig.Count)
{
	AgentType = MonSys.AgentTypeConfig[pos];
}
else
{
	AgentType = 0;
}

</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>521</Width>
                <Height>1376</Height>
              </Size>
              <Location>
                <X>5</X>
                <Y>7</Y>
              </Location>
              <DisplayName>Agent</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>PubSubMW</Name>
              <Id>1a2db479-64c7-468b-83ab-2600ab15a6c5</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>ce033941-a04c-45e5-b4db-be0d8fa3bd1a</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>EventCoord</Name>
                    <Id>f9b2f383-d76c-44a5-bc40-e192ec129c09</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>933d7c9c-3659-4b9f-9ebc-bbe9b9763c0c</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>38db7cfb-2d8a-47e8-a2cb-a080340a9ee6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>40eb3b63-640d-4c01-8ec5-b3d8143fce83</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>//EventCoord.isIdle = false;
//if (!EventCoord.isIdleInternal)
//	return;
//EventCoord.isIdleInternal = false;
int eventCounter = 0;
while (EventCoord.InQueue.Count &gt; 0)
{
	eventCounter++;
	PubMsg msg = EventCoord.InQueue.Dequeue();
	Topic topic = msg.TopicRef;
	foreach (MonSysContext.AgentContext.Subscriber sub in topic.Subscribers)
	{
		NfyMsg exMsg;		
		if (EventCoord.EventDict.TryGetValue(sub, out exMsg))
		{
			exMsg.MsgList.Add(msg);
			//EventCoord.EventDict[sub] = exMsg;
		}
		else
		{
			exMsg = EventCoord.PubSubMW.MonSys.Create("NfyMsg") as NfyMsg;
			exMsg.MsgList.Add(msg);
			exMsg.Receiver = sub;
			EventCoord.EventDict.Add(sub,exMsg);
		}				
	}
}
EventCoord.PubSubMW.EventProcessed = eventCounter;
//EventCoord.isIdleInternal = true;	
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.ReadP;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>86</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>34</X>
                            <Y>68</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Create">
                          <Name>Forward</Name>
                          <Id>0b6cae23-f311-41f2-92b0-972249972a03</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>110b852e-9c3a-420f-9e40-d129a95a1d1d</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>52936466-348d-47a5-9658-e2910a22d17e</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>//DomainProAnalyst.Instance.Report("Delivering to # subscribers: "+EventCoord.EventDict.Count);

int msgCount = 0;

foreach (KeyValuePair&lt;MonSysContext.AgentContext.Subscriber,NfyMsg&gt; pair in EventCoord.EventDict)
{
	NfyMsg msg = pair.Value;
	//DomainProAnalyst.Instance.Report("Triggering Delivery");
	msgCount +=	msg.MsgList.Count;
	msg.Created(false);	    
}
EventCoord.EventDict.Clear();
EventCoord.PubSubMW.TotalMsgDelivered += msgCount;
EventCoord.PubSubMW.MsgLastDelivered = msgCount;
EventCoord.PubSubMW.EWMAvgMsgDelivered = EventCoord.PubSubMW.EWMAalpha * (double)msgCount + (1-EventCoord.PubSubMW.EWMAalpha)*EventCoord.PubSubMW.EWMAvgMsgDelivered ;

// calculate overall Agent Load here as this is one of the most regularly executed methods:
double fieldLoadSum = 0;
double fieldIdleSum = 0;
int fieldCountLoad = 0;
int fieldCountIdle = 0;
double officeLoadSum = 0;
double officeIdleSum = 0;
int officeCountLoad = 0;
int officeCountIdle = 0;
double leaderLoadSum = 0;
double leaderIdleSum = 0;
int leaderCountLoad = 0;
int leaderCountIdle = 0;
double fieldAlpha = 1;
double officeAlpha = 1;
double leaderAlpha = 1;

foreach (Agent agent in EventCoord.PubSubMW.MonSys.AgentList)
{
	switch (agent.AgentType)
	{
		case 0: break;
		case 1: 
			if (agent.WorkOverLoad &gt; 0)
			{	
				fieldLoadSum += agent.WorkOverLoad;
				fieldCountLoad++;
			}
			if (agent.IdleCapacity &gt; 0)
			{
				fieldIdleSum += agent.IdleCapacity;
				fieldCountIdle++;
			}
			fieldAlpha = agent.EWMAalpha;			
			break;
		case 2: 
			if (agent.WorkOverLoad &gt; 0)
			{	
				officeLoadSum += agent.WorkOverLoad;
				officeCountLoad++;
			}
			if (agent.IdleCapacity &gt; 0)
			{
				officeIdleSum += agent.IdleCapacity;
				officeCountIdle++;
			}
			officeAlpha = agent.EWMAalpha;
			break;
		case 3:
			if (agent.WorkOverLoad &gt; 0)
			{	
				leaderLoadSum += agent.WorkOverLoad;
				leaderCountLoad++;
			}
			if (agent.IdleCapacity &gt; 0)
			{
				leaderIdleSum += agent.IdleCapacity;
				leaderCountIdle++;
			}			leaderAlpha = agent.EWMAalpha;
			break;
		default : break;	
	}	
}
MonSys ms = EventCoord.PubSubMW.MonSys;
if (fieldCountIdle != 0)
	ms.EWMAFieldAgentIdle = (fieldAlpha*fieldIdleSum/fieldCountIdle) + (1-fieldAlpha)*ms.EWMAFieldAgentIdle;
if (officeCountIdle != 0)
	ms.EWMAOfficeAgentIdle = (officeAlpha*officeIdleSum/officeCountIdle) + (1-officeAlpha)*ms.EWMAOfficeAgentIdle;
if (leaderCountIdle != 0)
	ms.EWMALeaderAgentIdle = (leaderAlpha*leaderIdleSum/leaderCountIdle) + (1-leaderAlpha)*ms.EWMALeaderAgentIdle;

if (fieldCountLoad != 0)
	ms.EWMAFieldAgentLoad = (fieldAlpha*fieldLoadSum/fieldCountLoad) + (1-fieldAlpha)*ms.EWMAFieldAgentLoad;
if (officeCountLoad != 0)
	ms.EWMAOfficeAgentLoad = (officeAlpha*officeLoadSum/officeCountLoad) + (1-officeAlpha)*ms.EWMAOfficeAgentLoad;
if (leaderCountLoad != 0)
	ms.EWMALeaderAgentLoad = (leaderAlpha*leaderLoadSum/leaderCountLoad) + (1-leaderAlpha)*ms.EWMALeaderAgentLoad;

//EventCoord.isIdle = true;
;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.CreateP;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>31</X>
                            <Y>203</Y>
                          </Location>
                          <DisplayName>Forward</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InQueue</Name>
                          <Id>2efdf883-4f24-4c2c-98c8-dca2a5042ebc</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>2074aadf-65f5-4961-8260-a6f31e527608</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>08c812ef-34df-4239-b466-b5c0da23e2d0</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>6</X>
                            <Y>14</Y>
                          </Location>
                          <DisplayName>InQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>1ba10a0c-c75d-4885-96af-5cd15618a424</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>231b7009-b5e9-4468-9ead-2f228cd29ecf</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>68e74441-0a5f-4f2d-b5bc-d600a6461a2f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>7</X>
                            <Y>43</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>EventDict</Name>
                          <Id>dfa49fa3-ad95-4424-adec-8a4eae63a4f9</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f0e05682-58d6-4d03-895d-379ac89f955a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f5aaf590-1ff6-4a4c-9f78-39577829a4b5</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>65</Width>
                            <Height>24</Height>
                          </Size>
                          <Location>
                            <X>15</X>
                            <Y>140</Y>
                          </Location>
                          <DisplayName>EventDict</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;Simulation.MonSysContext.AgentContext.Subscriber,NfyMsg&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;Simulation.MonSysContext.AgentContext.Subscriber,NfyMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>cf0cf262-99c2-4c63-a13f-5138c0a4c406</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>9848c33c-6f6b-473c-9dc9-593f37458bc5</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>a1693d5b-04e6-4330-af1e-793819620896</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>//return (EventCoord.EventDict.Count &gt; 0);
return true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>7</Width>
                            <Height>92</Height>
                          </Size>
                          <Location>
                            <X>78</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>51</X>
                                <Y>43</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>47</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role1Id>
                          <Role2Id>0b6cae23-f311-41f2-92b0-972249972a03</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>d637fb9c-20b4-4b5e-9c70-b2c375070b39</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>d1b935f4-6170-419b-8843-727c7bfc78d2</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>869d5813-7135-43c8-b2fa-798b11834fb4</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>//return (EventCoord.InQueue.Count &gt; 0 &amp;&amp; EventCoord.isIdle == true);
return true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Forward.EventCoord.isIdle = false;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>4</Width>
                            <Height>92</Height>
                          </Size>
                          <Location>
                            <X>116</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>85</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>86</X>
                                <Y>43</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0b6cae23-f311-41f2-92b0-972249972a03</Role1Id>
                          <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdleInternal</Name>
                          <Id>0764f164-1033-45bf-aed3-74d0d3aee379</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>b07ed44c-a83c-45a7-861f-9b4c0288fc4f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>afb159ae-66b7-4d34-b05f-a48ed0567183</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>243</X>
                            <Y>232</Y>
                          </Location>
                          <DisplayName>isIdleInternal</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9234e8d0-0e5b-4ca2-b7f5-dbe0eb9862fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>175</Width>
                      <Height>262</Height>
                    </Size>
                    <Location>
                      <X>15</X>
                      <Y>24</Y>
                    </Location>
                    <DisplayName>EventCoord</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>1</CreateP>
                    <ReadP>1</ReadP>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMAvgMsgDelivered</Name>
                    <Id>9461c7d5-2e76-4d46-927e-593fdda95daf</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>471b08ce-6c88-4075-a413-5f045c707d20</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f572d32e-05b4-4a31-9636-0e8e456df9f8</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>169</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>193</X>
                      <Y>40</Y>
                    </Location>
                    <DisplayName>EWMAvgMsgDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>MsgLastDelivered</Name>
                    <Id>ff63e7c8-845a-4c48-9d5d-f94ffbc5caa8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>419263cd-097f-4739-9b32-de992fb29a7f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>75684520-b092-4df7-8bfc-33b2e38d13c7</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>136</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>194</X>
                      <Y>114</Y>
                    </Location>
                    <DisplayName>MsgLastDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EventProcessed</Name>
                    <Id>4647351e-4eec-414f-9436-99f57cbd55dc</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>6c621d54-7d5f-404c-8ea4-424440628f74</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>538a93d0-d487-4d6e-9168-abec2169b8da</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>135</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>194</X>
                      <Y>89</Y>
                    </Location>
                    <DisplayName>EventProcessed</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalMsgDelivered</Name>
                    <Id>e56a8fbb-c3d7-45a3-b4a6-54a7127955b6</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>e8caccd0-b088-4c47-96fd-b731cfb0e089</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7edd79f3-9dc0-47d0-a25a-944aebbf0edb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>137</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>193</X>
                      <Y>65</Y>
                    </Location>
                    <DisplayName>TotalMsgDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>bc116251-7a0b-4260-b56e-3e621f2e8b21</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>369</Width>
                <Height>300</Height>
              </Size>
              <Location>
                <X>1099</X>
                <Y>14</Y>
              </Location>
              <DisplayName>PubSubMW</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <WorkExeDuration>0.5</WorkExeDuration>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>FAgentUpdateEff</Name>
              <Id>37881e00-c65f-43c0-98a2-2eff4f480c34</Id>
              <Structure xsi:type="VariableStructure">
                <Id>66fd70ee-6c95-410a-bc14-2a6fc9f2d4e4</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>610addef-41e6-4e63-8206-ba4387c3f342</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>144</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1160</X>
                <Y>431</Y>
              </Location>
              <DisplayName>FAgentUpdateEff</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>FAgentUpdateDur</Name>
              <Id>6838a689-c26b-488b-bfb9-8188451ca017</Id>
              <Structure xsi:type="VariableStructure">
                <Id>d517c51a-5401-4f24-b80c-e6da9a498c7d</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8a35455a-52fc-4103-9808-946b361b221f</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>148</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1308</X>
                <Y>432</Y>
              </Location>
              <DisplayName>FAgentUpdateDur</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>SharedStatusArtifact</Name>
              <Id>33dbcfff-f138-4a96-9a23-7cbc4ee75911</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>b3cb99d5-b5b0-4b16-ae3b-9feae8c97959</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>43ecb26c-99d5-4bac-a94a-d70d4442d059</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>95</Width>
                <Height>7</Height>
              </Size>
              <Location>
                <X>501</X>
                <Y>383</Y>
              </Location>
              <DisplayName>SharedStatusArtifact</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>351</X>
                    <Y>117</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>74330db1-511a-4338-a51b-1bf36e53635c</Role1Id>
              <Role2Id>efe13d03-d29f-4bc0-bac9-e5162a14d3f1</Role2Id>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>PubMsg</Name>
              <Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>69c51788-1b1b-49a6-aa69-e46867a1a310</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>64342a55-5b69-4c47-b450-6b14e75f3e5f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1f366bd0-c1ac-4a02-acd9-80eb1b3527d5</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].InQueue.Enqueue(PubMsg);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>SituationId</Name>
                    <Id>ca5b6bea-ac44-4232-b3db-9ff5a2b5f37d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>ea7c2d76-3476-429d-843b-bc272dcf6ce9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3a550d22-c53a-4f12-9984-6b92650447c4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>58</Y>
                    </Location>
                    <DisplayName>SituationId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>dd991929-3d0e-41ee-88a4-b29df54d9102</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>97</Height>
              </Size>
              <Location>
                <X>548</X>
                <Y>38</Y>
              </Location>
              <DisplayName>PubMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>TopicRef</Name>
              <Id>70e29034-4f33-4125-ac51-d0a3389f8d0f</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>58001520-2970-4b06-af41-b7b8c1585b56</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8d2946b9-595e-4250-9b7a-ac5961dd9794</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>59</Width>
                <Height>11</Height>
              </Size>
              <Location>
                <X>673</X>
                <Y>112</Y>
              </Location>
              <DisplayName>TopicRef</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>125</X>
                    <Y>74</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>35</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow1</Name>
              <Id>46aa1f74-6947-4c95-b79c-405f302a290d</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>a5306596-497c-43fa-9af4-27533732e9ff</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>6d2dcf71-2e6e-4b63-9ab9-f5a3c62bf9d4</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Publish.newEvent;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>86</Width>
                <Height>1</Height>
              </Size>
              <Location>
                <X>470</X>
                <Y>84</Y>
              </Location>
              <DisplayName>NewTriggerFlow1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>120</X>
                    <Y>17</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
              <Role2Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow</Name>
              <Id>43c38c9a-0da0-4e67-8c9e-a4fd7f8afd4c</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>d6d84785-b77b-4fb9-a347-ce095c181387</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>590306b3-1fb3-4766-9ee9-848d4f773aca</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>//return (Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle);
return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>//Receive.EventCoord.isIdle = false;
//Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle = false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>482</Width>
                <Height>43</Height>
              </Size>
              <Location>
                <X>666</X>
                <Y>84</Y>
              </Location>
              <DisplayName>NewTriggerFlow</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>110</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>21</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role1Id>
              <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow2</Name>
              <Id>3a06e665-b71e-48ba-984f-e21d5af916e9</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>8a7c9849-fd49-4ebd-acc5-ce3d674a81c7</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad746893-5a1e-4a5d-a66d-b49c3aae875e</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Receive.notification = Created.NfyMsg;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.NfyMsg.Receiver;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>494</Width>
                <Height>217</Height>
              </Size>
              <Location>
                <X>406</X>
                <Y>845</Y>
              </Location>
              <DisplayName>NewTriggerFlow2</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>120</X>
                    <Y>31</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Role1Id>
              <Role2Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role2Id>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentTypeConfig</Name>
              <Id>ad689e1f-803b-4364-bf15-236c407d5527</Id>
              <Structure xsi:type="VariableStructure">
                <Id>2e22ff0b-d6a6-451c-a723-257bb44f78f2</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>a314fb25-b914-4bc8-a9eb-234ac6302378</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>137</Width>
                <Height>24</Height>
              </Size>
              <Location>
                <X>534</X>
                <Y>10</Y>
              </Location>
              <DisplayName>AgentTypeConfig</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;int&gt;</ImplementationType>
              <InitialValue>new List&lt;int&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>HotSpot</Name>
              <Id>40ee8080-94e9-41ab-b53c-9a3d8f1f6643</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>b74ea3ac-aeff-47d6-a1d4-23bc786b5050</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DurDict</Name>
                    <Id>7ce70a00-7b68-4d3f-96e9-da8ebf182dbd</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>e73f3339-8e4b-47d0-ba98-cd2bbfbff559</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d133a200-9f4f-46fb-a32b-6a4456c7d5e9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>149</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>212</Y>
                    </Location>
                    <DisplayName>DurDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>CurrHotSpotId</Name>
                    <Id>c4f8b7f4-daef-43c0-848a-9ab714ab3b6d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>5febc841-f95c-4ccd-a0a4-73142229564c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>883372b6-38e5-4412-8cb7-05fcc08cc836</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>116</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>15</X>
                      <Y>134</Y>
                    </Location>
                    <DisplayName>CurrHotSpotId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>UndetectedDict</Name>
                    <Id>7c6533b5-23c4-4b34-b47f-cfd800300180</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1ff9198a-2dd7-45c5-ae20-d51d608ac7b1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b1a9b9a0-05bb-4a17-8085-b04b74a1f19f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>154</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>159</Y>
                    </Location>
                    <DisplayName>UndetectedDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>SwitchHotSpot</Name>
                    <Id>ddf21a32-ba3e-476b-ae92-542866135ded</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>ec60ce19-1814-41b3-8f29-6f5b814485de</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>92027f12-aa94-4d02-b2de-99da8e662760</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>HotSpot.CurrHotSpotId = Math.Abs(HotSpot.CurrHotSpotId);
HotSpot.CurrHotSpotId++;
HotSpot.Undetected = HotSpot.UndetectedDict.Count;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;

// reset all sensors
foreach(Topic topic in HotSpot.MonSys.TopicGroupList[0].Topics)
{
	topic.IsPartOfHotspot = false;
}
int sourceCount = HotSpot.MonSys.TopicGroupList[0].Topics.Count;
int sel = Math.Min(Math.Abs(HotSpot.CurrHotSpotId) * (int)(sourceCount/10), sourceCount);

String hsUn = "";
foreach (int hsid in HotSpot.UndetectedDict.Keys)
{
	hsUn = hsUn+", "+hsid;
}
DomainProAnalyst.Instance.Report("Undetected Situations: "+hsUn+" @:"+timeNow);

foreach (int hsid in HotSpot.DurDict.Keys)
{
	DomainProAnalyst.Instance.Report("Detected Situations: "+hsid+" Dur:"+HotSpot.DurDict[hsid]);
}

if (HotSpot.WasBurstPhase)
{
	HotSpot.WasBurstPhase = false;
	sel = 0;
	HotSpot.CurrHotSpotId--;
	HotSpot.CurrHotSpotId *= -1;
}
else
{		
	HotSpot.WasBurstPhase = true;
}

HotSpot.UndetectedDict.Add(HotSpot.CurrHotSpotId,timeNow);






DomainProAnalyst.Instance.Report("Hotspot Switching Situation "+HotSpot.CurrHotSpotId+" with burst sources: "+sel +" @:"+timeNow);
// select sources
HotSpot.EventBurstSourceCount = sel;

while (sel &gt; 0 &amp;&amp; sourceCount &gt; 0) {
   if( HotSpot.RandomList[(HotSpot.RandomCounter++)%HotSpot.RandomList.Count] &lt; sel / sourceCount ) {
		// set to burst mode
HotSpot.MonSys.TopicGroupList[0].Topics[sourceCount-1].IsPartOfHotspot = true;
     		sel--;
	}
	sourceCount--;
}



</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>33</Height>
                    </Size>
                    <Location>
                      <X>17</X>
                      <Y>38</Y>
                    </Location>
                    <DisplayName>SwitchHotSpot</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>Timer</Name>
                    <Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>eca9ea11-5c79-4de0-81ab-7eda4f770a98</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a3c07e89-cd14-4409-b874-ba28b0c3e430</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return HotSpot.MonSys.AgentList[0].WorkExeDuration*6+10;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>66</Width>
                      <Height>40</Height>
                    </Size>
                    <Location>
                      <X>262</X>
                      <Y>57</Y>
                    </Location>
                    <DisplayName>Timer</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DetectionDuration</Name>
                    <Id>3bd32e2e-aa96-4e13-a9b9-8d62b6736d88</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>46298267-e155-4336-a3c7-ed3975acf93a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4c372b2e-f727-4231-b391-dc731617d92f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>142</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>19</X>
                      <Y>238</Y>
                    </Location>
                    <DisplayName>DetectionDuration</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Undetected</Name>
                    <Id>d9927d80-a3f7-4dfb-99b9-6f7b699b9665</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>9bcd9f0f-163b-4da9-b157-1515da1f185b</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a96e3b35-b665-4742-8f12-75f29b67a7a4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>157</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>186</Y>
                    </Location>
                    <DisplayName>Undetected</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>EventBurstSourceCount</Name>
                    <Id>7ac8e681-f162-4842-bd1d-53f6b86d8a71</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>c20a9a7a-7458-4514-921b-da436ad777db</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>14577ebb-d91a-4210-b35c-4cf5b32bdb6e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>174</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>17</X>
                      <Y>268</Y>
                    </Location>
                    <DisplayName>EventBurstSourceCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>RandomList</Name>
                    <Id>f41606d5-09fe-45b0-baa5-97dd89a6b9e7</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>9f788cd4-74ca-4134-a0d6-221182eb9fb2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a022d994-17ac-4ab4-95c7-9859b9bb72ac</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>129</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>231</X>
                      <Y>199</Y>
                    </Location>
                    <DisplayName>RandomList</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;double&gt;</ImplementationType>
                    <InitialValue>new List&lt;double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>RandomCounter</Name>
                    <Id>750fe07f-5533-4963-977b-3bf31c3fe0ea</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>c083cf1b-0ea8-4cdf-8d73-dfe13af98bbe</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a6a42565-e632-4a67-82be-f498666fbad7</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>126</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>231</X>
                      <Y>227</Y>
                    </Location>
                    <DisplayName>RandomCounter</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>InitPhase</Name>
                    <Id>66354728-7b22-482f-bda4-4fb9b362c617</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>47b2faa9-370d-48d1-b219-f75577768d0d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>45d1c3b6-1994-4a0c-bd90-fc420939ae8a</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 50;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>28</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>103</Y>
                    </Location>
                    <DisplayName>InitPhase</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>WasBurstPhase</Name>
                    <Id>9922344c-03d7-4939-8da8-66d52987042e</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>ca2fce4b-a5ba-4dac-a1b7-cfa01224bfa8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f1d1d65e-683c-4fed-ac66-db3e83ba97f7</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>121</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>235</X>
                      <Y>253</Y>
                    </Location>
                    <DisplayName>WasBurstPhase</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow2</Name>
                    <Id>95fa351b-c24b-4e07-9c48-e116f0b01e5c</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>0975ccc4-e45e-4175-ac25-f381c95ea047</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>085e5c4c-2696-43c9-bff6-f6d3016f987a</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>4</Width>
                      <Height>32</Height>
                    </Size>
                    <Location>
                      <X>86</X>
                      <Y>71</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow2</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>68</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>73</X>
                          <Y>33</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>66354728-7b22-482f-bda4-4fb9b362c617</Role1Id>
                    <Role2Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role2Id>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow4</Name>
                    <Id>4b9df3eb-e58e-4b4a-8859-db3d849edee7</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>6e129277-f9fb-458b-9a03-3671e6075fd9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3efce8cc-5c41-4fb3-a2a2-2be2d52bbcc3</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;

</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>135</Width>
                      <Height>19</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>38</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow4</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>0</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>110</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role1Id>
                    <Role2Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role2Id>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow</Name>
                    <Id>a13289a1-e1f5-48c5-8bd0-01d589f0f643</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>6546ad1c-f305-4de4-b458-d75548d514e9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>abdb5223-66c7-434a-aec9-1fd8f0a0a6dc</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>135</Width>
                      <Height>9</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>71</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>110</X>
                          <Y>33</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>23</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role1Id>
                    <Role2Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role2Id>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>PhaseStats</Name>
                    <Id>ba547c20-edc5-4716-bf3f-c2e0b569a7a3</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>ebd3d42e-eb87-477f-a476-bc3001cefaf3</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b4811143-b006-4750-87da-c1d812f5a359</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>MonSys ms = HotSpot.MonSys;

int agentCount = ms.AgentList.Count;
double boAgentEffSum = 0;
double boAgentDurSum = 0;
double boAgentUpdateSum = 0;
double fAgentEffSum = 0;
double fAgentDurSum = 0;
double fAgentUpdateSum = 0;

HashSet&lt;StatusArtifact&gt; boas = new HashSet&lt;StatusArtifact&gt;();
HashSet&lt;StatusArtifact&gt; fas = new HashSet&lt;StatusArtifact&gt;();

foreach (Agent agent in HotSpot.MonSys.AgentList)
{
	switch (agent.AgentType)
	{
		case 0: break;
		case 1: 
			if (agent.ContributorList[0].SharedStatusArtifact != null)
			{
				fas.Add(agent.ContributorList[0].SharedStatusArtifact);
				fAgentDurSum += agent.TotalUpdateDur;	
				fAgentEffSum += agent.TotalUpdateEff;		
				fAgentUpdateSum += agent.UpdateCount;
			}
			break;
		case 2: 
			if (agent.ContributorList[0].SharedStatusArtifact != null)
			{
				boas.Add(agent.ContributorList[0].SharedStatusArtifact);
				boAgentDurSum += agent.TotalUpdateDur;	
				boAgentEffSum += agent.TotalUpdateEff;		
				boAgentUpdateSum += agent.UpdateCount;
			}
			break;		
		default : break;	
	}	
}

double boaUpdateDiff = boAgentUpdateSum - HotSpot.BOAPhaseUpdates;
double faUpdateDiff = fAgentUpdateSum - HotSpot.FAPhaseUpdates;

double boaConflicts= 0;
foreach(StatusArtifact sa in boas)
{
	double confdiff = sa.NrConflicts - sa.LastPhaseConflicts;
	double updiff = sa.Version - sa.LastPhaseVersions;	
	boaConflicts += confdiff;
	if (updiff &gt; 0)
		sa.ConflictPerUpdatePhase = confdiff/updiff;
	else
		sa.ConflictPerUpdatePhase = 0;
	sa.LastPhaseConflicts = sa.NrConflicts;
	sa.LastPhaseVersions = sa.Version;

}

double faConflicts=0;
foreach(StatusArtifact sa in fas)
{
	double confdiff = sa.NrConflicts - sa.LastPhaseConflicts;
	double updiff = sa.Version - sa.LastPhaseVersions;	
	faConflicts += confdiff;
	if (updiff &gt; 0)
		sa.ConflictPerUpdatePhase = confdiff/updiff;
	else
		sa.ConflictPerUpdatePhase = 0;
	sa.LastPhaseConflicts = sa.NrConflicts;
	sa.LastPhaseVersions = sa.Version;
}

ms.FAgentUpdateEff = (fAgentEffSum-HotSpot.FAPhaseEff)/faUpdateDiff;
ms.FAgentUpdateDur = (fAgentDurSum-HotSpot.FAPhaseDur)/faUpdateDiff; 
ms.FAgentUpdates = (fAgentUpdateSum-HotSpot.FAPhaseUpdates)/(Model.Simulation.Simulator.Scheduler.Time-HotSpot.PhaseTime);

ms.BOAgentUpdateEff = (boAgentEffSum-HotSpot.BOAPhaseEff)/boaUpdateDiff;
ms.BOAgentUpdateDur = (boAgentDurSum-HotSpot.BOAPhaseDur)/boaUpdateDiff; 
ms.BOAgentUpdates = (boAgentUpdateSum-HotSpot.BOAPhaseUpdates)/(Model.Simulation.Simulator.Scheduler.Time-HotSpot.PhaseTime);



HotSpot.BOAPhaseEff = boAgentEffSum;
HotSpot.BOAPhaseDur = boAgentDurSum;
HotSpot.BOAPhaseUpdates = boAgentUpdateSum;
HotSpot.BOAPhaseConf = boaConflicts;

HotSpot.FAPhaseEff = fAgentEffSum;
HotSpot.FAPhaseDur = fAgentDurSum;
HotSpot.FAPhaseUpdates = fAgentUpdateSum;
HotSpot.FAPhaseConf = faConflicts;

HotSpot.PhaseTime = Model.Simulation.Simulator.Scheduler.Time;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>40</Height>
                    </Size>
                    <Location>
                      <X>241</X>
                      <Y>142</Y>
                    </Location>
                    <DisplayName>PhaseStats</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow1</Name>
                    <Id>1b0988f8-f7b7-4642-8234-17d858d7b1ce</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>5927c3e0-8515-45cf-b528-874dad89a08e</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>fce3c593-1e86-4a25-9315-c009c7efe892</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>134</Width>
                      <Height>71</Height>
                    </Size>
                    <Location>
                      <X>107</X>
                      <Y>71</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>90</X>
                          <Y>33</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>0</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role1Id>
                    <Role2Id>ba547c20-edc5-4716-bf3f-c2e0b569a7a3</Role2Id>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>FAPhaseUpdates</Name>
                    <Id>491ab21e-bb73-4d4a-92c8-30247c16a8cc</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>181a5230-e704-4a42-9741-e5b7a8575d92</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d96558b3-d86f-42b8-a67f-cd8342ea6781</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>39</X>
                      <Y>343</Y>
                    </Location>
                    <DisplayName>FAPhaseUpdates</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>BOAPhaseUpdates</Name>
                    <Id>60b028a6-1760-4f38-b949-ad51671e14b3</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>86d284a6-de3b-41ac-8339-f54c5418216c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>53e21431-7b32-4714-a567-b5f0ac08b945</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>185</X>
                      <Y>342</Y>
                    </Location>
                    <DisplayName>BOAPhaseUpdates</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>BOAPhaseEff</Name>
                    <Id>7828bbe4-1edc-4958-866c-712fe016e330</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>a81868a3-e7c4-4f59-8869-d543dd808a8f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>8b9c5e04-6371-4c31-b8a5-8dbf73e28600</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>188</X>
                      <Y>376</Y>
                    </Location>
                    <DisplayName>BOAPhaseEff</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>FAPhaseEff</Name>
                    <Id>597bcd16-5473-4aa5-904d-1660a95eb7fe</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>8a9cbe9f-58fb-4050-aaa5-3182c3a5dd93</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e81290d0-9588-4443-97be-a5760a197fab</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>39</X>
                      <Y>376</Y>
                    </Location>
                    <DisplayName>FAPhaseEff</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>FAPhaseDur</Name>
                    <Id>a7ba71bb-afd1-4fbc-96fc-430819e02b33</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>7717d92e-0100-4fa4-9377-beba91fcadeb</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>263a71cf-1846-419f-9039-b712150e60e1</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>40</X>
                      <Y>409</Y>
                    </Location>
                    <DisplayName>FAPhaseDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>BOAPhaseDur</Name>
                    <Id>ba9a2307-5d76-463a-9c8f-7d02d7245445</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>60014202-f22f-4d97-a94e-973b5990ca9f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>47c73aa9-d966-4bd4-b597-947dcd25660f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>188</X>
                      <Y>407</Y>
                    </Location>
                    <DisplayName>BOAPhaseDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>FAPhaseConf</Name>
                    <Id>b66b5e84-0134-48df-81f3-0ac87dd9f07b</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>f3af726d-2874-4da0-a6d8-73339f6b9afe</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>6e464757-04e5-4830-887e-20457f4c8c26</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>40</X>
                      <Y>438</Y>
                    </Location>
                    <DisplayName>FAPhaseConf</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>BOAPhaseConf</Name>
                    <Id>0e8bd1ec-122d-4f6e-a390-9d9178d12767</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>6afe8a75-0f35-425b-8e51-9f282c3069d7</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9584d4cf-17d8-491c-8d49-d3dd98041a17</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>189</X>
                      <Y>436</Y>
                    </Location>
                    <DisplayName>BOAPhaseConf</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>PhaseTime</Name>
                    <Id>7c164df5-a351-455c-9a1e-691f0021d0d7</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>c32bd541-a07c-4d68-aa12-b4bb266d47af</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>766dc4ed-3409-4be2-b601-d1d5f459149c</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>186</X>
                      <Y>307</Y>
                    </Location>
                    <DisplayName>PhaseTime</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad64fc9c-c998-4c93-9133-4408511431a6</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>CurrHotSpotId = 0;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;
UndetectedDict.Add(CurrHotSpotId,timeNow);

for (int i = 0; i &lt; 10000; i++)
{
	RandomList.Add(Random.Uniform());
}
</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>385</Width>
                <Height>487</Height>
              </Size>
              <Location>
                <X>1141</X>
                <Y>511</Y>
              </Location>
              <DisplayName>HotSpot</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentPubTopic</Name>
              <Id>3381378b-dffd-4636-b856-52ccb3faad9f</Id>
              <Structure xsi:type="VariableStructure">
                <Id>ef0262da-0166-410e-8d47-84399ec88169</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>97b541c8-84aa-46e3-94d1-3e3e228eebc9</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>126</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>678</X>
                <Y>12</Y>
              </Location>
              <DisplayName>AgentPubTopic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;Topic&gt;</ImplementationType>
              <InitialValue>new List&lt;Topic&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>NewFocusOnObjConn</Name>
              <Id>7a9d3bb6-83ce-4b3d-a130-82958df911b3</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>57b22209-157c-40c5-ab66-f5b7cf6020ac</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>47f41abd-5d11-47bc-9217-4fab7a31940a</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>144</Width>
                <Height>719</Height>
              </Size>
              <Location>
                <X>503</X>
                <Y>310</Y>
              </Location>
              <DisplayName>NewFocusOnObjConn</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>238</X>
                    <Y>18</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>91</X>
                    <Y>74</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Role1Id>
              <Role2Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role2Id>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>NewObjectRefConnection</Name>
              <Id>bf2eadb7-aadb-41bc-9230-5e6def8bfede</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>bc789f44-e799-4d73-b9a2-75ce0532f170</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d1520922-aebb-4cc5-8a70-448ff4e986be</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>81</Width>
                <Height>51</Height>
              </Size>
              <Location>
                <X>616</X>
                <Y>185</Y>
              </Location>
              <DisplayName>NewObjectRefConnection</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>60</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>62</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>TopicGroup</Name>
              <Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>9d7a4070-61d6-4738-bb9d-e29d83cc54df</Id>
                <Types>
                  <anyType xsi:type="ObjectData">
                    <Name>Topics</Name>
                    <Id>7b126fb8-d010-4a41-be94-7e5ed9c0eb77</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>0ccfad9e-389f-44ba-8c5d-8e90a161c4a1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>78b6921f-e76b-4d06-b619-c6ef9553f52b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>20</Y>
                    </Location>
                    <DisplayName>Topics</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                    <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>GroupNameId</Name>
                    <Id>ba91aed0-8bb6-435f-8806-2315fe458faa</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>8f72bc0a-1689-4c77-86f9-317e91f69a2c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>cff4f7dc-e5e4-4a2b-83f3-401b735e8d17</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>44</Y>
                    </Location>
                    <DisplayName>GroupNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>2560cecb-ef1b-43bf-86db-2aa0ac452134</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>74</Height>
              </Size>
              <Location>
                <X>556</X>
                <Y>236</Y>
              </Location>
              <DisplayName>TopicGroup</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>NfyMsg</Name>
              <Id>c6932e1e-1af9-489a-9383-c76e6cc11472</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>290176d1-8419-49c7-9d0c-e50919956f26</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>993e21c6-045b-413f-a783-257c6246a3c4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7186bc46-bd5a-4db6-b3b1-a75845776e4e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0.001;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>22</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>MsgList</Name>
                    <Id>4bd42898-0ce0-4add-9cde-02f80ee5014f</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>b1933403-c1ba-4c12-b36d-a057bfb0816d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>701e2872-74ab-49b3-9f2e-76314b4a7d49</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>102</Width>
                      <Height>26</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>56</Y>
                    </Location>
                    <DisplayName>MsgList</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;PubMsg&gt;</ImplementationType>
                    <InitialValue>new List&lt;PubMsg&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Receiver</Name>
                    <Id>ad14f68f-026a-4703-92f1-c440800fca1f</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>882bd524-3551-4021-8d12-c8b245dd6d15</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4d157456-f6d2-4b96-8b4c-7bcad8c9a1bc</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>84</Y>
                    </Location>
                    <DisplayName>Receiver</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Simulation.MonSysContext.AgentContext.Subscriber</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>63ce7384-9edb-4770-ba46-7287593be66d</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>115</Height>
              </Size>
              <Location>
                <X>893</X>
                <Y>794</Y>
              </Location>
              <DisplayName>NfyMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>Topic</Name>
              <Id>06842019-c2e7-4252-8b63-71dbef10c28f</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>02feb813-8af3-4f46-8bbf-bd29fdbd85ea</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Subscribers</Name>
                    <Id>ab4b60b6-7c76-4e9e-9991-f31c4b8d16df</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>f310a45d-c9cc-49b6-8690-70f5f4d137e4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>bde409ae-8a5a-412d-a162-db8040092220</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>125</Y>
                    </Location>
                    <DisplayName>Subscribers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.Subscriber&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.Subscriber&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Publishers</Name>
                    <Id>3e50ad75-d368-455d-a45f-bff71a8f38a1</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>a15436d8-2aa4-4b65-a440-27e195bd5439</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>beb42bce-fc1a-420e-9b11-e72943285848</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>72</Y>
                    </Location>
                    <DisplayName>Publishers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.Publisher&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.Publisher&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>TopicNameId</Name>
                    <Id>f91cd1d8-e217-46a2-81a1-5599f0e8ef60</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>def7b254-277a-418d-a6d0-9762e6b5a0f5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4405e15b-4978-4b8a-b12f-a8cc189209a3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>41</Y>
                    </Location>
                    <DisplayName>TopicNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>PubCount</Name>
                    <Id>7e2fe468-4a9a-4070-919c-60f473e3028e</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>36576409-c7ad-438f-aa6b-f4b045723abd</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a58ba50c-3ca5-4595-bf85-8fc63eba3a5e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>93</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>SubCount</Name>
                    <Id>c8a2274c-439c-4e37-8e95-3918a365aec5</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1133498e-ff29-4a21-a274-e526f5513e8d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>79bb39c9-babd-4b0e-aec1-294436e3c224</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>149</Y>
                    </Location>
                    <DisplayName>SubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>IsPartOfHotspot</Name>
                    <Id>1e3895cb-15ad-4c8a-b009-1e8297e1bfba</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>7ca67f97-643a-41da-bae7-162686c90e59</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7554866c-ccfb-44dd-b72c-b284431396d3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>IsPartOfHotspot</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d4572af9-69c5-4fc5-9398-9a5c868dea71</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>129</Width>
                <Height>181</Height>
              </Size>
              <Location>
                <X>697</X>
                <Y>123</Y>
              </Location>
              <DisplayName>Topic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAFieldAgentLoad</Name>
              <Id>20259082-57cb-428a-bd5d-7985da6a5dd4</Id>
              <Structure xsi:type="VariableStructure">
                <Id>959b7ae2-1faf-40a5-92d7-fbe8edee59b8</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>e3b15e6c-822f-4834-a4f5-1b2f95960846</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>164</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1156</X>
                <Y>351</Y>
              </Location>
              <DisplayName>EWMAFieldAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAOfficeAgentIdle</Name>
              <Id>25ace47c-2626-46e5-b502-a426145bd2d6</Id>
              <Structure xsi:type="VariableStructure">
                <Id>2f226a4f-c2ac-4c5e-b365-e3f884f85255</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c22af195-dc10-4e1b-bddd-b25ebf58ac2b</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>164</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1346</X>
                <Y>375</Y>
              </Location>
              <DisplayName>EWMAOfficeAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAOfficeAgentLoad</Name>
              <Id>29d6b1e1-532f-420c-a09d-d85078ff059a</Id>
              <Structure xsi:type="VariableStructure">
                <Id>16a406a0-d9db-4f1a-89b3-5e967e5df8a1</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>4c85074e-b5fd-4fea-89bf-27e81120a9c4</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>173</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1157</X>
                <Y>376</Y>
              </Location>
              <DisplayName>EWMAOfficeAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMAFieldAgentIdle</Name>
              <Id>309516c2-b524-4adc-8c3c-cbeb34da845b</Id>
              <Structure xsi:type="VariableStructure">
                <Id>a2f01d75-9c0d-4314-83fd-7d3901fe79e0</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8a946b39-c855-426e-8f51-fab8141ebb3a</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>162</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1344</X>
                <Y>349</Y>
              </Location>
              <DisplayName>EWMAFieldAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMALeaderAgentIdle</Name>
              <Id>ee2e6720-4738-4622-a1f1-0158e7f8a6ba</Id>
              <Structure xsi:type="VariableStructure">
                <Id>df35a5f0-5e40-4aba-b281-89f50a8d8a5e</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>1bc318cb-aac4-4dd8-ad92-10438ce14483</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>178</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1347</X>
                <Y>396</Y>
              </Location>
              <DisplayName>EWMALeaderAgentIdle</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>EWMALeaderAgentLoad</Name>
              <Id>78ce5f90-3d6a-4747-bf1c-23dda0dcb6b6</Id>
              <Structure xsi:type="VariableStructure">
                <Id>c8864bf7-4a3b-4f81-a3e7-e6800cfabcb2</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>492e6ac6-db01-46f0-b73f-8d20185eb802</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>179</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1154</X>
                <Y>398</Y>
              </Location>
              <DisplayName>EWMALeaderAgentLoad</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>AnalysisTask</Name>
              <Id>7fa907d1-b581-43b3-891a-5d56330c9a0f</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>4aea1115-5635-489f-bbcd-dd8e3de27ae9</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>affb09d3-ea79-4bb7-bd43-7772b24c5a97</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>3955c711-82ac-4d5c-a559-4b4407f23cad</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>6a2e796b-afc5-4441-a9a2-971705b05eb5</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>AnalysisResult ar = AnalysisTask.TaskRefConn;
ar.TaskRefConn = AnalysisTask;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>97</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>10</X>
                      <Y>28</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>createdOn</Name>
                    <Id>3a83bdb5-17ef-4b6b-a0b4-c66c23e0343a</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>22a68ace-bf80-4695-939f-196c22a7b0e8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7548b902-fb25-4652-8574-97998431885c</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>95</Y>
                    </Location>
                    <DisplayName>createdOn</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>openJobs</Name>
                    <Id>4d999d75-4178-4d64-bab3-391e7539e005</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>f5d19ab1-7d61-4f86-88f8-dfb1422e0cf0</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>6ea16cc3-ead6-4034-a9f6-560ace358809</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>176</Y>
                    </Location>
                    <DisplayName>openJobs</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>reqSkills</Name>
                    <Id>2ad67e1c-52fb-4a2c-80b0-0d2a6e09ee02</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>ccbd8028-037a-4a60-98e1-46dba047380a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>532f9a89-3424-4c6e-907f-4923696234a2</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>120</Y>
                    </Location>
                    <DisplayName>reqSkills</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;String&gt;</ImplementationType>
                    <InitialValue>new List&lt;String&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>owner</Name>
                    <Id>65422b96-f946-4249-9ef5-8bf4392e9c61</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>2a5cbdb8-4c7c-4582-8e31-85797d9b8e46</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>2eeafc49-a0b5-427b-888b-46edb9f40e4b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>147</Y>
                    </Location>
                    <DisplayName>owner</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Simulation.MonSysContext.AgentContext.Master</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>EventMsg</Name>
                    <Id>5aec1fb7-0013-418f-ac38-23ee46acab6e</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>db133e13-d445-4243-9215-b4fc3fc66fb1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>66cf8bb0-002e-4238-8687-067303bdb234</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>6</X>
                      <Y>65</Y>
                    </Location>
                    <DisplayName>EventMsg</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>PubMsg</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c478be4d-fd4e-48b5-be93-337223ee570b</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>AnalysisResult ar = MonSys.Create("AnalysisResult") as AnalysisResult;
TaskRefConnLink = MonSys.Create("TaskRefConn") as TaskRefConn;
TaskRefConn = ar;
</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>115</Width>
                <Height>210</Height>
              </Size>
              <Location>
                <X>619</X>
                <Y>995</Y>
              </Location>
              <DisplayName>AnalysisTask</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>AnalysisResult</Name>
              <Id>682b33f7-c2bc-4a43-98a6-03f789898c51</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>e00a105c-d74d-4a47-8b31-bd60e64a831f</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>a1eda63b-3ac4-467d-b2c5-254ea6042226</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>2ae7ad07-fa1f-435e-9578-8953dba50231</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4844fea2-dea2-44e0-b44c-b3bee3c1a638</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>AnalysisResult.createdOn = Model.Simulation.Simulator.Scheduler.Time;
AnalysisResult.duration = AnalysisResult.createdOn - AnalysisResult.TaskRefConn.createdOn;

double alpha = AnalysisResult.MonSys.AnalysisTeamList[0].EWMAalpha;
AnalysisResult.MonSys.AnalysisTeamList[0].LastTaskDur = AnalysisResult.duration;
AnalysisResult.MonSys.AnalysisTeamList[0].TotalTaskDur += AnalysisResult.duration;
AnalysisResult.MonSys.AnalysisTeamList[0].TaskCount++;
AnalysisResult.MonSys.AnalysisTeamList[0].EWMATaskDur = alpha*AnalysisResult.duration + (1-alpha)*AnalysisResult.MonSys.AnalysisTeamList[0].EWMATaskDur;
AnalysisResult.MonSys.AnalysisTeamList[0].AvgTaskDur = AnalysisResult.MonSys.AnalysisTeamList[0].TotalTaskDur/AnalysisResult.MonSys.AnalysisTeamList[0].TaskCount;

</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>26</Height>
                    </Size>
                    <Location>
                      <X>4</X>
                      <Y>19</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>createdOn</Name>
                    <Id>e3a771d4-ab4c-4db5-aa14-828bf0cbefc2</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>06e72962-a1c3-42f7-81d1-21438a5ea966</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>efedb4b1-8780-4653-9a13-16c72dc4e443</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>10</X>
                      <Y>50</Y>
                    </Location>
                    <DisplayName>createdOn</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>isTriggered</Name>
                    <Id>fa0b8ef0-bcfb-4102-9a88-ff8c80549a07</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>cbd20a7b-abee-422b-a86e-03200676daeb</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f7331755-3d1f-4969-a1f1-575520d518a2</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>96</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>76</Y>
                    </Location>
                    <DisplayName>isTriggered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>duration</Name>
                    <Id>627ea5e2-df44-459a-82ae-29bf3317688a</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>2e44632e-c74d-4c8c-9579-4868a0fde68f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9354673b-017b-48db-beb8-2807a316cd29</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>102</Y>
                    </Location>
                    <DisplayName>duration</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>7f7f3cf7-1db8-4c6c-a5de-ed14a8810e96</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>117</Width>
                <Height>137</Height>
              </Size>
              <Location>
                <X>617</X>
                <Y>1240</Y>
              </Location>
              <DisplayName>AnalysisResult</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>TaskRefConn</Name>
              <Id>d5fe9cab-f3dd-479a-8211-cb1697a12fab</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>910d07c3-1859-400d-bbc0-60cd2b7c8ec6</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>49f007e9-fd10-49fd-ba77-cfcbc7e4a261</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>0</Width>
                <Height>35</Height>
              </Size>
              <Location>
                <X>672</X>
                <Y>1205</Y>
              </Location>
              <DisplayName>TaskRefConn</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>55</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>53</X>
                    <Y>210</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>682b33f7-c2bc-4a43-98a6-03f789898c51</Role1Id>
              <Role2Id>7fa907d1-b581-43b3-891a-5d56330c9a0f</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow4</Name>
              <Id>bb59941b-259a-4fc8-926b-2a91073a17d9</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>141fbc9b-ed07-4467-b120-8808aff8ff30</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>1f729a51-b0dc-491f-8318-1d9aed265cc3</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return CreateTask.newT;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>191</Width>
                <Height>203</Height>
              </Size>
              <Location>
                <X>438</X>
                <Y>1023</Y>
              </Location>
              <DisplayName>NewTriggerFlow4</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>120</X>
                    <Y>23</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>543a7ee5-f966-4ba7-b9ed-4326f8f536ec</Role1Id>
              <Role2Id>affb09d3-ea79-4bb7-bd43-7772b24c5a97</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow21</Name>
              <Id>92aa4395-d810-4a2e-9392-89962fe7d7f4</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>d136c295-cb02-43b7-8b9e-4f5623aae796</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>4755a6fa-bd6b-4d55-b6aa-727f793f603c</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>ReadResult.TaskResult = Created.AnalysisResult;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.AnalysisResult.TaskRefConn.owner;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>182</Width>
                <Height>37</Height>
              </Size>
              <Location>
                <X>439</X>
                <Y>1259</Y>
              </Location>
              <DisplayName>NewTriggerFlow21</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>120</X>
                    <Y>28</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>a1eda63b-3ac4-467d-b2c5-254ea6042226</Role1Id>
              <Role2Id>438c608f-a77a-4fa2-b5f5-47cbd9998e55</Role2Id>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>Expert</Name>
              <Id>31aa3fbf-444c-40d6-b269-d46d5df80876</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>22acf6b9-8ae8-41d5-80bd-475e66644ed1</Id>
                <Types>
                  <anyType xsi:type="Component">
                    <Name>Worker</Name>
                    <Id>fc4f122f-80e7-4828-9168-54ffe2c1aa26</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>4d6754aa-0082-4c4b-8a5c-b1a9912f2e1b</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>ProcessJob</Name>
                          <Id>90ca12d8-6475-4929-a2cf-b6bf8e49c602</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>3917337c-2168-4974-b0b0-6144e456f693</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7c1f108e-2d47-4916-8536-b22fe07d6548</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>Worker.Task.openJobs--;
Worker.IsIdle=true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return Worker.Expert.WorkExeDuration;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>60</Height>
                          </Size>
                          <Location>
                            <X>25</X>
                            <Y>174</Y>
                          </Location>
                          <DisplayName>ProcessJob</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>IsIdle</Name>
                          <Id>3f1f3e47-69cd-47ba-a8f8-f3bb6e97425b</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>a4397e60-a738-4c11-a869-55f4d96701b5</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6c50a633-3fd8-4f1e-b250-9c9d53a97393</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>57</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>95</X>
                            <Y>33</Y>
                          </Location>
                          <DisplayName>IsIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="Update">
                          <Name>Idle</Name>
                          <Id>76ea26ab-a51e-433a-9050-5b041509c6b4</Id>
                          <Structure xsi:type="UpdateStructure">
                            <Id>41842481-a3c9-41c0-8efa-a005038b3f89</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>acbf0c47-9cee-4bc6-b587-4fd31b8f605b</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>Worker.Task = null;
MonSysContext.AnalysisTeamContext.TaskAssignment ta = Worker.Expert.MonSys.AnalysisTeamList[0].TaskAssignmentList[0];
if (ta.JobList.Count &gt; 0)
{
	if (ta.AnalysisTeam.JobStrategy == "FIFO")
	{	

		Worker.Task = ta.JobList[0];
		ta.JobList.RemoveAt(0);
		ta.AnalysisTeam.OpenJobCount--;
	}
	else
	{
		int last = ta.JobList.Count;
		Worker.Task = ta.JobList[last-1];
		ta.JobList.RemoveAt(last-1);
		ta.AnalysisTeam.OpenJobCount--;
	}
	if (Worker.Task == null)
	{
		ta.IdleWorkers.Enqueue(Worker);
	}
	else
		Worker.IsIdle = false;
}
else
{
	ta.IdleWorkers.Enqueue(Worker);
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>90</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>53</X>
                            <Y>70</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>99ba34fc-9468-4f98-a45a-7950452fffd8</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>0243f26c-1b04-4f33-8023-dd58ddaddfdc</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bc9669dd-b763-4ee9-896e-dcd7e9713124</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>21</Width>
                            <Height>64</Height>
                          </Size>
                          <Location>
                            <X>124</X>
                            <Y>110</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>120</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>71</X>
                                <Y>40</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>90ca12d8-6475-4929-a2cf-b6bf8e49c602</Role1Id>
                          <Role2Id>76ea26ab-a51e-433a-9050-5b041509c6b4</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>8e4d05e4-329b-4abb-8393-bf6833786b9c</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>756b9385-5b1c-4685-8c53-71216f1cb0f6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>e43e860e-6595-4824-a6ab-881f079c0bd0</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (Idle.Worker.Task != null);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>5</Width>
                            <Height>64</Height>
                          </Size>
                          <Location>
                            <X>72</X>
                            <Y>110</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>19</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>52</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>76ea26ab-a51e-433a-9050-5b041509c6b4</Role1Id>
                          <Role2Id>90ca12d8-6475-4929-a2cf-b6bf8e49c602</Role2Id>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>Task</Name>
                          <Id>acce5720-cb3e-4ca9-a0eb-4fe7f60932a1</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>4da20e58-8632-4dfe-a282-0c7071d73e24</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>91885750-792a-4e13-ac62-b7fd0ea971f5</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>41</Width>
                            <Height>24</Height>
                          </Size>
                          <Location>
                            <X>42</X>
                            <Y>30</Y>
                          </Location>
                          <DisplayName>Task</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>AnalysisTask</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>c0c265ec-0b33-4b31-bdde-2e3acaab2a99</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>176</Width>
                      <Height>290</Height>
                    </Size>
                    <Location>
                      <X>16</X>
                      <Y>27</Y>
                    </Location>
                    <DisplayName>Worker</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>7e5e2a89-e0a9-4cce-93f9-76a60450a8e8</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>218</Width>
                <Height>339</Height>
              </Size>
              <Location>
                <X>1240</X>
                <Y>1025</Y>
              </Location>
              <DisplayName>Expert</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <WorkExeDuration>3</WorkExeDuration>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow71</Name>
              <Id>79b4dcd0-e93d-416e-b6de-de1c9ba738ea</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>ae783dd5-c05d-4eaf-9ce9-245517f9eb5a</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>803e66ae-9bd9-440b-8ba9-67618b205ab8</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return (ProcessJob.Worker.Task.openJobs &lt;= 0);
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Created.AnalysisResult.isTriggered = true;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return ProcessJob.Worker.Task.TaskRefConn;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>550</Width>
                <Height>1</Height>
              </Size>
              <Location>
                <X>731</X>
                <Y>1285</Y>
              </Location>
              <DisplayName>NewTriggerFlow71</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>60</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>110</X>
                    <Y>26</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>90ca12d8-6475-4929-a2cf-b6bf8e49c602</Role1Id>
              <Role2Id>a1eda63b-3ac4-467d-b2c5-254ea6042226</Role2Id>
            </anyType>
            <anyType xsi:type="CollabSequence">
              <Name>NewCollabSequence1</Name>
              <Id>a9a262e4-7ee7-4e31-b184-e72f891952d6</Id>
              <Structure xsi:type="CollabSequenceStructure">
                <Id>feb1af65-ae2d-4ed9-84a6-5f24487ac39c</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>45c2f380-059b-40f9-982a-b5ef0e0909fd</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Context;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>221</Width>
                <Height>7</Height>
              </Size>
              <Location>
                <X>1088</X>
                <Y>1115</Y>
              </Location>
              <DisplayName>NewCollabSequence1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillColor>
                  <Argb>-16777216</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>120</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>620fcaa6-f1e8-4c1d-adc7-40c7104e4d8a</Role1Id>
              <Role2Id>76ea26ab-a51e-433a-9050-5b041509c6b4</Role2Id>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>AnalysisTeam</Name>
              <Id>3051203b-9b86-4480-801b-89c0332ae357</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>1d67f294-51f8-4d2d-84d7-5aa2408bf54a</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>TaskAssignment</Name>
                    <Id>5051802e-9d32-443c-8db1-84faa9f63e49</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>97a6130d-4829-427c-a1d6-5410e8818130</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>ReadTask</Name>
                          <Id>620fcaa6-f1e8-4c1d-adc7-40c7104e4d8a</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>8a4e560d-7d14-488e-b904-ece0bfad1254</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>Task</Name>
                                <Id>5b0cdadb-4eb8-4f89-93de-02c439fb6232</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>f5a6e31e-93e6-45e5-9cd5-a5ea7d7fe8f4</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>45065e2f-82bf-48ee-a3ea-c7a1151f5ac0</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>53</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>7</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>Task</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>AnalysisTask</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>639da761-e607-410d-bbfd-93be5d00810c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>if (Task.reqSkills.Contains("ImageJob"))
{
	if (TaskAssignment.IdleWorkers.Count &gt; 0)
	{
		MonSysContext.ExpertContext.Worker worker = TaskAssignment.IdleWorkers.Dequeue();
		worker.Task = Task;
		worker.ProcessJob(false);
	}
	else
	{
		TaskAssignment.JobList.Add(Task);
		TaskAssignment.AnalysisTeam.OpenJobCount++;
	}
	TaskAssignment.AnalysisTeam.IdleWorkerCount = TaskAssignment.IdleWorkers.Count;
}
// Queuing Strategy Check:
if(TaskAssignment.IdleP == 0)
{
	if (TaskAssignment.AnalysisTeam.EWMATaskDur &gt; (TaskAssignment.AnalysisTeam.MonSys.ExpertList[0].WorkExeDuration *2))
	{
		TaskAssignment.AnalysisTeam.JobStrategy = "LIFO";
		TaskAssignment.AnalysisTeam.JobStrategyChange = 1; 
	}
	if (TaskAssignment.JobList.Count &lt; TaskAssignment.AnalysisTeam.MonSys.ExpertList.Count )
	{
		TaskAssignment.AnalysisTeam.JobStrategy = "FIFO";
		TaskAssignment.AnalysisTeam.JobStrategyChange = 0;
	}
}

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>53</Height>
                          </Size>
                          <Location>
                            <X>69</X>
                            <Y>35</Y>
                          </Location>
                          <DisplayName>ReadTask</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>JobList</Name>
                          <Id>1b8200b5-a42f-4b0e-a35f-bcb141d6808c</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>be647e5d-891a-4c61-8f15-ee55a2fedc75</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>28aa614f-7332-43b4-a846-aee620e58ca7</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>24</Height>
                          </Size>
                          <Location>
                            <X>30</X>
                            <Y>104</Y>
                          </Location>
                          <DisplayName>JobList</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>List&lt;AnalysisTask&gt;</ImplementationType>
                          <InitialValue>new List&lt;AnalysisTask&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>IdleWorkers</Name>
                          <Id>1511be0a-faf5-4a3a-9d1f-b77f5e759686</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>4f0f9684-721f-4dff-89d7-221ac9415018</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>0aa629f3-2af4-435e-afdf-68e74a95db15</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>145</X>
                            <Y>101</Y>
                          </Location>
                          <DisplayName>IdleWorkers</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;MonSysContext.ExpertContext.Worker&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;MonSysContext.ExpertContext.Worker&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e88d5cba-31e0-4dc7-b417-7fffe801464f</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>if(IdleP &gt; 0)
	AnalysisTeam.JobStrategy = "FIFO";
else if(IdleP &lt; 0)
	AnalysisTeam.JobStrategy = "LIFO";
else
	AnalysisTeam.JobStrategy = "FIFO";
	</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>265</Width>
                      <Height>147</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>27</Y>
                    </Location>
                    <DisplayName>TaskAssignment</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>LastTaskDur</Name>
                    <Id>fbb6db8d-567e-4f42-a065-58b2901c0674</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>2738fc0c-21e6-4791-8313-0c91b6336547</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ab4e0e98-a454-4a38-8cc7-05d914e22690</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>171</X>
                      <Y>182</Y>
                    </Location>
                    <DisplayName>LastTaskDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalTaskDur</Name>
                    <Id>7c72f9fa-16a8-493c-81cc-66d1caf1bc4c</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>3c4f3fce-552f-48c9-8d52-aa96190bae17</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>fd6c4bd4-a577-48ff-a773-1efd3b6e1be6</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>21</X>
                      <Y>213</Y>
                    </Location>
                    <DisplayName>TotalTaskDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TaskCount</Name>
                    <Id>8686f014-ed6e-49ed-9c1c-466a97996d19</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>1e8e5ec0-3bce-411b-92e1-80bef6b38e07</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>289a9b60-2a1e-4a52-9f04-45cf51ce867a</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>23</X>
                      <Y>185</Y>
                    </Location>
                    <DisplayName>TaskCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>AvgTaskDur</Name>
                    <Id>8f088fc4-1323-4389-bb4b-b5fd26f95439</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>71509cc3-ea7c-4f1a-8238-a57597c20871</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e41132ce-986c-4ea1-a449-2162163d8b09</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>170</X>
                      <Y>210</Y>
                    </Location>
                    <DisplayName>AvgTaskDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>EWMATaskDur</Name>
                    <Id>b006b57c-ad58-4812-b302-af0ad82759d3</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>49be7f8e-8b49-4e8d-9f4a-69577cff0e5e</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>bcb677d7-7c1e-4ad9-a199-4bc144281a14</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>115</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>-125</X>
                      <Y>184</Y>
                    </Location>
                    <DisplayName>EWMATaskDur</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0.0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>JobStrategy</Name>
                    <Id>754de3cb-195e-4341-a4da-e9f17174f7af</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>ca5e1aba-06cc-4979-b86a-9a9d8a28b04a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>6c67c794-7561-4397-99cd-7f54db01e599</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>96</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>200</X>
                      <Y>354</Y>
                    </Location>
                    <DisplayName>JobStrategy</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>JobStrategyChange</Name>
                    <Id>4384fa9d-4d43-4d91-aa4e-65d7223a9816</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>921855e6-8a58-4ab8-9254-e7c59330e2d4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>324fae5a-10fe-4634-99e1-00b99e9cb8be</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>146</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>347</Y>
                    </Location>
                    <DisplayName>JobStrategyChange</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>OpenJobCount</Name>
                    <Id>7cd7bb7e-beab-48d6-a180-d8a1e02254a1</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>d92dd1e2-dc58-430e-92df-eaddf554ae41</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>2afb1ec0-7fb5-4f46-a893-040ef2637dbf</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>116</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>28</X>
                      <Y>299</Y>
                    </Location>
                    <DisplayName>OpenJobCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>IdleWorkerCount</Name>
                    <Id>88f660d0-6a40-45f5-8ea5-5353ee96c8e6</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>d56f9ca4-3fb7-4e69-be31-e2c97a2668f0</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a2c38dd4-8d3c-4828-8e86-16bcabed8373</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>125</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>157</X>
                      <Y>299</Y>
                    </Location>
                    <DisplayName>IdleWorkerCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>609a327b-ccd1-4614-b40a-f0088c9a4d43</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>JobStrategy = "FIFO";</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>323</Width>
                <Height>342</Height>
              </Size>
              <Location>
                <X>881</X>
                <Y>1024</Y>
              </Location>
              <DisplayName>ExpertPoolManager</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <EWMAalpha>0.1</EWMAalpha>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow3</Name>
              <Id>fe0d8abc-385e-41e1-8c0f-d30c2d316bb8</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>3fda3d07-3835-4fee-aa52-932edf263a85</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>afa92b16-1f7e-4e1b-8c2a-66eb07c8c6a8</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>ReadTask.Task = Created.AnalysisTask;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.AnalysisTask.MonSys.AnalysisTeamList[0].TaskAssignmentList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>242</Width>
                <Height>67</Height>
              </Size>
              <Location>
                <X>726</X>
                <Y>1052</Y>
              </Location>
              <DisplayName>NewTriggerFlow3</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>97</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>33</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>affb09d3-ea79-4bb7-bd43-7772b24c5a97</Role1Id>
              <Role2Id>620fcaa6-f1e8-4c1d-adc7-40c7104e4d8a</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow5</Name>
              <Id>27d88774-852b-44d3-b6dd-7de487114cf8</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>a22c132b-edca-48b0-9bd4-8c745e7b89a8</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>b55a848f-7274-4d7c-ab3b-3986ad467c48</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Context;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>135</Width>
                <Height>546</Height>
              </Size>
              <Location>
                <X>1010</X>
                <Y>270</Y>
              </Location>
              <DisplayName>NewTriggerFlow5</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>110</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>0b6cae23-f311-41f2-92b0-972249972a03</Role1Id>
              <Role2Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Role2Id>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>BOAgentUpdateEff</Name>
              <Id>2cc30a13-5458-48a4-a027-2ee9b8582eab</Id>
              <Structure xsi:type="VariableStructure">
                <Id>3d938add-295b-4e9d-8dff-c2432f0859c8</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>90a2da0c-4e25-4aa0-9a3d-00dae4dc0898</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>144</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1161</X>
                <Y>457</Y>
              </Location>
              <DisplayName>BOAgentUpdateEff</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>BOAgentUpdateDur</Name>
              <Id>37f2a990-cdb6-4777-8a52-339e1fbad78e</Id>
              <Structure xsi:type="VariableStructure">
                <Id>65df74b5-3fb9-4004-b03b-dc63499d465c</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d9e97f74-54b3-45c1-9282-db7c58a6fb39</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>148</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1309</X>
                <Y>456</Y>
              </Location>
              <DisplayName>BOAgentUpdateDur</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>BOAgentUpdates</Name>
              <Id>28cada44-bf35-422c-917b-3e92af285470</Id>
              <Structure xsi:type="VariableStructure">
                <Id>952bb3a5-8fde-4b29-bd60-874325850feb</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8330e835-85a8-48e3-84cb-bb662b3b558b</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>144</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>1467</X>
                <Y>455</Y>
              </Location>
              <DisplayName>BOAgentUpdates</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>FAgentUpdates</Name>
              <Id>37d8a5d0-07b2-448e-8c3a-29bec0a3a74e</Id>
              <Structure xsi:type="VariableStructure">
                <Id>f44094fe-3f24-4725-8c07-6753bd58d5cb</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c461f030-f0e2-4e39-b040-44d57af18ad1</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>148</Width>
                <Height>19</Height>
              </Size>
              <Location>
                <X>1463</X>
                <Y>433</Y>
              </Location>
              <DisplayName>FAgentUpdates</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>double</ImplementationType>
              <InitialValue>0</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>StatusArtifact</Name>
              <Id>efe13d03-d29f-4bc0-bac9-e5162a14d3f1</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>7d4e064d-dffc-4da5-9bab-a56918074710</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Version</Name>
                    <Id>b1b2e753-34d9-4a42-ab22-2f507032aa6d</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>c40e2eb4-ed29-434a-bd69-a65abfebca0b</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9dd7c1f5-be35-4398-919d-207e0f7568db</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>134</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>30</X>
                      <Y>57</Y>
                    </Location>
                    <DisplayName>Version</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>NrConflicts</Name>
                    <Id>3f9898bd-ec8c-4556-802e-a15257c5f7f8</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>28f58a4a-cd78-4e53-8fe3-fa11ba649800</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b7ffc832-d6e0-432c-a00c-02fb1b0c28e0</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>132</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>31</X>
                      <Y>84</Y>
                    </Location>
                    <DisplayName>NrConflicts</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>Updated</Name>
                    <Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>6860e4b7-b04e-4cd9-a8f2-94f1976d0547</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>86d7e906-ee46-4b6e-a12c-d8200519bd5f</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].InQueue.Enqueue(StatusArtifact);
if (StatusArtifact.Version != 0 &amp;&amp; StatusArtifact.NrConflicts != 0)
	StatusArtifact.ConflictPerUpdate = (double)StatusArtifact.NrConflicts/(double)StatusArtifact.Version;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>44</X>
                      <Y>22</Y>
                    </Location>
                    <DisplayName>Updated</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="TriggerDataSet">
                    <Name>Update</Name>
                    <Id>d0cb41ac-51a0-4fe3-b392-34b564bcabf7</Id>
                    <Structure xsi:type="TriggerDataSetStructure">
                      <Id>44638692-761c-4b0f-9517-ebf94e619b87</Id>
                      <Types>
                        <anyType xsi:type="Variable">
                          <Name>UpdateOnVersion</Name>
                          <Id>e44ab984-5ca9-4a77-95a8-cfdc2b54812a</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>84c713cd-d414-4c01-aa1a-97f1e92edaa9</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ddfb514f-b041-42df-a8b2-e7ee128908f1</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>134</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>4</X>
                            <Y>17</Y>
                          </Location>
                          <DisplayName>UpdateOnVersion</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Scope</Name>
                          <Id>64b1376e-9d9b-4236-bd8e-4292a739fc02</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>bf8cc459-69d2-446d-9074-ac9fda193fae</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>c5b85c3f-e96f-475b-a555-32d5eaff9932</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>134</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>40</Y>
                          </Location>
                          <DisplayName>Scope</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>double</ImplementationType>
                          <InitialValue>1.0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isUpdateSuccess</Name>
                          <Id>a61bced6-f737-4c5f-9943-165cef35ee53</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7eb1fe86-cd48-4b0b-8945-9480288d4e0f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>561028e1-0460-4f2d-95bd-d4baddc6e726</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>134</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>65</Y>
                          </Location>
                          <DisplayName>isUpdateSuccess</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>false</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Responsible</Name>
                          <Id>b7c73d55-34ec-492e-854b-5db0a7a2cbb4</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>50491327-104a-4542-a3ce-6108aed8b22c</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>27abf8a1-ba25-46b2-8e23-8051c3ac482f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>133</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>90</Y>
                          </Location>
                          <DisplayName>Responsible</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Simulation.MonSysContext.AgentContext.Contributor</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>852a2613-accc-41ab-9bb2-573ab2cf3d95</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>148</Width>
                      <Height>116</Height>
                    </Size>
                    <Location>
                      <X>25</X>
                      <Y>109</Y>
                    </Location>
                    <DisplayName>Update</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>LockedBy</Name>
                    <Id>6096e69c-f11e-41d8-b3e9-5c0e71fc7f50</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>25b8fd2d-091f-45ec-84d7-8e8e3f0ed9ff</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0f050604-12c9-4d4b-918b-3514612230e4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>137</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>29</X>
                      <Y>229</Y>
                    </Location>
                    <DisplayName>LockedBy</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Simulation.MonSysContext.AgentContext.Contributor</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>ConflictPerUpdate</Name>
                    <Id>fe84ed19-ba14-4fc3-a8db-52a951516f65</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>86b8540e-8dbe-4a66-8a99-c5e6205e62d0</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>69b9e13d-ac0f-4420-8767-0518f9bf0287</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>140</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>27</X>
                      <Y>257</Y>
                    </Location>
                    <DisplayName>ConflictPerUpdate</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <CornerRounding>3</CornerRounding>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>ConflictPerUpdatePhase</Name>
                    <Id>f9169d52-db76-4010-a032-04ae7eef9602</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>17cddde5-5da4-429a-81d5-e09204f2522a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0f5b1810-55b5-4324-9b7d-8984b50107fb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>176</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>9</X>
                      <Y>282</Y>
                    </Location>
                    <DisplayName>ConflictPerUpdatePhase</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <CornerRounding>3</CornerRounding>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>LastPhaseConflicts</Name>
                    <Id>3e9c9cd6-e732-4e15-86e3-481aa8fa54c3</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>27cc163c-682d-4af4-8cc4-e41954f83ae7</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f75760c8-6513-4fcf-9ef4-bc763812f66e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>143</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>26</X>
                      <Y>310</Y>
                    </Location>
                    <DisplayName>LastPhaseConflicts</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>LastPhaseVersions</Name>
                    <Id>83d40787-bc3d-4cce-a4fa-54297e27daf3</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>abf14564-03ec-4733-9536-252f9253dcd8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a9bef4e9-7c9f-4691-9585-6e763bd86ddf</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>141</Width>
                      <Height>27</Height>
                    </Size>
                    <Location>
                      <X>27</X>
                      <Y>340</Y>
                    </Location>
                    <DisplayName>LastPhaseVersions</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>9b6b0556-0579-4404-85ef-72646925635d</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>195</Width>
                <Height>379</Height>
              </Size>
              <Location>
                <X>596</X>
                <Y>390</Y>
              </Location>
              <DisplayName>StatusArtifact</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>AccessCoordinator</Name>
              <Id>aee52842-b2b0-4595-9b3c-2641f757ebae</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>724401eb-853a-44ad-8737-a5c9ed0c317b</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>ConflictDetection</Name>
                    <Id>3ca8ab80-d0ef-44be-b9fa-be86a61eba55</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>adc67ee8-4c41-4511-87a0-0d1e1a8dfef0</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>CheckUpdate</Name>
                          <Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>bc09bde5-cacd-4803-ab12-8e004c85be07</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b9c5bb54-a551-4532-a162-9c851a07d6ac</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>ConflictDetection.isIdle = false;
if (!ConflictDetection.isIdleInternal)
	return;
ConflictDetection.isIdleInternal = false;

while (ConflictDetection.InQueue.Count &gt; 0)
{	
	StatusArtifact sa = ConflictDetection.InQueue.Dequeue();	
			
	while ((sa.UpdateList == null || sa.UpdateList.Count == 0)&amp;&amp; ConflictDetection.InQueue.Count &gt; 0)
	{
		sa = ConflictDetection.InQueue.Dequeue();
	}
	Simulation.MonSysContext.StatusArtifactContext.Update up = sa.UpdateList[0];	
	// each change results in the SA to be placed in the ChangedCode queue, 
	// so we only observe the first UPDATE list item, and remove it after processing.
	if (up.UpdateOnVersion == sa.Version &amp;&amp; sa.Version == 0) 
	{			
		// new Code
		sa.Version++;
		up.isUpdateSuccess = true;
	}	
	else
	{	// evaluate update extend/scope	
		if (up.UpdateOnVersion != sa.Version &amp;&amp; Random.Uniform() &lt;= up.Scope) 
		{			
			
			sa.NrConflicts++;
			up.isUpdateSuccess = false;
			ConflictDetection.AccessCoordinator.UpdateConflict++;
		}
		else
		{
			up.isUpdateSuccess = true;
			sa.Version++;
			ConflictDetection.AccessCoordinator.UpdateSuccess++;
			// set the Link to the Update object that contains the right update, 
			// other updates afterwards are bound to fail
			// set the link in any case, as both success and failure cases need it
		}					
	}
	sa.UpdateList.RemoveAt(0);
	ConflictDetection.OutQueue.Enqueue(up);
}
ConflictDetection.isIdleInternal = true;	
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0.001;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>24</X>
                            <Y>187</Y>
                          </Location>
                          <DisplayName>CheckUpdate</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Create">
                          <Name>UpdateFeedback</Name>
                          <Id>31041579-84e3-469c-8ff8-91072f48222f</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>c165e49c-7d20-40d6-8b5c-020f9596183c</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>92546a68-d892-4419-bc9d-04f0c7286c45</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>while (ConflictDetection.OutQueue.Count &gt; 0)
{
	Simulation.MonSysContext.StatusArtifactContext.Update up = ConflictDetection.OutQueue.Dequeue();
	//up.WorkingOnUpdate.ReadFeedback(false); not working because LINK is null, not sure why, should not be.
	up.Responsible.ReadFeedback(false);
}
ConflictDetection.isIdle = true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>12</X>
                            <Y>47</Y>
                          </Location>
                          <DisplayName>UpdateFeedback</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InQueue</Name>
                          <Id>ab993a31-949d-4750-96d3-3aef1759d5a9</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>47995839-8fd7-45ae-a433-477b4c25d2bd</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d6ccda67-ff54-4d64-a0f1-fa99341c324f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>20</X>
                            <Y>238</Y>
                          </Location>
                          <DisplayName>InQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;StatusArtifact&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;StatusArtifact&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>519e3bb5-4b45-40b5-94d5-d99e6a8389e7</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>2fffadd0-faef-4bc7-b6b4-bab529e84b48</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>a98481f3-69bb-460d-b82d-607da703b8dd</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>184</X>
                            <Y>60</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>83be21fb-811c-4cc5-ab00-a0f74d9789c8</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>d766f7ce-5e5d-42f3-8b1a-7cddc81d733e</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d5fc1675-1bcf-4f50-b18e-6547535096d5</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (CheckUpdate.ConflictDetection.OutQueue.Count &gt; 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>4</Width>
                            <Height>95</Height>
                          </Size>
                          <Location>
                            <X>51</X>
                            <Y>92</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>31</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>39</X>
                                <Y>45</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role1Id>
                          <Role2Id>31041579-84e3-469c-8ff8-91072f48222f</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>6b53134e-2bb0-4694-9de0-c771acf63724</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>25d07f4b-8122-4e1c-aa36-a0b777d782b7</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>48868bf0-43ba-4794-8c33-2f09b4e6442e</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (ConflictDetection.InQueue.Count &gt; 0 &amp;&amp; ConflictDetection.isIdle == true);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>UpdateFeedback.ConflictDetection.isIdle = false;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>1</Width>
                            <Height>95</Height>
                          </Size>
                          <Location>
                            <X>100</X>
                            <Y>92</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>89</X>
                                <Y>45</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>76</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>31041579-84e3-469c-8ff8-91072f48222f</Role1Id>
                          <Role2Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdleInternal</Name>
                          <Id>d0e808bd-9d59-44ba-a77b-5bc46c12848f</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>35fb7aa4-2508-4df7-a955-c61853a6da7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7b8cec9b-cf9d-45f6-90a9-132b39a90ae4</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>181</X>
                            <Y>22</Y>
                          </Location>
                          <DisplayName>isIdleInternal</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>OutQueue</Name>
                          <Id>53d2ea5d-1e77-47d8-8bc1-ee926b25db1b</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>19732496-7140-40e4-b7d9-da62d04069c4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>17f64bce-e2c5-4a45-a918-970867782e78</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>84</Width>
                            <Height>21</Height>
                          </Size>
                          <Location>
                            <X>25</X>
                            <Y>23</Y>
                          </Location>
                          <DisplayName>OutQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;Simulation.MonSysContext.StatusArtifactContext.Update&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;Simulation.MonSysContext.StatusArtifactContext.Update&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b5d1e8fd-9cb7-402d-806e-4ade08cb6dee</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>169</Width>
                      <Height>282</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>31</Y>
                    </Location>
                    <DisplayName>ConflictDetection</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateSuccess</Name>
                    <Id>112d5e5a-8270-433b-821c-14ee0d0837ae</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4f379cdd-268e-43ba-a30f-b60d1f24dd44</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>500d5191-0bb0-4693-95fa-605ce4ae76fb</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>120</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>25</X>
                      <Y>354</Y>
                    </Location>
                    <DisplayName>UpdateSuccess</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <CornerRounding>3</CornerRounding>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>UpdateConflict</Name>
                    <Id>b329dfcb-d372-4c29-a9b6-e74140ed6de4</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>d4fcf0fc-812e-47c0-bb18-ce7a01dee140</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>debf1083-8c4f-4fd6-875e-9950c316dfb9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>118</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>26</X>
                      <Y>324</Y>
                    </Location>
                    <DisplayName>UpdateConflict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <CornerRounding>3</CornerRounding>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>52294e0c-2303-4e50-8367-ff3bb4d60312</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>206</Width>
                <Height>392</Height>
              </Size>
              <Location>
                <X>841</X>
                <Y>246</Y>
              </Location>
              <DisplayName>AccessCoordinator</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>10</Size>
                <Style>Bold</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>3</BorderWidth>
                <FillColor>
                  <Argb>-1</Argb>
                </FillColor>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <WorkExeDuration>2</WorkExeDuration>
              <EWMAalpha>0.2</EWMAalpha>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow8</Name>
              <Id>645b7985-e22b-4f22-8ca0-d4410b610804</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>e7ae3c6a-e5c8-46b0-94f7-d18057b2da71</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>c51d22a4-02b2-40ce-83c8-aef045258b65</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return (Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].isIdle);
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0].isIdle = false;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Updated.StatusArtifact.MonSys.AccessCoordinatorList[0].ConflictDetectionList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>133</Width>
                <Height>23</Height>
              </Size>
              <Location>
                <X>750</X>
                <Y>441</Y>
              </Location>
              <DisplayName>NewTriggerFlow8</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>110</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Role1Id>
              <Role2Id>b9a87a61-36fb-4c92-8155-6fe1e880f2ea</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerRefConn">
              <Name>WorkingOnUpdate</Name>
              <Id>93cf6486-efbf-4508-b459-e0f1e3fd1eee</Id>
              <Structure xsi:type="TriggerRefConnStructure">
                <Id>beb9bba6-2e8d-4011-88e3-63b245385a9e</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>68c5167a-bf2c-43da-b79b-bff7fbc2affe</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>120</Width>
                <Height>17</Height>
              </Size>
              <Location>
                <X>501</X>
                <Y>546</Y>
              </Location>
              <DisplayName>WorkingOnUpdate</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-16776961</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>351</X>
                    <Y>297</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>47</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>74330db1-511a-4338-a51b-1bf36e53635c</Role1Id>
              <Role2Id>d0cb41ac-51a0-4fe3-b392-34b564bcabf7</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow7</Name>
              <Id>495afea2-dc63-4d64-b08e-b94785f30ad5</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>fee9505b-0d5b-4dc4-8817-603151551558</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>23d13771-ca16-4e48-ac22-fe203c640e66</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return !UpdateStatus.Contributor.isError;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return UpdateStatus.Contributor.SharedStatusArtifact;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>178</Width>
                <Height>47</Height>
              </Size>
              <Location>
                <X>462</X>
                <Y>394</Y>
              </Location>
              <DisplayName>NewTriggerFlow7</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>97</X>
                    <Y>23</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>a92d88e7-4613-42cd-bbc8-4d57af54f1ea</Role1Id>
              <Role2Id>06fd37a5-5906-41f1-aa31-0cd03fc8cafd</Role2Id>
            </anyType>
            <anyType xsi:type="CollabSequence">
              <Name>NewCollabSequence</Name>
              <Id>4711f74e-51b3-4fac-b813-55d7179d177b</Id>
              <Structure xsi:type="CollabSequenceStructure">
                <Id>58e3875f-d471-4a17-9859-7d002bc029d7</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ff833c8d-37a1-4080-ae68-169b0cfd370a</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return false;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Context;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>462</Width>
                <Height>1</Height>
              </Size>
              <Location>
                <X>409</X>
                <Y>343</Y>
              </Location>
              <DisplayName>NewCollabSequence</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillColor>
                  <Argb>-16777216</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>20</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>116</X>
                    <Y>35</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>31041579-84e3-469c-8ff8-91072f48222f</Role1Id>
              <Role2Id>286ebe30-07b8-49d8-a221-29f6a6245668</Role2Id>
            </anyType>
          </Types>
        </Structure>
        <Text xsi:type="DP_Text">
          <Id>282ce0c6-bf04-477f-92c7-7dd8aaf16917</Id>
          <Instructions>
            <Instruction>
              <Name>Startup</Name>
              <String>if (SeedU &gt; 0 &amp;&amp; SeedV &gt; 0)
{
	Random.Seed(SeedU, SeedV);
}

TopicGroup topicG0 = Create("TopicGroup") as TopicGroup;
topicG0.GroupNameId = "Sensor";
TopicGroup topicG1 = Create("TopicGroup") as TopicGroup;
topicG1.GroupNameId = "FieldAgent";
TopicGroup topicG2 = Create("TopicGroup") as TopicGroup;
topicG2.GroupNameId = "BackOfficeAgent";
TopicGroup topicG3 = Create("TopicGroup") as TopicGroup;
topicG3.GroupNameId = "BackOfficeLeader";


Topic topic = null; //Create("Topic") as Topic;
//topic.TopicNameId = "Sensor";
//topic = Create("Topic") as Topic;
//topic.TopicNameId = "FieldAgent";

// List of Object DPStartInstance : Model.Simulation.StartInstances
// public List&lt;DP_StartInstance&gt; StartInstances
// Type == Agent, read count value
int total = 0;
foreach (DP_StartInstance si in Model.Simulation.StartInstances)
{
	if (si.Type == "MonSys")
	{
		foreach (DP_StartInstance i in si.Instances) {	
		if (i.Type == "Agent")
		{
			total = i.Count;
			break;
		}}
	}
}
// for now, generate only sensors, field agents, and backoffice agents
//int total = AgentList.Count;
if (total &lt;= 0)
	total = 1111;
//DomainProAnalyst.Instance.Report("Nr of Agents:"+total);
int sensorC = Math.Min((int)Math.Floor(total*SensorRatio),(int)Math.Floor((total-3)*SensorRatio));
DomainProAnalyst.Instance.Report("Nr of Sensors: "+ sensorC);

int fieldC = Math.Max(1,Math.Min((int)Math.Floor(total*FieldAgentRatio),(int)Math.Floor((total-2)*FieldAgentRatio)));
DomainProAnalyst.Instance.Report("Nr of FieldAgents: "+ fieldC);

int officeC = Math.Max(1,Math.Min((int)Math.Floor(total*BackOfficeRatio),(int)Math.Floor((total-1)*BackOfficeRatio)));
DomainProAnalyst.Instance.Report("Nr of OfficeAgents: "+ officeC);

int leaderC = Math.Max(1,(int)Math.Floor(total*TeamLeaderRatio));
DomainProAnalyst.Instance.Report("Nr of LeaderAgents: "+ leaderC);

List&lt;StatusArtifact&gt; artifacts = new List&lt;StatusArtifact&gt;();
StatusArtifact sa = null; 

Queue&lt;int&gt; groupSizes = new Queue&lt;int&gt;();
groupSizes.Enqueue(sensorC); 
groupSizes.Enqueue(fieldC); 
groupSizes.Enqueue(officeC); 
groupSizes.Enqueue(leaderC); 

Queue&lt;List&lt;Topic&gt;&gt; topics = new Queue&lt;List&lt;Topic&gt;&gt;();
List&lt;Topic&gt; sensorTopics = new List&lt;Topic&gt;();
int tc = Math.Max(1,(int)(total*SensorRatio/20));
DomainProAnalyst.Instance.Report("Nr of SensorTopics: "+ tc);
for (int j=0; j&lt;tc; j++)
{
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "SensorGroup"+j;
	sensorTopics.Add(topic);
	topicG0.Topics.Add(topic);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
}
	topics.Enqueue(sensorTopics);
List&lt;Topic&gt; fieldTopics = new List&lt;Topic&gt;();
tc = Math.Max(1,(int)(total*FieldAgentRatio/10));
DomainProAnalyst.Instance.Report("Nr of FieldTopics: "+ tc);
for (int j=0; j&lt;tc; j++)
{
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "FieldAgentGroup"+j;
	fieldTopics.Add(topic);
	topicG1.Topics.Add(topic);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
}
	topics.Enqueue(fieldTopics);
List&lt;Topic&gt; officeTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "BackOfficeAgent";
	officeTopics.Add(topic);
	topicG2.Topics.Add(topic);
	topics.Enqueue(officeTopics);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
DomainProAnalyst.Instance.Report("Nr of OfficeTopics: "+ officeTopics.Count);

List&lt;Topic&gt; leaderTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.PubCount = 0;
	topic.SubCount = 0;
	topic.TopicNameId = "BackOfficeLeader";
	leaderTopics.Add(topic);
	topicG3.Topics.Add(topic);
	topics.Enqueue(leaderTopics);
	sa = Create("StatusArtifact") as StatusArtifact;
	artifacts.Add(sa);
DomainProAnalyst.Instance.Report("Nr of LeaderTopics: "+ leaderTopics.Count);


DomainProAnalyst.Instance.Report("Nr of Topics: "+ TopicList.Count);
DomainProAnalyst.Instance.Report("Nr of Artifacts: "+ StatusArtifactList.Count);


List&lt;Topic&gt; group = topics.Dequeue();
int type = 0;
int count = 0;
int limit = groupSizes.Dequeue();
int rotate = 0;
for (int i=0; i&lt;total; i++)
{
	while (count &gt;= limit &amp;&amp; groupSizes.Count &gt; 0 &amp;&amp; topics.Count &gt; 0)
	{
		rotate = 0;
		type++;
		group = topics.Dequeue();
		limit += groupSizes.Dequeue();
	}		
	AgentTypeConfig.Add(type);
	AgentPubTopic.Add(group[rotate%group.Count]);
	rotate++;
	count++;		
}



</String>
            </Instruction>
          </Instructions>
        </Text>
        <Size>
          <Width>1227</Width>
          <Height>883</Height>
        </Size>
        <Location>
          <X>5</X>
          <Y>9</Y>
        </Location>
        <DisplayName>MonSys</DisplayName>
        <NameFont>
          <FontFamily>Segoe UI</FontFamily>
          <Size>9</Size>
          <Style>Regular</Style>
        </NameFont>
        <ShapeProperties>
          <DefaultSize>
            <Width>100</Width>
            <Height>60</Height>
          </DefaultSize>
          <BorderColor>
            <Argb>-16777216</Argb>
          </BorderColor>
          <FillColor>
            <Argb>-327681</Argb>
          </FillColor>
          <GradientFill>true</GradientFill>
          <GradientFillColor>
            <Argb>0</Argb>
          </GradientFillColor>
        </ShapeProperties>
        <SensorRatio>0.9001</SensorRatio>
        <SeedU>4565666</SeedU>
        <SeedV>35478989</SeedV>
      </anyType>
    </Types>
  </Structure>
  <Text xsi:type="DP_Text">
    <Id>6028306c-e7a5-4f1a-ae88-e0b5ed36cf54</Id>
    <Instructions>
      <Instruction>
        <Name>Initialize</Name>
        <String />
      </Instruction>
    </Instructions>
  </Text>
</CollabArchV5Model>