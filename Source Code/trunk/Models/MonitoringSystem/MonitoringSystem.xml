<?xml version="1.0" encoding="utf-8"?>
<CollabArchV5Model xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Name>NewCollabArchV5</Name>
  <Id>f26a0515-884a-47aa-a8df-4c49df31fbdd</Id>
  <Structure xsi:type="CollabArchV5Structure">
    <Id>a473f631-3b23-4e7f-8f99-17ccaf561f4e</Id>
    <Types>
      <anyType xsi:type="CollabPattern">
        <Name>MonSys</Name>
        <Id>e38e90df-aff2-486f-8d9a-4ef54eee19d4</Id>
        <Structure xsi:type="CollabPatternStructure">
          <Id>36947070-af02-4cdb-8f65-0c2d846381c7</Id>
          <Types>
            <anyType xsi:type="Collaborator">
              <Name>Agent</Name>
              <Id>1ce10eb9-e6d1-45b0-8d49-25a085d812e0</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>57f91788-8eda-4eb1-b6ea-0dfa9591c2a3</Id>
                <Types>
                  <anyType xsi:type="Component">
                    <Name>Publisher</Name>
                    <Id>54e1807c-75dd-4c97-b6cf-26c2a97ab65a</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>ec4f2fee-bdda-416a-9e50-fc8f61150b3d</Id>
                      <Types>
                        <anyType xsi:type="Create">
                          <Name>Publish</Name>
                          <Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>f9bc7607-7e12-4c6a-883b-7ea627158a43</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>newEvent</Name>
                                <Id>60e0c1d3-72a4-4a5b-b05e-c710a74cac2d</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>3dcd6f7c-aa7d-4749-899e-ede6b0b9cab6</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>9e19e3ab-ee0a-43cd-a840-42764206f8fc</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>65</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>2</Y>
                                </Location>
                                <DisplayName>newEvent</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>PubMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>4d2c8b1d-5c1f-4471-9f67-3e0470ffec63</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>// create PubSubMsg
newEvent = Publisher.Agent.MonSys.Create("PubMsg") as PubMsg;

// set situation id
if (Publisher.ProcEvents.Count &gt; 0)
{
	newEvent.SituationId = Publisher.ProcEvents.Dequeue();
}
else
{	// set random situation id
	if (Publisher.PubType == 0)	{
		newEvent.SituationId =  Publisher.Agent.MonSys.HotSpotList[0].CurrHotSpotId;
	}
	else {
		newEvent.SituationId = 100+(int)Math.Floor(Random.Uniform()*5);
	}
}
// set isAlert

// set topic
TopicRef tRef = Publisher.Agent.MonSys.Create("TopicRef") as TopicRef;
tRef.Topic = Publisher.regTopic;	
newEvent.TopicRefLink = tRef;

Publisher.Agent.PubCount++;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 1;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>52</Height>
                          </Size>
                          <Location>
                            <X>70</X>
                            <Y>29</Y>
                          </Location>
                          <DisplayName>Publish</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>regTopic</Name>
                          <Id>f6032ea6-bfa0-4946-afe7-e348fec3b328</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>c3275e61-9cfa-4038-9c8b-e623517e6e9a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>b9f9bb1c-20e8-4ea3-89ac-4cdb8d43bb0c</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>61</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>9</X>
                            <Y>6</Y>
                          </Location>
                          <DisplayName>regTopic</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Topic</ImplementationType>
                          <InitialValue>null</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>NextStep</Name>
                          <Id>624879d5-401b-43d9-8896-0c24d8417718</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>2b2f6b18-1c41-443f-8430-c878333147a2</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>Choice</Name>
                                <Id>f2da475a-373d-4dca-8050-03a701f09646</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>00ef6660-dc26-4283-b0da-88491f077557</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>7020cd27-86eb-47c6-801a-447ab702f3ba</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>51</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>4</X>
                                  <Y>-1</Y>
                                </Location>
                                <DisplayName>Choice</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>int</ImplementationType>
                                <InitialValue>0</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>37b18d3c-4da5-4134-b72a-7a95118bcded</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>double rand = Random.Uniform();
switch(Publisher.PubType)
{
	case 0: //sensor
	if (rand &lt;= Publisher.CreateP)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 1: // onsite staff
 	case 2: // backoffice staff
	if (Publisher.ProcEvents.Count &gt; 0)
		Choice = 1;
	else if (rand &lt;= Publisher.CreateP/5)
		Choice = 1;
	else 
		Choice = 0;
	break;
	case 3: // backoffice team leader
		// don't publish, just deal with a found situation but not here.
	default: 	
	break;
}

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>51</Height>
                          </Size>
                          <Location>
                            <X>10</X>
                            <Y>124</Y>
                          </Location>
                          <DisplayName>NextStep</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>5cad996b-c1a0-40f6-adb8-062dfdcf634a</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>8db90ec0-a343-4be9-ac80-09e94b683d7f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>bedb1aa2-4254-4fae-99f3-0d6909908303</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>26</Width>
                            <Height>5</Height>
                          </Size>
                          <Location>
                            <X>110</X>
                            <Y>124</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>100</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>0</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>ac18d355-2463-4077-ab8a-0ede5bb06229</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>7b5c37cf-7beb-4ea5-ae75-18d6a38e687f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>e5ab3d77-c87d-4d9e-8db8-676b31716ef8</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (NextStep.Choice == 1);

</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>8</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>80</X>
                            <Y>81</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>70</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>18</X>
                                <Y>52</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>624879d5-401b-43d9-8896-0c24d8417718</Role1Id>
                          <Role2Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence2</Name>
                          <Id>95965c14-ef63-47b4-a224-5f54c910d237</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>1345f704-c6c3-49a1-ac11-8401ae7978eb</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>06c987ae-f13e-43de-bc7c-00fd0b172e10</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>15</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>94</X>
                            <Y>81</Y>
                          </Location>
                          <DisplayName>NewCollabSequence2</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>39</X>
                                <Y>52</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>84</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence3</Name>
                          <Id>d95d7934-4690-450b-9692-6974e3f07257</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>65d931ba-a826-43d4-b771-82b14df30320</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>3d22a826-e372-49c4-b2ae-19b8b650ebd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return true;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>26</Width>
                            <Height>6</Height>
                          </Size>
                          <Location>
                            <X>110</X>
                            <Y>169</Y>
                          </Location>
                          <DisplayName>NewCollabSequence3</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>0</X>
                                <Y>40</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>100</X>
                                <Y>51</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>85fd41dc-a638-4450-94c8-32de58db5c79</Role1Id>
                          <Role2Id>624879d5-401b-43d9-8896-0c24d8417718</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>PubType</Name>
                          <Id>98f17b4a-5df4-4ec9-bd3c-0ccbe83ed4e3</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>7e630362-65ab-4072-b801-209d65e7cf85</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1f5a0efc-ca55-4b93-a6c7-d77378601301</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>62</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>29</Y>
                          </Location>
                          <DisplayName>PubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>Idle</Name>
                          <Id>85fd41dc-a638-4450-94c8-32de58db5c79</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>4026f6f4-28d8-4138-bfd9-ba66f83637ce</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5c72a968-3c91-4be4-9379-24750a8a9257</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 1;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>58</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>136</X>
                            <Y>129</Y>
                          </Location>
                          <DisplayName>Idle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>ProcEvents</Name>
                          <Id>c88f2551-1e52-4ccc-a584-3fa045668084</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>7b8ce72d-38e6-46d9-a835-27101063de43</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ddbcda34-0e63-4ae0-9972-f6c1684e0206</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>78</Width>
                            <Height>23</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>213</Y>
                          </Location>
                          <DisplayName>ProcEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;int&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;int&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>0d2ee00b-758c-4f9d-9651-abd117c018fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>PubType = Agent.AgentType;

int pos = Agent.MonSys.AgentList.IndexOf(Agent);
if (pos != -1 &amp;&amp; pos &lt; Agent.MonSys.AgentPubTopic.Count)
{
	regTopic = Agent.MonSys.AgentPubTopic[pos];	
}
else
{
	regTopic = Agent.MonSys.TopicList[0];
}
regTopic.Publishers.Add(this);
regTopic.PubCount++;

//switch(PubType)
//{
//	case 0: //sensor
//		regTopic = Agent.MonSys.TopicList[0];
//		regTopic.Publishers.Add(this);
//	break;
//	case 1: // onsite staff	
// 		regTopic = Agent.MonSys.TopicList[1];
//		regTopic.Publishers.Add(this);
//		break;
//	case 2: // backoffice staff
//		regTopic = Agent.MonSys.TopicList[2];
//		regTopic.Publishers.Add(this);
//		break;
//	case 3: // backoffice team leader
//		regTopic = Agent.MonSys.TopicList[3];
//		regTopic.Publishers.Add(this);
//		break;
//	default: 
//		
//	break;
//}
;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>246</Height>
                    </Size>
                    <Location>
                      <X>21</X>
                      <Y>45</Y>
                    </Location>
                    <DisplayName>Publisher</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>0.2</CreateP>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>Subscriber</Name>
                    <Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>40e80ce2-df0e-4e82-b7a0-821f8b9a5c00</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>e0a77546-4723-4189-b3aa-76ca12d6ee44</Id>
                            <Types>
                              <anyType xsi:type="Variable">
                                <Name>notification</Name>
                                <Id>0602084a-a49f-40f3-a307-9555cc747bb2</Id>
                                <Structure xsi:type="VariableStructure">
                                  <Id>653fd20c-e312-496c-adb1-d06ca6004b4a</Id>
                                  <Types />
                                </Structure>
                                <Text xsi:type="DP_Text">
                                  <Id>129e736d-c400-4ba7-8670-7ce782dbb4a0</Id>
                                  <Instructions />
                                </Text>
                                <Size>
                                  <Width>75</Width>
                                  <Height>20</Height>
                                </Size>
                                <Location>
                                  <X>5</X>
                                  <Y>38</Y>
                                </Location>
                                <DisplayName>notification</DisplayName>
                                <NameFont>
                                  <FontFamily>Segoe UI</FontFamily>
                                  <Size>9</Size>
                                  <Style>Regular</Style>
                                </NameFont>
                                <ShapeProperties>
                                  <DefaultSize>
                                    <Width>100</Width>
                                    <Height>60</Height>
                                  </DefaultSize>
                                  <BorderColor>
                                    <Argb>-16777216</Argb>
                                  </BorderColor>
                                  <FillColor>
                                    <Argb>0</Argb>
                                  </FillColor>
                                  <GradientFill>true</GradientFill>
                                  <GradientFillColor>
                                    <Argb>0</Argb>
                                  </GradientFillColor>
                                </ShapeProperties>
                                <ImplementationType>NfyMsg</ImplementationType>
                                <InitialValue>null</InitialValue>
                              </anyType>
                            </Types>
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>2c6a8abc-50bc-43c4-b0e7-118a99c15fd7</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>Subscriber.Agent.NfyCount++;
Subscriber.Agent.LastEventAmount = notification.MsgList.Count;

switch(Subscriber.SubType)
{
	case 0: //sensor, don't do anything
	break;
	case 1: // onsite staff	
 	case 2: // backoffice staff
	case 3: // backoffice team leader
		foreach (PubMsg msg in notification.MsgList)
		{
			Subscriber.Agent.EventProcesserList[0].InEvents.Enqueue(msg);	
		}
		break;
	default: 	
	break;
}</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return 0;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>60</Height>
                          </Size>
                          <Location>
                            <X>28</X>
                            <Y>46</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>SubType</Name>
                          <Id>3daae4f8-3552-44d5-bab9-004df92ae9ee</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>51e366c9-019f-4134-a3e8-5a9ab161d4ab</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>1ecd3e60-e110-4616-b549-8918eb8c1ca9</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>60</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>16</X>
                            <Y>119</Y>
                          </Location>
                          <DisplayName>SubType</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>int</ImplementationType>
                          <InitialValue>0</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Subscriptions</Name>
                          <Id>b66d23c5-9b6b-4b06-93bb-0693591280b6</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>d921a7a8-36d3-49df-a08c-38c1d9eb83d4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>0d8cdcf0-1770-4a3e-a26f-73d6755dfdf3</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>92</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>89</X>
                            <Y>119</Y>
                          </Location>
                          <DisplayName>Subscriptions</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                          <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>07b006db-bc02-4ac8-906d-d60914b1cb54</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String>Topic topic = null;
SubType = Agent.AgentType;
TopicGroup tg = null;
switch(SubType)
{
	case 0: //sensor, don't sub to anything
	break;
	case 1: // onsite staff	
		tg = Agent.MonSys.TopicGroupList[0];
// 		topic = Agent.MonSys.TopicList[0]; //from sensors
//		topic.Subscribers.Add(this);		
		break;
	case 2: // backoffice staff
		tg = Agent.MonSys.TopicGroupList[1];
//		topic = Agent.MonSys.TopicList[1]; //from field agents
//		topic.Subscribers.Add(this);
		break;
	case 3: // backoffice team leader
		tg = Agent.MonSys.TopicGroupList[2];
//		topic = Agent.MonSys.TopicList[2]; //from backoffice agents
//		topic.Subscribers.Add(this);
		break;
	default: 
		tg = Agent.MonSys.TopicGroupList[0];	
	break;
}
if (tg != null)
{
	topic = tg.Topics[(int)Random.Uint((uint)0,(uint)tg.Topics.Count)];
	topic.Subscribers.Add(this);
	topic.SubCount++;
}
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>154</Height>
                    </Size>
                    <Location>
                      <X>21</X>
                      <Y>435</Y>
                    </Location>
                    <DisplayName>Subscriber</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>LastEventAmount</Name>
                    <Id>753683cf-4977-4646-aaa9-1c4cdcf58099</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>6dcf29c6-3d00-41d6-b105-820c24136348</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7222f3ca-a7f9-4bad-9efa-d7cd3acf29b3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>19</X>
                      <Y>617</Y>
                    </Location>
                    <DisplayName>LastEventAmount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>NfyCount</Name>
                    <Id>e6011741-bfd9-48af-aff4-51ecc91926b8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>caedd1ba-cb24-409f-9c98-a53eb09f228a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>12f47f90-19b1-4a0c-931f-f93505e7278d</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>593</Y>
                    </Location>
                    <DisplayName>NfyCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>PubCount</Name>
                    <Id>fa548d10-f0ac-4109-ae08-92ccba7887f0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>a72ec206-7bb3-4a59-a201-db6630a0cfa8</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3f344517-c4fe-48c2-bd86-9ce0759d6d40</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>120</X>
                      <Y>18</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Component">
                    <Name>EventProcesser</Name>
                    <Id>18458eda-5164-44e2-ae5e-5523a59c3c36</Id>
                    <Structure xsi:type="ComponentStructure">
                      <Id>093de041-e2ba-42a5-99b2-5524e6ad1456</Id>
                      <Types>
                        <anyType xsi:type="DataTransfer">
                          <Name>InEvents</Name>
                          <Id>92dde1e9-e8ba-42e2-b208-be461dc37d22</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f27c76a5-2d36-4d65-bcab-ba4dd698d366</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>d1ecfa9d-b8e4-47ce-bf6c-f20651d57491</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>82</Width>
                            <Height>25</Height>
                          </Size>
                          <Location>
                            <X>107</X>
                            <Y>99</Y>
                          </Location>
                          <DisplayName>InEvents</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>FieldAgentWork</Name>
                          <Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7433ca20-edba-4fb6-b176-c745007441dd</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>7c7ee748-f99d-4d04-966e-a5dd77c2155c</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
EventProcesser.Agent.ProcessingWork = eventCount;
Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Agent.WorkExeDuration;
double load = eventCount/throughput;
double time = EventProcesser.Agent.WorkExeDuration;

if (load &gt; time)
	EventProcesser.Agent.WorkOverLoad = (load - time);
else
	EventProcesser.Agent.WorkOverLoad = 0;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 10)
	{
		DomainProAnalyst.Instance.Report("Field Agent Detects Situation: "+id);	
		EventProcesser.Agent.PublisherList[0].ProcEvents.Enqueue(id);
	}		    
}
EventProcesser.Situations.Clear();
EventProcesser.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>//double dur = Math.Max(Math.Min(EventProcesser.InEvents.Count/EventProcesser.Agent.WorkExeDuration, EventProcesser.Agent.WorkExeDuration), 5);
//EventProcesser.Agent.ProcessingWork = dur;

double dur = EventProcesser.Agent.WorkExeDuration;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>5</X>
                            <Y>13</Y>
                          </Location>
                          <DisplayName>FieldAgentWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>BackofficeWork</Name>
                          <Id>5921eaa1-9838-40b8-b7d6-4db294573649</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>676fa05e-6087-48ad-875c-7d8680f39567</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>5338dea0-c971-462e-80ce-9dd4f50d28bd</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
EventProcesser.Agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Agent.WorkExeDuration;
double load = eventCount/throughput;
double time = EventProcesser.Agent.WorkExeDuration;

if (load &gt; time)
	EventProcesser.Agent.WorkOverLoad = (load - time);
else
	EventProcesser.Agent.WorkOverLoad = 0;

for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 5)
	{
		DomainProAnalyst.Instance.Report("Backoffice Worker Detects Situation: "+id);	
		EventProcesser.Agent.PublisherList[0].ProcEvents.Enqueue(id);
	}		    
}
// LATER: insert point for analysing events by CROWDsourcing

EventProcesser.Situations.Clear();
EventProcesser.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = EventProcesser.Agent.WorkExeDuration;
return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>46</X>
                            <Y>39</Y>
                          </Location>
                          <DisplayName>BackofficeWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>Situations</Name>
                          <Id>3c1b43f0-5378-4817-b622-0b58f4ecde11</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>f1184758-4b2e-4db5-931c-a1e4ccf40cc9</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>ba865fa1-b010-418f-9e58-1b2232cb1eed</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>67</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>118</X>
                            <Y>17</Y>
                          </Location>
                          <DisplayName>Situations</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;int,int&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;int,int&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>ef8d7d8d-b700-4728-8f97-8be0d49c7ff9</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>09d5ec57-57b8-43dd-8029-08a9a6135f57</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>11540a98-31d9-4cc5-b0c2-01b11857f128</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>38</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>8</X>
                            <Y>103</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="Work">
                          <Name>TeamLeaderWork</Name>
                          <Id>5b741197-7f01-4675-98ea-dfbceef28478</Id>
                          <Structure xsi:type="WorkStructure">
                            <Id>7a1817d4-0fab-48e7-9ff1-a4f77a4203b4</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>6e4219f5-76b8-43d5-9f31-d4c2dfd28611</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>int eventCount = EventProcesser.InEvents.Count;
EventProcesser.Agent.ProcessingWork = eventCount;

Dictionary&lt;int,int&gt; dict = EventProcesser.Situations;
double throughput = EventProcesser.Agent.WorkExeDuration;
double load = eventCount/throughput;
double time = EventProcesser.Agent.WorkExeDuration;

if (load &gt; time)
	EventProcesser.Agent.WorkOverLoad = (load - time);
else
	EventProcesser.Agent.WorkOverLoad = 0;
for (int i = 0; i&lt;eventCount; i++)
{
	PubMsg msg = EventProcesser.InEvents.Dequeue();
	int counter = 0;		
	if (dict.TryGetValue(msg.SituationId, out counter))
	{
		dict[msg.SituationId] = counter+1;
	}	
	else
	{
		dict.Add(msg.SituationId, 1);
	}
}

double timeNow = Model.Simulation.Simulator.Scheduler.Time;
foreach (KeyValuePair&lt;int,int&gt; pair in EventProcesser.Situations)
{
	int id = pair.Key;
	int count = pair.Value;
	
	if (count &gt; 3)
	{
		DomainProAnalyst.Instance.Report("Team Leader Detects Situation: "+id);		
		if (id &gt; 0 &amp;&amp; EventProcesser.Agent.MonSys.HotSpotList[0].UndetectedDict.ContainsKey(id))
		{
			double start = EventProcesser.Agent.MonSys.HotSpotList[0].UndetectedDict[id];
			EventProcesser.Agent.MonSys.HotSpotList[0].UndetectedDict.Remove(id);
			double duration = timeNow - start;
			EventProcesser.Agent.MonSys.HotSpotList[0].DurDict.Add(id, duration);
			EventProcesser.Agent.MonSys.HotSpotList[0].DetectionDuration = duration;
		}
	}		    
}
EventProcesser.Situations.Clear();
EventProcesser.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>double dur = EventProcesser.Agent.WorkExeDuration;

return dur;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>100</Width>
                            <Height>40</Height>
                          </Size>
                          <Location>
                            <X>98</X>
                            <Y>57</Y>
                          </Location>
                          <DisplayName>TeamLeaderWork</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dot</BorderStyle>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7d4ae50c-7048-485b-b6a4-cf6c1d57796e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>200</Width>
                      <Height>131</Height>
                    </Size>
                    <Location>
                      <X>20</X>
                      <Y>298</Y>
                    </Location>
                    <DisplayName>EventProcesser</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence1</Name>
                    <Id>4e2f9c26-1531-448f-b5e3-38214f3fd97a</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>63f2eb33-ec9d-43bd-b7c1-13effbb2aef2</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>e33f926b-fd31-4475-bc08-5d8a9a940ab6</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==2 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>3</Width>
                      <Height>104</Height>
                    </Size>
                    <Location>
                      <X>82</X>
                      <Y>377</Y>
                    </Location>
                    <DisplayName>NewCollabSequence1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>36</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>16</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5921eaa1-9838-40b8-b7d6-4db294573649</Role2Id>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>ProcessingWork</Name>
                    <Id>b543d18c-736d-438f-b7b5-d2a6df22d4ce</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>4c86bf70-a2cb-4f16-b9ed-b9bf0b39cc74</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ac2e9bb2-e3df-434d-8fbc-f95298c36346</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>124</X>
                      <Y>591</Y>
                    </Location>
                    <DisplayName>ProcessingWork</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence</Name>
                    <Id>d30f365a-94d6-490e-a983-f624eb00f904</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>8a01a9e6-6e3a-418b-bfd5-f98f5a53d63a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>782de7b2-39c8-4c2b-bcae-a27d894a719a</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==1 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>7</Width>
                      <Height>130</Height>
                    </Size>
                    <Location>
                      <X>58</X>
                      <Y>351</Y>
                    </Location>
                    <DisplayName>NewCollabSequence</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>16</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>33</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>077c127f-8bf1-4916-bd58-eba67ab5ee3a</Role2Id>
                  </anyType>
                  <anyType xsi:type="Variable">
                    <Name>AgentType</Name>
                    <Id>5989f823-cbf8-482b-a8f3-d24971ce8ee5</Id>
                    <Structure xsi:type="VariableStructure">
                      <Id>547b035a-70c7-4931-8b85-c8cacb732598</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>38a10ec8-e7fc-4674-a3a2-5b5e1f7da6a5</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>18</X>
                      <Y>18</Y>
                    </Location>
                    <DisplayName>AgentType</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="CollabSequence">
                    <Name>NewCollabSequence2</Name>
                    <Id>afcca767-b6bc-4d6a-be35-521206ed040f</Id>
                    <Structure xsi:type="CollabSequenceStructure">
                      <Id>7b746db2-1c22-4317-b5db-5998c56d2cae</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>83be36d9-a51a-46a3-baab-30cc03e3a8b9</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return (Receive.Subscriber.SubType==3 &amp;&amp; Receive.Subscriber.Agent.EventProcesserList[0].isIdle);
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String>Receive.Subscriber.Agent.EventProcesserList[0].isIdle = false;</String>
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Receive.Subscriber.Agent.EventProcesserList[0];</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>17</Width>
                      <Height>86</Height>
                    </Size>
                    <Location>
                      <X>101</X>
                      <Y>395</Y>
                    </Location>
                    <DisplayName>NewCollabSequence2</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>0</BorderWidth>
                      <FillColor>
                        <Argb>-16777216</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>52</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role1Id>
                    <Role2Id>5b741197-7f01-4675-98ea-dfbceef28478</Role2Id>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>WorkOverLoad</Name>
                    <Id>6cbfaab7-d17c-4f9b-bf30-7164558de1e0</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>0b3aeeea-2a86-44e0-9840-65c092141264</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>ce3ed447-bd45-4e53-a626-01b8c9cd729b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>127</X>
                      <Y>621</Y>
                    </Location>
                    <DisplayName>WorkOverLoad</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>9a126559-425c-4175-820f-3aa112a5fbc1</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>int pos = MonSys.AgentList.IndexOf(this);
if (pos != -1 &amp;&amp; pos &lt; MonSys.AgentTypeConfig.Count)
{
	AgentType = MonSys.AgentTypeConfig[pos];
}
else
{
	AgentType = 0;
}

</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>250</Width>
                <Height>650</Height>
              </Size>
              <Location>
                <X>20</X>
                <Y>3</Y>
              </Location>
              <DisplayName>Agent</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Collaborator">
              <Name>PubSubMW</Name>
              <Id>1a2db479-64c7-468b-83ab-2600ab15a6c5</Id>
              <Structure xsi:type="CollaboratorStructure">
                <Id>ce033941-a04c-45e5-b4db-be0d8fa3bd1a</Id>
                <Types>
                  <anyType xsi:type="Connector">
                    <Name>EventCoord</Name>
                    <Id>f9b2f383-d76c-44a5-bc40-e192ec129c09</Id>
                    <Structure xsi:type="ConnectorStructure">
                      <Id>933d7c9c-3659-4b9f-9ebc-bbe9b9763c0c</Id>
                      <Types>
                        <anyType xsi:type="Read">
                          <Name>Receive</Name>
                          <Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Id>
                          <Structure xsi:type="ReadStructure">
                            <Id>38db7cfb-2d8a-47e8-a2cb-a080340a9ee6</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>40eb3b63-640d-4c01-8ec5-b3d8143fce83</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>EventCoord.isIdle = false;
if (!EventCoord.isIdleInternal)
	return;
EventCoord.isIdleInternal = false;
while (EventCoord.InQueue.Count &gt; 0)
{
	PubMsg msg = EventCoord.InQueue.Dequeue();
	Topic topic = msg.TopicRef;
	foreach (MonSysContext.AgentContext.Subscriber sub in topic.Subscribers)
	{
		NfyMsg exMsg;		
		if (EventCoord.EventDict.TryGetValue(sub, out exMsg))
		{
			exMsg.MsgList.Add(msg);
			//EventCoord.EventDict[sub] = exMsg;
		}
		else
		{
			exMsg = EventCoord.PubSubMW.MonSys.Create("NfyMsg") as NfyMsg;
			exMsg.MsgList.Add(msg);
			exMsg.Receiver = sub;
			EventCoord.EventDict.Add(sub,exMsg);
		}				
	}
}
EventCoord.isIdleInternal = true;	
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.ReadP;
</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>43</Height>
                          </Size>
                          <Location>
                            <X>34</X>
                            <Y>68</Y>
                          </Location>
                          <DisplayName>Receive</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="Create">
                          <Name>Forward</Name>
                          <Id>0b6cae23-f311-41f2-92b0-972249972a03</Id>
                          <Structure xsi:type="CreateStructure">
                            <Id>110b852e-9c3a-420f-9e40-d129a95a1d1d</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>52936466-348d-47a5-9658-e2910a22d17e</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Run</Name>
                                <String>DomainProAnalyst.Instance.Report("Delivering to # subscribers: "+EventCoord.EventDict.Count);

int msgCount = 0;

foreach (KeyValuePair&lt;MonSysContext.AgentContext.Subscriber,NfyMsg&gt; pair in EventCoord.EventDict)
{
	NfyMsg msg = pair.Value;
	//DomainProAnalyst.Instance.Report("Triggering Delivery");
	msgCount +=	msg.MsgList.Count;
	msg.Created(false);	    
}
EventCoord.EventDict.Clear();
EventCoord.PubSubMW.TotalMsgDelivered += msgCount;
EventCoord.PubSubMW.MsgLastDelivered = msgCount;

EventCoord.isIdle = true;</String>
                              </Instruction>
                              <Instruction>
                                <Name>Duration</Name>
                                <String>return EventCoord.PubSubMW.WorkExeDuration/EventCoord.CreateP;

</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>120</Width>
                            <Height>45</Height>
                          </Size>
                          <Location>
                            <X>35</X>
                            <Y>192</Y>
                          </Location>
                          <DisplayName>Forward</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>-1</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                            <CornerRounding>5</CornerRounding>
                            <Alignment>MiddleCenter</Alignment>
                          </ShapeProperties>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>InQueue</Name>
                          <Id>2efdf883-4f24-4c2c-98c8-dca2a5042ebc</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>2074aadf-65f5-4961-8260-a6f31e527608</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>08c812ef-34df-4239-b466-b5c0da23e2d0</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>69</Width>
                            <Height>28</Height>
                          </Size>
                          <Location>
                            <X>6</X>
                            <Y>14</Y>
                          </Location>
                          <DisplayName>InQueue</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Queue&lt;PubMsg&gt;</ImplementationType>
                          <InitialValue>new Queue&lt;PubMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdle</Name>
                          <Id>1ba10a0c-c75d-4885-96af-5cd15618a424</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>231b7009-b5e9-4468-9ead-2f228cd29ecf</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>68e74441-0a5f-4f2d-b5bc-d600a6461a2f</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>49</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>7</X>
                            <Y>43</Y>
                          </Location>
                          <DisplayName>isIdle</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                        <anyType xsi:type="DataTransfer">
                          <Name>EventDict</Name>
                          <Id>dfa49fa3-ad95-4424-adec-8a4eae63a4f9</Id>
                          <Structure xsi:type="DataTransferStructure">
                            <Id>f0e05682-58d6-4d03-895d-379ac89f955a</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>f5aaf590-1ff6-4a4c-9f78-39577829a4b5</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>65</Width>
                            <Height>24</Height>
                          </Size>
                          <Location>
                            <X>15</X>
                            <Y>140</Y>
                          </Location>
                          <DisplayName>EventDict</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderStyle>Dash</BorderStyle>
                            <BorderColor>
                              <Argb>-16776961</Argb>
                            </BorderColor>
                            <BorderWidth>2</BorderWidth>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>Dictionary&lt;Simulation.MonSysContext.AgentContext.Subscriber,NfyMsg&gt;</ImplementationType>
                          <InitialValue>new Dictionary&lt;Simulation.MonSysContext.AgentContext.Subscriber,NfyMsg&gt;()</InitialValue>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence</Name>
                          <Id>cf0cf262-99c2-4c63-a13f-5138c0a4c406</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>9848c33c-6f6b-473c-9dc9-593f37458bc5</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>a1693d5b-04e6-4330-af1e-793819620896</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (EventCoord.EventDict.Count &gt; 0);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String />
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>3</Width>
                            <Height>81</Height>
                          </Size>
                          <Location>
                            <X>82</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>51</X>
                                <Y>43</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>47</X>
                                <Y>0</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role1Id>
                          <Role2Id>0b6cae23-f311-41f2-92b0-972249972a03</Role2Id>
                        </anyType>
                        <anyType xsi:type="CollabSequence">
                          <Name>NewCollabSequence1</Name>
                          <Id>d637fb9c-20b4-4b5e-9c70-b2c375070b39</Id>
                          <Structure xsi:type="CollabSequenceStructure">
                            <Id>d1b935f4-6170-419b-8843-727c7bfc78d2</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>869d5813-7135-43c8-b2fa-798b11834fb4</Id>
                            <Instructions>
                              <Instruction>
                                <Name>Trigger</Name>
                                <String>return (EventCoord.InQueue.Count &gt; 0 &amp;&amp; EventCoord.isIdle == true);
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Transfer</Name>
                                <String>Forward.EventCoord.isIdle = false;
</String>
                              </Instruction>
                              <Instruction>
                                <Name>Resolve</Name>
                                <String>return Context;</String>
                              </Instruction>
                            </Instructions>
                          </Text>
                          <Size>
                            <Width>3</Width>
                            <Height>81</Height>
                          </Size>
                          <Location>
                            <X>129</X>
                            <Y>111</Y>
                          </Location>
                          <DisplayName>NewCollabSequence1</DisplayName>
                          <ShowName>false</ShowName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <LineProperties>
                            <LineWidth>2</LineWidth>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <BorderWidth>0</BorderWidth>
                            <FillColor>
                              <Argb>-16777216</Argb>
                            </FillColor>
                            <Role1>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Offset>
                                <X>97</X>
                                <Y>0</Y>
                              </Offset>
                            </Role1>
                            <Role2>
                              <Font>
                                <FontFamily>Segoe UI</FontFamily>
                                <Size>9</Size>
                                <Style>Regular</Style>
                              </Font>
                              <Icon>..\..\Icons\triangle.gif</Icon>
                              <Offset>
                                <X>95</X>
                                <Y>43</Y>
                              </Offset>
                            </Role2>
                          </LineProperties>
                          <Role1Id>0b6cae23-f311-41f2-92b0-972249972a03</Role1Id>
                          <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
                        </anyType>
                        <anyType xsi:type="Variable">
                          <Name>isIdleInternal</Name>
                          <Id>0764f164-1033-45bf-aed3-74d0d3aee379</Id>
                          <Structure xsi:type="VariableStructure">
                            <Id>b07ed44c-a83c-45a7-861f-9b4c0288fc4f</Id>
                            <Types />
                          </Structure>
                          <Text xsi:type="DP_Text">
                            <Id>afb159ae-66b7-4d34-b05f-a48ed0567183</Id>
                            <Instructions />
                          </Text>
                          <Size>
                            <Width>85</Width>
                            <Height>20</Height>
                          </Size>
                          <Location>
                            <X>176</X>
                            <Y>44</Y>
                          </Location>
                          <DisplayName>isIdleInternal</DisplayName>
                          <NameFont>
                            <FontFamily>Segoe UI</FontFamily>
                            <Size>9</Size>
                            <Style>Regular</Style>
                          </NameFont>
                          <ShapeProperties>
                            <DefaultSize>
                              <Width>100</Width>
                              <Height>60</Height>
                            </DefaultSize>
                            <BorderColor>
                              <Argb>-16777216</Argb>
                            </BorderColor>
                            <FillColor>
                              <Argb>0</Argb>
                            </FillColor>
                            <GradientFill>true</GradientFill>
                            <GradientFillColor>
                              <Argb>0</Argb>
                            </GradientFillColor>
                          </ShapeProperties>
                          <ImplementationType>bool</ImplementationType>
                          <InitialValue>true</InitialValue>
                        </anyType>
                      </Types>
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>9234e8d0-0e5b-4ca2-b7f5-dbe0eb9862fa</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Startup</Name>
                          <String />
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>169</Width>
                      <Height>280</Height>
                    </Size>
                    <Location>
                      <X>25</X>
                      <Y>36</Y>
                    </Location>
                    <DisplayName>EventCoord</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Bold</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <BorderWidth>3</BorderWidth>
                      <FillColor>
                        <Argb>-21</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>TopCenter</Alignment>
                    </ShapeProperties>
                    <CreateP>1</CreateP>
                    <ReadP>1</ReadP>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>TotalMsgDelivered</Name>
                    <Id>9461c7d5-2e76-4d46-927e-593fdda95daf</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>471b08ce-6c88-4075-a413-5f045c707d20</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f572d32e-05b4-4a31-9636-0e8e456df9f8</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>113</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>27</X>
                      <Y>326</Y>
                    </Location>
                    <DisplayName>TotalMsgDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="Metric">
                    <Name>MsgLastDelivered</Name>
                    <Id>ff63e7c8-845a-4c48-9d5d-f94ffbc5caa8</Id>
                    <Structure xsi:type="MetricStructure">
                      <Id>419263cd-097f-4739-9b32-de992fb29a7f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>75684520-b092-4df7-8bfc-33b2e38d13c7</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>117</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>26</X>
                      <Y>352</Y>
                    </Location>
                    <DisplayName>MsgLastDelivered</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>bc116251-7a0b-4260-b56e-3e621f2e8b21</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>223</Width>
                <Height>383</Height>
              </Size>
              <Location>
                <X>479</X>
                <Y>13</Y>
              </Location>
              <DisplayName>PubSubMW</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>PubMsg</Name>
              <Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>69c51788-1b1b-49a6-aa69-e46867a1a310</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>64342a55-5b69-4c47-b450-6b14e75f3e5f</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>1f366bd0-c1ac-4a02-acd9-80eb1b3527d5</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].InQueue.Enqueue(PubMsg);</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>8</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>isAlert</Name>
                    <Id>6f65567b-f411-4cdb-8aa9-38629bd67780</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>fa846864-abb2-44dc-8552-344b9287bfe6</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b5189b1a-3d25-4703-b5fc-6d1fbfc9a23d</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>55</Y>
                    </Location>
                    <DisplayName>isAlert</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>bool</ImplementationType>
                    <InitialValue>false</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>SituationId</Name>
                    <Id>ca5b6bea-ac44-4232-b3db-9ff5a2b5f37d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>ea7c2d76-3476-429d-843b-bc272dcf6ce9</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>3a550d22-c53a-4f12-9984-6b92650447c4</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>83</Y>
                    </Location>
                    <DisplayName>SituationId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>dd991929-3d0e-41ee-88a4-b29df54d9102</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>114</Height>
              </Size>
              <Location>
                <X>311</X>
                <Y>51</Y>
              </Location>
              <DisplayName>PubMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>NfyMsg</Name>
              <Id>c6932e1e-1af9-489a-9383-c76e6cc11472</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>290176d1-8419-49c7-9d0c-e50919956f26</Id>
                <Types>
                  <anyType xsi:type="Trigger">
                    <Name>Created</Name>
                    <Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>993e21c6-045b-413f-a783-257c6246a3c4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>7186bc46-bd5a-4db6-b3b1-a75845776e4e</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0.001;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>29</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>22</Y>
                    </Location>
                    <DisplayName>Created</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>MsgList</Name>
                    <Id>4bd42898-0ce0-4add-9cde-02f80ee5014f</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>b1933403-c1ba-4c12-b36d-a057bfb0816d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>701e2872-74ab-49b3-9f2e-76314b4a7d49</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>102</Width>
                      <Height>26</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>56</Y>
                    </Location>
                    <DisplayName>MsgList</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;PubMsg&gt;</ImplementationType>
                    <InitialValue>new List&lt;PubMsg&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Receiver</Name>
                    <Id>ad14f68f-026a-4703-92f1-c440800fca1f</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>882bd524-3551-4021-8d12-c8b245dd6d15</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4d157456-f6d2-4b96-8b4c-7bcad8c9a1bc</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>11</X>
                      <Y>85</Y>
                    </Location>
                    <DisplayName>Receiver</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Simulation.MonSysContext.AgentContext.Subscriber</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>63ce7384-9edb-4770-ba46-7287593be66d</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>115</Height>
              </Size>
              <Location>
                <X>304</X>
                <Y>493</Y>
              </Location>
              <DisplayName>NfyMsg</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>TopicRef</Name>
              <Id>70e29034-4f33-4125-ac51-d0a3389f8d0f</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>58001520-2970-4b06-af41-b7b8c1585b56</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>8d2946b9-595e-4250-9b7a-ac5961dd9794</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>23</Width>
                <Height>36</Height>
              </Size>
              <Location>
                <X>339</X>
                <Y>165</Y>
              </Location>
              <DisplayName>TopicRef</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>51</X>
                    <Y>114</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>35</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>1a80aed3-34b0-4776-82a3-740c250fcbdb</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>Topic</Name>
              <Id>06842019-c2e7-4252-8b63-71dbef10c28f</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>02feb813-8af3-4f46-8bbf-bd29fdbd85ea</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Subscribers</Name>
                    <Id>ab4b60b6-7c76-4e9e-9991-f31c4b8d16df</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>f310a45d-c9cc-49b6-8690-70f5f4d137e4</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>bde409ae-8a5a-412d-a162-db8040092220</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>23</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>101</Y>
                    </Location>
                    <DisplayName>Subscribers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.Subscriber&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.Subscriber&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>Publishers</Name>
                    <Id>3e50ad75-d368-455d-a45f-bff71a8f38a1</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>a15436d8-2aa4-4b65-a440-27e195bd5439</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>beb42bce-fc1a-420e-9b11-e72943285848</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>48</Y>
                    </Location>
                    <DisplayName>Publishers</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Simulation.MonSysContext.AgentContext.Publisher&gt;</ImplementationType>
                    <InitialValue>new List&lt;Simulation.MonSysContext.AgentContext.Publisher&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>TopicNameId</Name>
                    <Id>f91cd1d8-e217-46a2-81a1-5599f0e8ef60</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>def7b254-277a-418d-a6d0-9762e6b5a0f5</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4405e15b-4978-4b8a-b12f-a8cc189209a3</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>TopicNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>PubCount</Name>
                    <Id>7e2fe468-4a9a-4070-919c-60f473e3028e</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>36576409-c7ad-438f-aa6b-f4b045723abd</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a58ba50c-3ca5-4595-bf85-8fc63eba3a5e</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>69</Y>
                    </Location>
                    <DisplayName>PubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>SubCount</Name>
                    <Id>c8a2274c-439c-4e37-8e95-3918a365aec5</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1133498e-ff29-4a21-a274-e526f5513e8d</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>79bb39c9-babd-4b0e-aec1-294436e3c224</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>125</Y>
                    </Location>
                    <DisplayName>SubCount</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d4572af9-69c5-4fc5-9398-9a5c868dea71</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>129</Width>
                <Height>157</Height>
              </Size>
              <Location>
                <X>304</X>
                <Y>201</Y>
              </Location>
              <DisplayName>Topic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow1</Name>
              <Id>46aa1f74-6947-4c95-b79c-405f302a290d</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>a5306596-497c-43fa-9af4-27533732e9ff</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>6d2dcf71-2e6e-4b63-9ab9-f5a3c62bf9d4</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String />
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Publish.newEvent;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>88</Width>
                <Height>3</Height>
              </Size>
              <Location>
                <X>231</X>
                <Y>94</Y>
              </Location>
              <DisplayName>NewTriggerFlow1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>120</X>
                    <Y>17</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>d88d45e6-1834-4395-8acf-bbbcb15978e9</Role1Id>
              <Role2Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow</Name>
              <Id>43c38c9a-0da0-4e67-8c9e-a4fd7f8afd4c</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>d6d84785-b77b-4fb9-a347-ce095c181387</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>590306b3-1fb3-4766-9ee9-848d4f773aca</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return (Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle);
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>//Receive.EventCoord.isIdle = false;
Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0].isIdle = false;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.PubMsg.MonSys.PubSubMWList[0].EventCoordList[0];</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>109</Width>
                <Height>41</Height>
              </Size>
              <Location>
                <X>429</X>
                <Y>97</Y>
              </Location>
              <DisplayName>NewTriggerFlow</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>110</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>21</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>acf97da8-5dd0-4671-bc9b-9ee25663fd0d</Role1Id>
              <Role2Id>0fcf9479-3c2e-4b01-90d5-3c0b78b12862</Role2Id>
            </anyType>
            <anyType xsi:type="TriggerFlow">
              <Name>NewTriggerFlow2</Name>
              <Id>3a06e665-b71e-48ba-984f-e21d5af916e9</Id>
              <Structure xsi:type="TriggerFlowStructure">
                <Id>8a7c9849-fd49-4ebd-acc5-ce3d674a81c7</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad746893-5a1e-4a5d-a66d-b49c3aae875e</Id>
                <Instructions>
                  <Instruction>
                    <Name>Trigger</Name>
                    <String>return true;
</String>
                  </Instruction>
                  <Instruction>
                    <Name>Transfer</Name>
                    <String>Receive.notification = Created.NfyMsg;</String>
                  </Instruction>
                  <Instruction>
                    <Name>Resolve</Name>
                    <String>return Created.NfyMsg.Receiver;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>122</Width>
                <Height>29</Height>
              </Size>
              <Location>
                <X>189</X>
                <Y>515</Y>
              </Location>
              <DisplayName>NewTriggerFlow2</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <LineWidth>2</LineWidth>
                <BorderColor>
                  <Argb>-8388480</Argb>
                </BorderColor>
                <BorderWidth>0</BorderWidth>
                <FillStyle>Dot</FillStyle>
                <FillColor>
                  <Argb>-8388480</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>29</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>120</X>
                    <Y>31</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>b2679bfb-c848-4b8c-9153-1a09b56aed6e</Role1Id>
              <Role2Id>64d0ac6c-c045-4179-89e9-d781d3b07d8a</Role2Id>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentTypeConfig</Name>
              <Id>ad689e1f-803b-4364-bf15-236c407d5527</Id>
              <Structure xsi:type="VariableStructure">
                <Id>2e22ff0b-d6a6-451c-a723-257bb44f78f2</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>a314fb25-b914-4bc8-a9eb-234ac6302378</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>100</Width>
                <Height>24</Height>
              </Size>
              <Location>
                <X>279</X>
                <Y>2</Y>
              </Location>
              <DisplayName>AgentTypeConfig</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;int&gt;</ImplementationType>
              <InitialValue>new List&lt;int&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>HotSpot</Name>
              <Id>40ee8080-94e9-41ab-b53c-9a3d8f1f6643</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>b74ea3ac-aeff-47d6-a1d4-23bc786b5050</Id>
                <Types>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DurDict</Name>
                    <Id>7ce70a00-7b68-4d3f-96e9-da8ebf182dbd</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>e73f3339-8e4b-47d0-ba98-cd2bbfbff559</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>d133a200-9f4f-46fb-a32b-6a4456c7d5e9</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>105</Y>
                    </Location>
                    <DisplayName>DurDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>CurrHotSpotId</Name>
                    <Id>c4f8b7f4-daef-43c0-848a-9ab714ab3b6d</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>5febc841-f95c-4ccd-a0a4-73142229564c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>883372b6-38e5-4412-8cb7-05fcc08cc836</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>20</Height>
                    </Size>
                    <Location>
                      <X>14</X>
                      <Y>54</Y>
                    </Location>
                    <DisplayName>CurrHotSpotId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>int</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>UndetectedDict</Name>
                    <Id>7c6533b5-23c4-4b34-b47f-cfd800300180</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>1ff9198a-2dd7-45c5-ae20-d51d608ac7b1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>b1a9b9a0-05bb-4a17-8085-b04b74a1f19f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>76</Y>
                    </Location>
                    <DisplayName>UndetectedDict</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>Dictionary&lt;int, double&gt;</ImplementationType>
                    <InitialValue>new Dictionary&lt;int, double&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>SwitchHotSpot</Name>
                    <Id>ddf21a32-ba3e-476b-ae92-542866135ded</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>ec60ce19-1814-41b3-8f29-6f5b814485de</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>92027f12-aa94-4d02-b2de-99da8e662760</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String>HotSpot.CurrHotSpotId++;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;
HotSpot.UndetectedDict.Add(HotSpot.CurrHotSpotId,timeNow);
HotSpot.SwitchMoment = timeNow;
DomainProAnalyst.Instance.Report("Hotspot Switching Situation");</String>
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return 0;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>33</Height>
                    </Size>
                    <Location>
                      <X>7</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>SwitchHotSpot</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="Trigger">
                    <Name>Timer</Name>
                    <Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Id>
                    <Structure xsi:type="TriggerStructure">
                      <Id>eca9ea11-5c79-4de0-81ab-7eda4f770a98</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>a3c07e89-cd14-4409-b874-ba28b0c3e430</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Run</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Duration</Name>
                          <String>return Random.LogNormal(0, 0.5)*10+10;
</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>66</Width>
                      <Height>40</Height>
                    </Size>
                    <Location>
                      <X>211</X>
                      <Y>26</Y>
                    </Location>
                    <DisplayName>Timer</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderStyle>Dot</BorderStyle>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <BorderWidth>2</BorderWidth>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                      <Alignment>MiddleCenter</Alignment>
                    </ShapeProperties>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow</Name>
                    <Id>0a3f2a5e-a769-4c20-83de-2af4ff196df2</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>98d856b3-a191-42ab-8118-02f0ead60394</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>618be2fc-0421-4fc1-99d3-3714d439f576</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>94</Width>
                      <Height>26</Height>
                    </Size>
                    <Location>
                      <X>117</X>
                      <Y>17</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>110</X>
                          <Y>0</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>0</X>
                          <Y>17</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role1Id>
                    <Role2Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role2Id>
                  </anyType>
                  <anyType xsi:type="IntraTriggerFlow">
                    <Name>NewIntraTriggerFlow1</Name>
                    <Id>91a8d82f-16da-4091-af58-afb58f932962</Id>
                    <Structure xsi:type="IntraTriggerFlowStructure">
                      <Id>00bbb6d6-34a7-4672-b150-424bc8f67ea0</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>f249c463-2b3f-4864-bc65-4d61e825165d</Id>
                      <Instructions>
                        <Instruction>
                          <Name>Trigger</Name>
                          <String>return true;
</String>
                        </Instruction>
                        <Instruction>
                          <Name>Transfer</Name>
                          <String />
                        </Instruction>
                        <Instruction>
                          <Name>Resolve</Name>
                          <String>return Context;</String>
                        </Instruction>
                      </Instructions>
                    </Text>
                    <Size>
                      <Width>94</Width>
                      <Height>16</Height>
                    </Size>
                    <Location>
                      <X>117</X>
                      <Y>50</Y>
                    </Location>
                    <DisplayName>NewIntraTriggerFlow1</DisplayName>
                    <ShowName>false</ShowName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <LineProperties>
                      <LineWidth>2</LineWidth>
                      <BorderColor>
                        <Argb>-8388480</Argb>
                      </BorderColor>
                      <FillStyle>Dot</FillStyle>
                      <FillColor>
                        <Argb>-8388480</Argb>
                      </FillColor>
                      <Role1>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Offset>
                          <X>0</X>
                          <Y>40</Y>
                        </Offset>
                      </Role1>
                      <Role2>
                        <Font>
                          <FontFamily>Segoe UI</FontFamily>
                          <Size>9</Size>
                          <Style>Regular</Style>
                        </Font>
                        <Icon>..\..\Icons\triangle.gif</Icon>
                        <Offset>
                          <X>110</X>
                          <Y>33</Y>
                        </Offset>
                      </Role2>
                    </LineProperties>
                    <Role1Id>c3d1ba2b-2af1-4c72-b9ba-045c1703c47b</Role1Id>
                    <Role2Id>ddf21a32-ba3e-476b-ae92-542866135ded</Role2Id>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>SwitchMoment</Name>
                    <Id>02851ecf-edd4-42d1-ab91-0cdd7b0d6937</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>2aa3f51f-d967-4308-a6a9-85cf443898ec</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>46eb56c0-8b22-4a6e-b5ce-da91e89aa708</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>24</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>131</Y>
                    </Location>
                    <DisplayName>SwitchMoment</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectMetadata">
                    <Name>DetectionDuration</Name>
                    <Id>3bd32e2e-aa96-4e13-a9b9-8d62b6736d88</Id>
                    <Structure xsi:type="ObjectMetadataStructure">
                      <Id>46298267-e155-4336-a3c7-ed3975acf93a</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>4c372b2e-f727-4231-b391-dc731617d92f</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>110</Width>
                      <Height>25</Height>
                    </Size>
                    <Location>
                      <X>10</X>
                      <Y>157</Y>
                    </Location>
                    <DisplayName>DetectionDuration</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>double</ImplementationType>
                    <InitialValue>0</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>ad64fc9c-c998-4c93-9133-4408511431a6</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String>CurrHotSpotId = 0;
double timeNow = Model.Simulation.Simulator.Scheduler.Time;
UndetectedDict.Add(CurrHotSpotId,timeNow);
SwitchMoment = timeNow;</String>
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>187</Height>
              </Size>
              <Location>
                <X>477</X>
                <Y>430</Y>
              </Location>
              <DisplayName>HotSpot</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="Variable">
              <Name>AgentPubTopic</Name>
              <Id>3381378b-dffd-4636-b856-52ccb3faad9f</Id>
              <Structure xsi:type="VariableStructure">
                <Id>ef0262da-0166-410e-8d47-84399ec88169</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>97b541c8-84aa-46e3-94d1-3e3e228eebc9</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>100</Width>
                <Height>20</Height>
              </Size>
              <Location>
                <X>280</X>
                <Y>27</Y>
              </Location>
              <DisplayName>AgentPubTopic</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16777216</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
              </ShapeProperties>
              <ImplementationType>List&lt;Topic&gt;</ImplementationType>
              <InitialValue>new List&lt;Topic&gt;()</InitialValue>
            </anyType>
            <anyType xsi:type="CollabObject">
              <Name>TopicGroup</Name>
              <Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Id>
              <Structure xsi:type="CollabObjectStructure">
                <Id>9d7a4070-61d6-4738-bb9d-e29d83cc54df</Id>
                <Types>
                  <anyType xsi:type="ObjectData">
                    <Name>Topics</Name>
                    <Id>7b126fb8-d010-4a41-be94-7e5ed9c0eb77</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>0ccfad9e-389f-44ba-8c5d-8e90a161c4a1</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>78b6921f-e76b-4d06-b619-c6ef9553f52b</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>21</Height>
                    </Size>
                    <Location>
                      <X>13</X>
                      <Y>20</Y>
                    </Location>
                    <DisplayName>Topics</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>List&lt;Topic&gt;</ImplementationType>
                    <InitialValue>new List&lt;Topic&gt;()</InitialValue>
                  </anyType>
                  <anyType xsi:type="ObjectData">
                    <Name>GroupNameId</Name>
                    <Id>ba91aed0-8bb6-435f-8806-2315fe458faa</Id>
                    <Structure xsi:type="ObjectDataStructure">
                      <Id>8f72bc0a-1689-4c77-86f9-317e91f69a2c</Id>
                      <Types />
                    </Structure>
                    <Text xsi:type="DP_Text">
                      <Id>cff4f7dc-e5e4-4a2b-83f3-401b735e8d17</Id>
                      <Instructions />
                    </Text>
                    <Size>
                      <Width>100</Width>
                      <Height>22</Height>
                    </Size>
                    <Location>
                      <X>12</X>
                      <Y>44</Y>
                    </Location>
                    <DisplayName>GroupNameId</DisplayName>
                    <NameFont>
                      <FontFamily>Segoe UI</FontFamily>
                      <Size>9</Size>
                      <Style>Regular</Style>
                    </NameFont>
                    <ShapeProperties>
                      <DefaultSize>
                        <Width>100</Width>
                        <Height>60</Height>
                      </DefaultSize>
                      <BorderColor>
                        <Argb>-16777216</Argb>
                      </BorderColor>
                      <FillColor>
                        <Argb>0</Argb>
                      </FillColor>
                      <GradientFill>true</GradientFill>
                      <GradientFillColor>
                        <Argb>0</Argb>
                      </GradientFillColor>
                    </ShapeProperties>
                    <ImplementationType>String</ImplementationType>
                    <InitialValue>null</InitialValue>
                  </anyType>
                </Types>
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>2560cecb-ef1b-43bf-86db-2aa0ac452134</Id>
                <Instructions>
                  <Instruction>
                    <Name>Startup</Name>
                    <String />
                  </Instruction>
                </Instructions>
              </Text>
              <Size>
                <Width>125</Width>
                <Height>74</Height>
              </Size>
              <Location>
                <X>304</X>
                <Y>392</Y>
              </Location>
              <DisplayName>TopicGroup</DisplayName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <ShapeProperties>
                <DefaultSize>
                  <Width>100</Width>
                  <Height>60</Height>
                </DefaultSize>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <BorderWidth>2</BorderWidth>
                <FillColor>
                  <Argb>-2561</Argb>
                </FillColor>
                <GradientFill>true</GradientFill>
                <GradientFillColor>
                  <Argb>0</Argb>
                </GradientFillColor>
                <CornerRounding>5</CornerRounding>
                <Alignment>TopCenter</Alignment>
              </ShapeProperties>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>NewFocusOnObjConn</Name>
              <Id>7a9d3bb6-83ce-4b3d-a130-82958df911b3</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>57b22209-157c-40c5-ab66-f5b7cf6020ac</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>47f41abd-5d11-47bc-9217-4fab7a31940a</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>63</Width>
                <Height>9</Height>
              </Size>
              <Location>
                <X>241</X>
                <Y>447</Y>
              </Location>
              <DisplayName>NewFocusOnObjConn</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>200</X>
                    <Y>18</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>0</X>
                    <Y>55</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>78fee9d9-7a16-435a-a02b-ba7a4c6b9584</Role1Id>
              <Role2Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role2Id>
            </anyType>
            <anyType xsi:type="ObjectRefConnection">
              <Name>NewObjectRefConnection</Name>
              <Id>bf2eadb7-aadb-41bc-9230-5e6def8bfede</Id>
              <Structure xsi:type="ObjectRefConnectionStructure">
                <Id>bc789f44-e799-4d73-b9a2-75ce0532f170</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>d1520922-aebb-4cc5-8a70-448ff4e986be</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>0</Width>
                <Height>34</Height>
              </Size>
              <Location>
                <X>362</X>
                <Y>358</Y>
              </Location>
              <DisplayName>NewObjectRefConnection</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderStyle>DashDotDot</BorderStyle>
                <BorderColor>
                  <Argb>-16776961</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>58</X>
                    <Y>0</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>58</X>
                    <Y>157</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>3fa45f1b-b03c-47df-bf22-bebaa410c5cf</Role1Id>
              <Role2Id>06842019-c2e7-4252-8b63-71dbef10c28f</Role2Id>
            </anyType>
            <anyType xsi:type="FocusOnObjConn">
              <Name>NewFocusOnObjConn1</Name>
              <Id>7e1adbfd-90dc-4775-950b-0226613ba5cd</Id>
              <Structure xsi:type="FocusOnObjConnStructure">
                <Id>4e9e6e99-a196-46fe-a248-3671642b4c63</Id>
                <Types />
              </Structure>
              <Text xsi:type="DP_Text">
                <Id>f85041d4-5d95-41cc-8354-c2dd8d7efbd6</Id>
                <Instructions />
              </Text>
              <Size>
                <Width>75</Width>
                <Height>164</Height>
              </Size>
              <Location>
                <X>429</X>
                <Y>329</Y>
              </Location>
              <DisplayName>NewFocusOnObjConn1</DisplayName>
              <ShowName>false</ShowName>
              <NameFont>
                <FontFamily>Segoe UI</FontFamily>
                <Size>9</Size>
                <Style>Regular</Style>
              </NameFont>
              <LineProperties>
                <BorderColor>
                  <Argb>-4177920</Argb>
                </BorderColor>
                <FillColor>
                  <Argb>0</Argb>
                </FillColor>
                <Role1>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Offset>
                    <X>0</X>
                    <Y>280</Y>
                  </Offset>
                </Role1>
                <Role2>
                  <Font>
                    <FontFamily>Segoe UI</FontFamily>
                    <Size>9</Size>
                    <Style>Regular</Style>
                  </Font>
                  <Icon>..\..\Icons\triangle.gif</Icon>
                  <Offset>
                    <X>125</X>
                    <Y>0</Y>
                  </Offset>
                </Role2>
              </LineProperties>
              <Role1Id>f9b2f383-d76c-44a5-bc40-e192ec129c09</Role1Id>
              <Role2Id>c6932e1e-1af9-489a-9383-c76e6cc11472</Role2Id>
            </anyType>
          </Types>
        </Structure>
        <Text xsi:type="DP_Text">
          <Id>282ce0c6-bf04-477f-92c7-7dd8aaf16917</Id>
          <Instructions>
            <Instruction>
              <Name>Startup</Name>
              <String>TopicGroup topicG0 = Create("TopicGroup") as TopicGroup;
topicG0.GroupNameId = "Sensor";
TopicGroup topicG1 = Create("TopicGroup") as TopicGroup;
topicG1.GroupNameId = "FieldAgent";
TopicGroup topicG2 = Create("TopicGroup") as TopicGroup;
topicG2.GroupNameId = "BackOfficeAgent";
TopicGroup topicG3 = Create("TopicGroup") as TopicGroup;
topicG3.GroupNameId = "BackOfficeLeader";


Topic topic = Create("Topic") as Topic;
topic.TopicNameId = "Sensor";
topic = Create("Topic") as Topic;
topic.TopicNameId = "FieldAgent";


// for now, generate only sensors, field agents, and backoffice agents
//int total = AgentList.Count;
int total = 1111;
//DomainProAnalyst.Instance.Report("Nr of Agents:"+total);
Queue&lt;int&gt; groupSizes = new Queue&lt;int&gt;();
groupSizes.Enqueue((int)Math.Floor(total*SensorRatio)); 
groupSizes.Enqueue((int)Math.Floor(total*FieldAgentRatio)); 
groupSizes.Enqueue((int)Math.Floor(total*BackOfficeRatio)); 
groupSizes.Enqueue((int)Math.Floor(total*TeamLeaderRatio)); 

Queue&lt;List&lt;Topic&gt;&gt; topics = new Queue&lt;List&lt;Topic&gt;&gt;();
List&lt;Topic&gt; sensorTopics = new List&lt;Topic&gt;();
for (int j=0; j&lt;(total*SensorRatio/20); j++)
{
	topic = Create("Topic") as Topic;
	topic.TopicNameId = "SensorGroup"+j;
	sensorTopics.Add(topic);
	topicG0.Topics.Add(topic);
}
	topics.Enqueue(sensorTopics);
List&lt;Topic&gt; fieldTopics = new List&lt;Topic&gt;();
for (int j=0; j&lt;(total*FieldAgentRatio/10); j++)
{
	topic = Create("Topic") as Topic;
	topic.TopicNameId = "FieldAgentGroup"+j;
	fieldTopics.Add(topic);
	topicG1.Topics.Add(topic);
}
	topics.Enqueue(fieldTopics);
List&lt;Topic&gt; officeTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.TopicNameId = "BackOfficeAgent";
	officeTopics.Add(topic);
	topicG2.Topics.Add(topic);
	topics.Enqueue(officeTopics);
List&lt;Topic&gt; leaderTopics = new List&lt;Topic&gt;();
	topic = Create("Topic") as Topic;
	topic.TopicNameId = "BackOfficeLeader";
	leaderTopics.Add(topic);
	topicG3.Topics.Add(topic);
	topics.Enqueue(leaderTopics);

List&lt;Topic&gt; group = topics.Dequeue();
int type = 0;
int count = 0;
int limit = groupSizes.Dequeue();
DomainProAnalyst.Instance.Report("Nr of Agents:"+limit);
int rotate = 0;
for (int i=0; i&lt;total; i++)
{
	while (count &gt;= limit &amp;&amp; groupSizes.Count &gt; 0 &amp;&amp; topics.Count &gt; 0)
	{
		rotate = 0;
		type++;
		group = topics.Dequeue();
		limit += groupSizes.Dequeue();
DomainProAnalyst.Instance.Report("Nr of Agents:"+(limit-count));
	}		
	AgentTypeConfig.Add(type);
	AgentPubTopic.Add(group[rotate%group.Count]);
	rotate++;
	count++;		
}



</String>
            </Instruction>
          </Instructions>
        </Text>
        <Size>
          <Width>766</Width>
          <Height>543</Height>
        </Size>
        <Location>
          <X>5</X>
          <Y>9</Y>
        </Location>
        <DisplayName>MonSys</DisplayName>
        <NameFont>
          <FontFamily>Segoe UI</FontFamily>
          <Size>9</Size>
          <Style>Regular</Style>
        </NameFont>
        <ShapeProperties>
          <DefaultSize>
            <Width>100</Width>
            <Height>60</Height>
          </DefaultSize>
          <BorderColor>
            <Argb>-16777216</Argb>
          </BorderColor>
          <FillColor>
            <Argb>-327681</Argb>
          </FillColor>
          <GradientFill>true</GradientFill>
          <GradientFillColor>
            <Argb>0</Argb>
          </GradientFillColor>
        </ShapeProperties>
        <SensorRatio>0.9001</SensorRatio>
      </anyType>
    </Types>
  </Structure>
  <Text xsi:type="DP_Text">
    <Id>6028306c-e7a5-4f1a-ae88-e0b5ed36cf54</Id>
    <Instructions>
      <Instruction>
        <Name>Initialize</Name>
        <String />
      </Instruction>
    </Instructions>
  </Text>
</CollabArchV5Model>